parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"chA2":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.CONSTANTS=void 0,exports.areCookiesEnabled=T,exports.assertionError=exports.assert=void 0,exports.async=tt,exports.base64urlEncodeWithoutPadding=exports.base64Encode=exports.base64Decode=exports.base64=void 0,exports.calculateBackoffMillis=dt,exports.contains=F,exports.createMockUserToken=d,exports.createSubscribe=Y,exports.decode=void 0,exports.deepCopy=u,exports.deepEqual=H,exports.deepExtend=f,exports.errorPrefix=st,exports.extractQuerystring=X,exports.getGlobal=D,exports.getModularInstance=yt,exports.getUA=b,exports.isAdmin=void 0,exports.isBrowser=x,exports.isBrowserExtension=g,exports.isElectron=v,exports.isEmpty=$,exports.isIE=A,exports.isIndexedDBAvailable=C,exports.isMobileCordova=_,exports.isNode=y,exports.isNodeSdk=S,exports.isReactNative=E,exports.isSafari=O,exports.isUWP=m,exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=void 0,exports.jsonEval=I,exports.map=J,exports.ordinal=bt,exports.querystring=G,exports.querystringDecode=K,exports.safeGet=z,exports.stringToByteArray=exports.stringLength=void 0,exports.stringify=P,exports.validateArgCount=void 0,exports.validateCallback=it,exports.validateContextObject=ct,exports.validateIndexedDBOpenable=w,exports.validateNamespace=nt;const e={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};exports.CONSTANTS=e;const r=function(t,e){if(!t)throw o(e)};exports.assert=r;const o=function(t){return new Error("Firebase Database ("+e.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};exports.assertionError=o;const s=function(t){const e=[];let r=0;for(let o=0;o<t.length;o++){let s=t.charCodeAt(o);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=63&s|128):55296==(64512&s)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++o)),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=63&s|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=63&s|128)}return e},n=function(t){const e=[];let r=0,o=0;for(;r<t.length;){const s=t[r++];if(s<128)e[o++]=String.fromCharCode(s);else if(s>191&&s<224){const n=t[r++];e[o++]=String.fromCharCode((31&s)<<6|63&n)}else if(s>239&&s<365){const n=((7&s)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[o++]=String.fromCharCode(55296+(n>>10)),e[o++]=String.fromCharCode(56320+(1023&n))}else{const n=t[r++],i=t[r++];e[o++]=String.fromCharCode((15&s)<<12|(63&n)<<6|63&i)}}return e.join("")},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let s=0;s<t.length;s+=3){const e=t[s],n=s+1<t.length,i=n?t[s+1]:0,c=s+2<t.length,a=c?t[s+2]:0,h=e>>2,u=(3&e)<<4|i>>4;let f=(15&i)<<2|a>>6,l=63&a;c||(l=64,n||(f=64)),o.push(r[h],r[u],r[f],r[l])}return o.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):n(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let s=0;s<t.length;){const e=r[t.charAt(s++)],n=s<t.length?r[t.charAt(s)]:0,i=++s<t.length?r[t.charAt(s)]:64,c=++s<t.length?r[t.charAt(s)]:64;if(++s,null==e||null==n||null==i||null==c)throw Error();const a=e<<2|n>>4;if(o.push(a),64!==i){const t=n<<4&240|i>>2;if(o.push(t),64!==c){const t=i<<6&192|c;o.push(t)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};exports.base64=i;const c=function(t){const e=s(t);return i.encodeByteArray(e,!0)};exports.base64Encode=c;const a=function(t){return c(t).replace(/\./g,"")};exports.base64urlEncodeWithoutPadding=a;const h=function(t){try{return i.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(t){return f(void 0,t)}function f(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)e.hasOwnProperty(r)&&l(r)&&(t[r]=f(t[r],e[r]));return t}function l(t){return"__proto__"!==t}exports.base64Decode=h;class p{constructor(){this.reject=(()=>{}),this.resolve=(()=>{}),this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}function d(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",o=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const n=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(n)),""].join(".")}function b(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(b())}function y(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function x(){return"object"==typeof self&&self.self===self}function g(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function E(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function v(){return b().indexOf("Electron/")>=0}function A(){const t=b();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function m(){return b().indexOf("MSAppHost/")>=0}function S(){return!0===e.NODE_CLIENT||!0===e.NODE_ADMIN}function O(){return!y()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C(){return"object"==typeof indexedDB}function w(){return new Promise((t,e)=>{try{let o=!0;const s="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(s);n.onsuccess=(()=>{n.result.close(),o||self.indexedDB.deleteDatabase(s),t(!0)}),n.onupgradeneeded=(()=>{o=!1}),n.onerror=(()=>{var t;e((null===(t=n.error)||void 0===t?void 0:t.message)||"")})}catch(r){e(r)}})}function T(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}function D(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}exports.Deferred=p;const N="FirebaseError";class M extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=N,Object.setPrototypeOf(this,M.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,j.prototype.create)}}exports.FirebaseError=M;class j{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,s=this.errors[t],n=s?k(s,r):"Error",i=`${this.serviceName}: ${n} (${o}).`;return new M(o,i,r)}}function k(t,e){return t.replace(B,(t,r)=>{const o=e[r];return null!=o?String(o):`<${r}?>`})}exports.ErrorFactory=j;const B=/\{\$([^}]+)}/g;function I(t){return JSON.parse(t)}function P(t){return JSON.stringify(t)}const L=function(t){let e={},r={},o={},s="";try{const i=t.split(".");e=I(h(i[0])||""),r=I(h(i[1])||""),s=i[2],o=r.d||{},delete r.d}catch(n){}return{header:e,claims:r,data:o,signature:s}};exports.decode=L;const V=function(t){const e=L(t).claims,r=Math.floor((new Date).getTime()/1e3);let o=0,s=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?o=e.nbf:e.hasOwnProperty("iat")&&(o=e.iat),s=e.hasOwnProperty("exp")?e.exp:o+86400),!!r&&!!o&&!!s&&r>=o&&r<=s};exports.isValidTimestamp=V;const R=function(t){const e=L(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null};exports.issuedAtTime=R;const W=function(t){const e=L(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")};exports.isValidFormat=W;const U=function(t){const e=L(t).claims;return"object"==typeof e&&!0===e.admin};function F(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function z(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function $(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function J(t,e,r){const o={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=e.call(r,t[s],s,t));return o}function H(t,e){if(t===e)return!0;const r=Object.keys(t),o=Object.keys(e);for(const s of r){if(!o.includes(s))return!1;const r=t[s],n=e[s];if(q(r)&&q(n)){if(!H(r,n))return!1}else if(r!==n)return!1}for(const s of o)if(!r.includes(s))return!1;return!0}function q(t){return null!==t&&"object"==typeof t}function G(t){const e=[];for(const[r,o]of Object.entries(t))Array.isArray(o)?o.forEach(t=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function K(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[r,o]=t.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function X(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}exports.isAdmin=U;class Q{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const r=this.W_;if("string"==typeof t)for(let u=0;u<16;u++)r[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)r[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const t=r[u-3]^r[u-8]^r[u-14]^r[u-16];r[u]=4294967295&(t<<1|t>>>31)}let o,s,n=this.chain_[0],i=this.chain_[1],c=this.chain_[2],a=this.chain_[3],h=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(o=a^i&(c^a),s=1518500249):(o=i^c^a,s=1859775393):u<60?(o=i&c|a&(i|c),s=2400959708):(o=i^c^a,s=3395469782);const t=(n<<5|n>>>27)+o+h+s+r[u]&4294967295;h=a,a=c,c=4294967295&(i<<30|i>>>2),i=n,n=t}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const r=e-this.blockSize;let o=0;const s=this.buf_;let n=this.inbuf_;for(;o<e;){if(0===n)for(;o<=r;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(s[n]=t.charCodeAt(o),++o,++n===this.blockSize){this.compress_(s),n=0;break}}else for(;o<e;)if(s[n]=t[o],++o,++n===this.blockSize){this.compress_(s),n=0;break}}this.inbuf_=n,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let o=0;o<5;o++)for(let e=24;e>=0;e-=8)t[r]=this.chain_[o]>>e&255,++r;return t}}function Y(t,e){const r=new Z(t,e);return r.subscribe.bind(r)}exports.Sha1=Q;class Z{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let o;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");void 0===(o=et(t,["next","error","complete"])?t:{next:t,error:e,complete:r}).next&&(o.next=rt),void 0===o.error&&(o.error=rt),void 0===o.complete&&(o.complete=rt);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch(t){}}),this.observers.push(o),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tt(t,e){return(...r)=>{Promise.resolve(!0).then(()=>{t(...r)}).catch(t=>{e&&e(t)})}}function et(t,e){if("object"!=typeof t||null===t)return!1;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}function rt(){}const ot=function(t,e,r,o){let s;if(o<e?s="at least "+e:o>r&&(s=0===r?"none":"no more than "+r),s){throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+s+".")}};function st(t,e){return`${t} failed: ${e} argument `}function nt(t,e,r){if((!r||e)&&"string"!=typeof e)throw new Error(st(t,"namespace")+"must be a valid firebase namespace.")}function it(t,e,r,o){if((!o||r)&&"function"!=typeof r)throw new Error(st(t,e)+"must be a valid function.")}function ct(t,e,r,o){if((!o||r)&&("object"!=typeof r||null===r))throw new Error(st(t,e)+"must be a valid context object.")}exports.validateArgCount=ot;const at=function(t){const e=[];let o=0;for(let s=0;s<t.length;s++){let n=t.charCodeAt(s);if(n>=55296&&n<=56319){const e=n-55296;r(++s<t.length,"Surrogate pair missing trail surrogate."),n=65536+(e<<10)+(t.charCodeAt(s)-56320)}n<128?e[o++]=n:n<2048?(e[o++]=n>>6|192,e[o++]=63&n|128):n<65536?(e[o++]=n>>12|224,e[o++]=n>>6&63|128,e[o++]=63&n|128):(e[o++]=n>>18|240,e[o++]=n>>12&63|128,e[o++]=n>>6&63|128,e[o++]=63&n|128)}return e};exports.stringToByteArray=at;const ht=function(t){let e=0;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,r++):e+=3}return e};exports.stringLength=ht;const ut=1e3,ft=2,lt=144e5;exports.MAX_VALUE_MILLIS=lt;const pt=.5;function dt(t,e=ut,r=ft){const o=e*Math.pow(r,t),s=Math.round(pt*o*(Math.random()-.5)*2);return Math.min(lt,o+s)}function bt(t){return Number.isFinite(t)?t+_t(t):`${t}`}function _t(t){const e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";const r=t%10;return 1===r?"st":2===r?"nd":3===r?"rd":"th"}function yt(t){return t&&t._delegate?t._delegate:t}exports.RANDOM_FACTOR=pt;
},{}],"vhY9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("@firebase/util");class e{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}exports.Component=e;const n="[DEFAULT]";class i{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const e=new t.Deferred;if(this.instancesDeferred.set(n,e),this.isInitialized(n)||this.shouldAutoInitialize())try{const t=this.getOrInitializeService({instanceIdentifier:n});t&&e.resolve(t)}catch(i){}}return this.instancesDeferred.get(n).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(r(t))try{this.getOrInitializeService({instanceIdentifier:n})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(t=n){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t=n){return this.instances.has(t)}getOptions(t=n){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&r.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:s(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}return n||null}normalizeInstanceIdentifier(t=n){return this.component?this.component.multipleInstances?t:n:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function s(t){return t===n?void 0:t}function r(t){return"EAGER"===t.instantiationMode}exports.Provider=i;class o{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new i(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}exports.ComponentContainer=o;
},{"@firebase/util":"chA2"}],"JJem":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=exports.LogLevel=void 0,exports.setLogLevel=i,exports.setUserLogHandler=g;const e=[];var r;exports.LogLevel=r,function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));const t={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},s=(e,r,...t)=>{if(r<e.logLevel)return;const o=(new Date).toISOString(),s=l[r];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${r})`);console[s](`[${o}]  ${e.name}:`,...t)};class n{constructor(r){this.name=r,this._logLevel=o,this._logHandler=s,this._userLogHandler=null,e.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?t[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}function i(r){e.forEach(e=>{e.setLogLevel(r)})}function g(o,l){for(const s of e){let e=null;l&&l.level&&(e=t[l.level]),s.userLogHandler=null===o?null:(t,l,...s)=>{const n=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(e=>e).join(" ");l>=(null!=e?e:t.logLevel)&&o({level:r[l].toLowerCase(),message:n,args:s,type:t.name})}}}exports.Logger=n;
},{}],"h2Mb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FirebaseError",{enumerable:!0,get:function(){return a.FirebaseError}}),exports._DEFAULT_ENTRY_NAME=exports.SDK_VERSION=void 0,exports._addComponent=R,exports._addOrOverwriteComponent=T,exports._apps=void 0,exports._clearComponents=M,exports._components=void 0,exports._getProvider=V,exports._registerComponent=U,exports._removeServiceInstance=q,exports.deleteApp=Q,exports.getApp=G,exports.getApps=J,exports.initializeApp=H,exports.onLog=X,exports.registerVersion=W,exports.setLogLevel=Z;var e=require("@firebase/component"),t=require("@firebase/logger"),a=require("@firebase/util");class r{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(o(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}function o(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}const i="@firebase/app",n="0.7.11",s=new t.Logger("@firebase/app"),p="@firebase/app-compat",c="@firebase/analytics-compat",f="@firebase/analytics",l="@firebase/app-check-compat",m="@firebase/app-check",u="@firebase/auth",d="@firebase/auth-compat",b="@firebase/database",g="@firebase/database-compat",h="@firebase/functions",_="@firebase/functions-compat",v="@firebase/installations",y="@firebase/installations-compat",w="@firebase/messaging",D="@firebase/messaging-compat",x="@firebase/performance",E="@firebase/performance-compat",C="@firebase/remote-config",A="@firebase/remote-config-compat",N="@firebase/storage",$="@firebase/storage-compat",F="@firebase/firestore",O="@firebase/firestore-compat",j="firebase",L="9.6.1",k="[DEFAULT]";exports._DEFAULT_ENTRY_NAME=k;const I={[i]:"fire-core",[p]:"fire-core-compat",[f]:"fire-analytics",[c]:"fire-analytics-compat",[m]:"fire-app-check",[l]:"fire-app-check-compat",[u]:"fire-auth",[d]:"fire-auth-compat",[b]:"fire-rtdb",[g]:"fire-rtdb-compat",[h]:"fire-fn",[_]:"fire-fn-compat",[v]:"fire-iid",[y]:"fire-iid-compat",[w]:"fire-fcm",[D]:"fire-fcm-compat",[x]:"fire-perf",[E]:"fire-perf-compat",[C]:"fire-rc",[A]:"fire-rc-compat",[N]:"fire-gcs",[$]:"fire-gcs-compat",[F]:"fire-fst",[O]:"fire-fst-compat","fire-js":"fire-js",[j]:"fire-js-all"},P=new Map;exports._apps=P;const S=new Map;function R(e,t){try{e.container.addComponent(t)}catch(a){s.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,a)}}function T(e,t){e.container.addOrOverwriteComponent(t)}function U(e){const t=e.name;if(S.has(t))return s.debug(`There were multiple attempts to register component ${t}.`),!1;S.set(t,e);for(const a of P.values())R(a,e);return!0}function V(e,t){return e.container.getProvider(t)}function q(e,t,a=k){V(e,t).clearInstance(a)}function M(){S.clear()}exports._components=S;const z={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."},K=new a.ErrorFactory("app","Firebase",z);class Y{constructor(t,a,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},a),this._name=a.name,this._automaticDataCollectionEnabled=a.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new e.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw K.create("app-deleted",{appName:this._name})}}const B="9.6.1";function H(t,r={}){if("object"!=typeof r){r={name:r}}const o=Object.assign({name:k,automaticDataCollectionEnabled:!1},r),i=o.name;if("string"!=typeof i||!i)throw K.create("bad-app-name",{appName:String(i)});const n=P.get(i);if(n){if((0,a.deepEqual)(t,n.options)&&(0,a.deepEqual)(o,n.config))return n;throw K.create("duplicate-app",{appName:i})}const s=new e.ComponentContainer(i);for(const e of S.values())s.addComponent(e);const p=new Y(t,o,s);return P.set(i,p),p}function G(e=k){const t=P.get(e);if(!t)throw K.create("no-app",{appName:e});return t}function J(){return Array.from(P.values())}async function Q(e){const t=e.name;P.has(t)&&(P.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function W(t,a,r){var o;let i=null!==(o=I[t])&&void 0!==o?o:t;r&&(i+=`-${r}`);const n=i.match(/\s|\//),p=a.match(/\s|\//);if(n||p){const e=[`Unable to register library "${i}" with version "${a}":`];return n&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),n&&p&&e.push("and"),p&&e.push(`version name "${a}" contains illegal characters (whitespace or "/")`),void s.warn(e.join(" "))}U(new e.Component(`${i}-version`,()=>({library:i,version:a}),"VERSION"))}function X(e,a){if(null!==e&&"function"!=typeof e)throw K.create("invalid-log-argument");(0,t.setUserLogHandler)(e,a)}function Z(e){(0,t.setLogLevel)(e)}function ee(t){U(new e.Component("platform-logger",e=>new r(e),"PRIVATE")),W(i,n,t),W(i,n,"esm2017"),W("fire-js","")}exports.SDK_VERSION="9.6.1",ee("");
},{"@firebase/component":"vhY9","@firebase/logger":"JJem","@firebase/util":"chA2"}],"OJEJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/app");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r="firebase",t="9.6.1";(0,e.registerVersion)(r,t,"app");
},{"@firebase/app":"h2Mb"}],"z5Lg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("firebase/app"),a={apiKey:"AIzaSyA7ept9dMYY1m3IEt7wpjaUPn72sTJGG3Q",authDomain:"spa-samenuit-samenthuis.firebaseapp.com",projectId:"spa-samenuit-samenthuis",storageBucket:"spa-samenuit-samenthuis.appspot.com",messagingSenderId:"731709963843",appId:"1:731709963843:web:3fe1da7497f09dd604def6"},s=function(){(0,e.initializeApp)(a)},t=s;exports.default=t;
},{"firebase/app":"OJEJ"}],"XGyB":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=function(){function t(n){var r=n.name,o=n.routerPath;e(this,t),this.name=r,this.routerPath=o,this.reRender=null,this.componentContainer=document.getElementById("container")}return n(t,[{key:"clearComponent",value:function(){this.componentContainer.innerHTML=""}}]),t}(),o=r;exports.default=o;
},{}],"vI6X":[function(require,module,exports) {
var define;
var t;!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof t&&t.amd?t("Navigo",[],e):"object"==typeof exports?exports.Navigo=e():n.Navigo=e()}("undefined"!=typeof self?self:this,function(){return function(){"use strict";var t={407:function(t,n,e){e.d(n,{default:function(){return N}});var o=/([:*])(\w+)/g,r=/\*/g,i=/\/\?/g;function a(t){return void 0===t&&(t="/"),v()?location.pathname+location.search+location.hash:t}function s(t){return t.replace(/\/+$/,"").replace(/^\/+/,"")}function c(t){return"string"==typeof t}function u(t){return t&&t.indexOf("#")>=0&&t.split("#").pop()||""}function h(t){var n=s(t).split(/\?(.*)?$/);return[s(n[0]),n.slice(1).join("")]}function f(t){for(var n={},e=t.split("&"),o=0;o<e.length;o++){var r=e[o].split("=");if(""!==r[0]){var i=decodeURIComponent(r[0]);n[i]?(Array.isArray(n[i])||(n[i]=[n[i]]),n[i].push(decodeURIComponent(r[1]||""))):n[i]=decodeURIComponent(r[1]||"")}}return n}function l(t,n){var e,a=h(s(t.currentLocationPath)),l=a[0],p=a[1],d=""===p?null:f(p),v=[];if(c(n.path)){if(e="(?:/^|^)"+s(n.path).replace(o,function(t,n,e){return v.push(e),"([^/]+)"}).replace(r,"?(?:.*)").replace(i,"/?([^/]+|)")+"$",""===s(n.path)&&""===s(l))return{url:l,queryString:p,hashString:u(t.to),route:n,data:null,params:d}}else e=n.path;var g=new RegExp(e,""),m=l.match(g);if(m){var y=c(n.path)?function(t,n){return 0===n.length?null:t?t.slice(1,t.length).reduce(function(t,e,o){return null===t&&(t={}),t[n[o]]=decodeURIComponent(e),t},null):null}(m,v):m.groups?m.groups:m.slice(1);return{url:s(l.replace(new RegExp("^"+t.instance.root),"")),queryString:p,hashString:u(t.to),route:n,data:y,params:d}}return!1}function p(){return!("undefined"==typeof window||!window.history||!window.history.pushState)}function d(t,n){return void 0===t[n]||!0===t[n]}function v(){return"undefined"!=typeof window}function g(t,n){return void 0===t&&(t=[]),void 0===n&&(n={}),t.filter(function(t){return t}).forEach(function(t){["before","after","already","leave"].forEach(function(e){t[e]&&(n[e]||(n[e]=[]),n[e].push(t[e]))})}),n}function m(t,n,e){var o=n||{},r=0;!function n(){t[r]?Array.isArray(t[r])?(t.splice.apply(t,[r,1].concat(t[r][0](o)?t[r][1]:t[r][2])),n()):t[r](o,function(t){void 0===t||!0===t?(r+=1,n()):e&&e(o)}):e&&e(o)}()}function y(t,n){void 0===t.currentLocationPath&&(t.currentLocationPath=t.to=a(t.instance.root)),t.currentLocationPath=t.instance._checkForAHash(t.currentLocationPath),n()}function _(t,n){for(var e=0;e<t.instance.routes.length;e++){var o=l(t,t.instance.routes[e]);if(o&&(t.matches||(t.matches=[]),t.matches.push(o),"ONE"===t.resolveOptions.strategy))return void n()}n()}function k(t,n){t.navigateOptions&&(void 0!==t.navigateOptions.shouldResolve&&console.warn('"shouldResolve" is deprecated. Please check the documentation.'),void 0!==t.navigateOptions.silent&&console.warn('"silent" is deprecated. Please check the documentation.')),n()}function O(t,n){!0===t.navigateOptions.force?(t.instance._setCurrent([t.instance._pathToMatchObject(t.to)]),n(!1)):n()}m.if=function(t,n,e){return Array.isArray(n)||(n=[n]),Array.isArray(e)||(e=[e]),[t,n,e]};var w=v(),L=p();function b(t,n){if(d(t.navigateOptions,"updateBrowserURL")){var e=("/"+t.to).replace(/\/\//g,"/"),o=w&&t.resolveOptions&&!0===t.resolveOptions.hash;L?(history[t.navigateOptions.historyAPIMethod||"pushState"](t.navigateOptions.stateObj||{},t.navigateOptions.title||"",o?"#"+e:e),location&&location.hash&&(t.instance.__freezeListening=!0,setTimeout(function(){if(!o){var n=location.hash;location.hash="",location.hash=n}t.instance.__freezeListening=!1},1))):w&&(window.location.href=t.to)}n()}function A(t,n){var e=t.instance;e.lastResolved()?m(e.lastResolved().map(function(n){return function(e,o){if(n.route.hooks&&n.route.hooks.leave){var r,i=t.instance.matchLocation(n.route.path,t.currentLocationPath,!1);r="*"!==n.route.path?!i:!(t.matches&&t.matches.find(function(t){return n.route.path===t.route.path})),d(t.navigateOptions,"callHooks")&&r?m(n.route.hooks.leave.map(function(n){return function(e,o){return n(function(n){!1===n?t.instance.__markAsClean(t):o()},t.matches&&t.matches.length>0?1===t.matches.length?t.matches[0]:t.matches:void 0)}}).concat([function(){return o()}])):o()}else o()}}),{},function(){return n()}):n()}function P(t,n){d(t.navigateOptions,"updateState")&&t.instance._setCurrent(t.matches),n()}var R=[function(t,n){var e=t.instance.lastResolved();if(e&&e[0]&&e[0].route===t.match.route&&e[0].url===t.match.url&&e[0].queryString===t.match.queryString)return e.forEach(function(n){n.route.hooks&&n.route.hooks.already&&d(t.navigateOptions,"callHooks")&&n.route.hooks.already.forEach(function(n){return n(t.match)})}),void n(!1);n()},function(t,n){t.match.route.hooks&&t.match.route.hooks.before&&d(t.navigateOptions,"callHooks")?m(t.match.route.hooks.before.map(function(n){return function(e,o){return n(function(n){!1===n?t.instance.__markAsClean(t):o()},t.match)}}).concat([function(){return n()}])):n()},function(t,n){d(t.navigateOptions,"callHandler")&&t.match.route.handler(t.match),t.instance.updatePageLinks(),n()},function(t,n){t.match.route.hooks&&t.match.route.hooks.after&&d(t.navigateOptions,"callHooks")&&t.match.route.hooks.after.forEach(function(n){return n(t.match)}),n()}],S=[A,function(t,n){var e=t.instance._notFoundRoute;if(e){t.notFoundHandled=!0;var o=h(t.currentLocationPath),r=o[0],i=o[1],a=u(t.to);e.path=s(r);var c={url:e.path,queryString:i,hashString:a,data:null,route:e,params:""!==i?f(i):null};t.matches=[c],t.match=c}n()},m.if(function(t){return t.notFoundHandled},R.concat([P]),[function(t,n){t.resolveOptions&&!1!==t.resolveOptions.noMatchWarning&&void 0!==t.resolveOptions.noMatchWarning||console.warn('Navigo: "'+t.currentLocationPath+"\" didn't match any of the registered routes."),n()},function(t,n){t.instance._setCurrent(null),n()}])];function E(){return(E=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}).apply(this,arguments)}function x(t,n){var e=0;A(t,function o(){e!==t.matches.length?m(R,E({},t,{match:t.matches[e]}),function(){e+=1,o()}):P(t,n)})}function H(t){t.instance.__markAsClean(t)}function j(){return(j=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t}).apply(this,arguments)}var C="[data-navigo]";function N(t,n){var e,o=n||{strategy:"ONE",hash:!1,noMatchWarning:!1,linksSelector:C},r=this,i="/",d=null,w=[],L=!1,A=p(),P=v();function R(t){return t.indexOf("#")>=0&&(t=!0===o.hash?t.split("#")[1]||"/":t.split("#")[0]),t}function E(t){return s(i+"/"+s(t))}function N(t,n,e,o){return t=c(t)?E(t):t,{name:o||s(String(t)),path:t,handler:n,hooks:g(e)}}function U(t,n){if(!r.__dirty){r.__dirty=!0,t=t?s(i)+"/"+s(t):void 0;var e={instance:r,to:t,currentLocationPath:t,navigateOptions:{},resolveOptions:j({},o,n)};return m([y,_,m.if(function(t){var n=t.matches;return n&&n.length>0},x,S)],e,H),!!e.matches&&e.matches}r.__waiting.push(function(){return r.resolve(t,n)})}function q(t,n){if(r.__dirty)r.__waiting.push(function(){return r.navigate(t,n)});else{r.__dirty=!0,t=s(i)+"/"+s(t);var e={instance:r,to:t,navigateOptions:n||{},resolveOptions:n&&n.resolveOptions?n.resolveOptions:o,currentLocationPath:R(t)};m([k,O,_,m.if(function(t){var n=t.matches;return n&&n.length>0},x,S),b,H],e,H)}}function F(){if(P)return(P?[].slice.call(document.querySelectorAll(o.linksSelector||C)):[]).forEach(function(t){"false"!==t.getAttribute("data-navigo")&&"_blank"!==t.getAttribute("target")?t.hasListenerAttached||(t.hasListenerAttached=!0,t.navigoHandler=function(n){if((n.ctrlKey||n.metaKey)&&"a"===n.target.tagName.toLowerCase())return!1;var e=t.getAttribute("href");if(null==e)return!1;if(e.match(/^(http|https)/)&&"undefined"!=typeof URL)try{var o=new URL(e);e=o.pathname+o.search}catch(t){}var i=function(t){if(!t)return{};var n,e=t.split(","),o={};return e.forEach(function(t){var e=t.split(":").map(function(t){return t.replace(/(^ +| +$)/g,"")});switch(e[0]){case"historyAPIMethod":o.historyAPIMethod=e[1];break;case"resolveOptionsStrategy":n||(n={}),n.strategy=e[1];break;case"resolveOptionsHash":n||(n={}),n.hash="true"===e[1];break;case"updateBrowserURL":case"callHandler":case"updateState":case"force":o[e[0]]="true"===e[1]}}),n&&(o.resolveOptions=n),o}(t.getAttribute("data-navigo-options"));L||(n.preventDefault(),n.stopPropagation(),r.navigate(s(e),i))},t.addEventListener("click",t.navigoHandler)):t.hasListenerAttached&&t.removeEventListener("click",t.navigoHandler)}),r}function I(t,n,e){var o=w.find(function(n){return n.name===t}),r=null;if(o){if(r=o.path,n)for(var a in n)r=r.replace(":"+a,n[a]);r=r.match(/^\//)?r:"/"+r}return r&&e&&!e.includeRoot&&(r=r.replace(new RegExp("^/"+i),"")),r}function M(t){var n=h(s(t)),o=n[0],r=n[1],i=""===r?null:f(r);return{url:o,queryString:r,hashString:u(t),route:N(o,function(){},[e],o),data:null,params:i}}function T(t,n,e){return"string"==typeof n&&(n=z(n)),n?(n.hooks[t]||(n.hooks[t]=[]),n.hooks[t].push(e),function(){n.hooks[t]=n.hooks[t].filter(function(t){return t!==e})}):(console.warn("Route doesn't exists: "+n),function(){})}function z(t){return"string"==typeof t?w.find(function(n){return n.name===E(t)}):w.find(function(n){return n.handler===t})}t?i=s(t):console.warn('Navigo requires a root path in its constructor. If not provided will use "/" as default.'),this.root=i,this.routes=w,this.destroyed=L,this.current=d,this.__freezeListening=!1,this.__waiting=[],this.__dirty=!1,this.__markAsClean=function(t){t.instance.__dirty=!1,t.instance.__waiting.length>0&&t.instance.__waiting.shift()()},this.on=function(t,n,o){var r=this;return"object"!=typeof t||t instanceof RegExp?("function"==typeof t&&(o=n,n=t,t=i),w.push(N(t,n,[e,o])),this):(Object.keys(t).forEach(function(n){if("function"==typeof t[n])r.on(n,t[n]);else{var o=t[n],i=o.uses,a=o.as,s=o.hooks;w.push(N(n,i,[e,s],a))}}),this)},this.off=function(t){return this.routes=w=w.filter(function(n){return c(t)?s(n.path)!==s(t):"function"==typeof t?t!==n.handler:String(n.path)!==String(t)}),this},this.resolve=U,this.navigate=q,this.navigateByName=function(t,n,e){var o=I(t,n);return null!==o&&(q(o.replace(new RegExp("^/?"+i),""),e),!0)},this.destroy=function(){this.routes=w=[],A&&window.removeEventListener("popstate",this.__popstateListener),this.destroyed=L=!0},this.notFound=function(t,n){return r._notFoundRoute=N("*",t,[e,n],"__NOT_FOUND__"),this},this.updatePageLinks=F,this.link=function(t){return"/"+i+"/"+s(t)},this.hooks=function(t){return e=t,this},this.extractGETParameters=function(t){return h(R(t))},this.lastResolved=function(){return d},this.generate=I,this.getLinkPath=function(t){return t.getAttribute("href")},this.match=function(t){var n={instance:r,currentLocationPath:t,to:t,navigateOptions:{},resolveOptions:o};return _(n,function(){}),!!n.matches&&n.matches},this.matchLocation=function(t,n,e){void 0===n||void 0!==e&&!e||(n=E(n));var o={instance:r,to:n,currentLocationPath:n};return y(o,function(){}),"string"==typeof t&&(t=void 0===e||e?E(t):t),l(o,{name:String(t),path:t,handler:function(){},hooks:{}})||!1},this.getCurrentLocation=function(){return M(s(a(i)).replace(new RegExp("^"+i),""))},this.addBeforeHook=T.bind(this,"before"),this.addAfterHook=T.bind(this,"after"),this.addAlreadyHook=T.bind(this,"already"),this.addLeaveHook=T.bind(this,"leave"),this.getRoute=z,this._pathToMatchObject=M,this._clean=s,this._checkForAHash=R,this._setCurrent=function(t){return d=r.current=t},function(){A&&(this.__popstateListener=function(){r.__freezeListening||U()},window.addEventListener("popstate",this.__popstateListener))}.call(this),F.call(this)}}},n={};function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{}};return t[o](r,r.exports,e),r.exports}return e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e(407)}().default});
},{}],"jmDk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("navigo"));function t(e){return e&&e.__esModule?e:{default:e}}var r={router:null,getRouter:function(){return this.router||(this.router=new e.default("/",!1)),this.router}},u=r;exports.default=u;
},{"navigo":"vI6X"}],"lY9v":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("./firebase")),n=r(require("./library/Component")),t=r(require("./Router"));function r(e){return e&&e.__esModule?e:{default:e}}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var u=function(){function r(n){o(this,r),this.parent=n,this.components=[],(0,e.default)()}return i(r,[{key:"clearContainer",value:function(e){for(;e.firstchild;)e.removeChild(e.lastChild)}},{key:"addComponent",value:function(e){var r=this;if(e instanceof n.default){var o=e.name,a=e.routerPath;this.components.push(e),t.default.getRouter().on(a,function(){r.showComponent({name:o})}).resolve()}}},{key:"showComponent",value:function(e){var n=e.name,t=this.components.find(function(e){return e.name===n});t&&(this.clearContainer(this.parent),this.clearContainer(this.parent),t.render&&this.parent.appendChild(t.render()))}}]),r}(),s=u;exports.default=s;
},{"./firebase":"z5Lg","./library/Component":"XGyB","./Router":"jmDk"}],"hzEA":[function(require,module,exports) {
"use strict";function t(t){return a(t)||r(t)||n(t)||e()}function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function r(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function a(t){if(Array.isArray(t))return o(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var c={createButton:function(t){var e=t.textContent,n=void 0===e?"":e,r=t.className,a=t.onClick,o=void 0===a?null:a,c=t.type,i=document.createElement("button");return i.textContent=n,i.input=c,i.classList.add(r),o&&i.addEventListener("click",function(){o()}),i},createIcon:function(e){var n,r=e.classNames,a=void 0===r?[]:r,o=document.createElement("i");return a.length&&(n=o.classList).add.apply(n,t(a)),o},createLabel:function(t){var e=t.id,n=t.textContent,r=void 0===n?"":n,a=document.createElement("label");a.id=e,a.textContent=r},createInput:function(t){var e=t.type,n=t.id,r=document.createElement("input");return r.type=e,r.id=n,r},createHeader:function(t){var e=t.textContent,n=void 0===e?" ":e,r=t.className,a=t.id,o=document.createElement("h1");return o.textContent=n,o.classList.add(r),o.id=a,o},createText:function(t){var e=t.textContent,n=void 0===e?" ":e,r=t.className,a=document.createElement("p");return a.textContent=n,a.classList.add(r),a},createImage:function(t){var e=t.newSource,n=t.className,r=document.createElement("img");return r.src=e,r.classList.add(n),r},createInputField:function(t){var e=t.className,n=t.type,r=t.text,a=t.placeholder,o=t.id,c=void 0===o?"":o,i=document.createElement("input");return i.classList.add(e),i.setAttribute(n,r),i.placeholder=a,i.id=c,i},createContainer:function(t){var e=t.className,n=void 0===e?"":e,r=t.id,a=void 0===r?"":r,o=t.children,c=void 0===o?[]:o,i=document.createElement("div");return a&&i.setAttribute("id",a),i.className=n,c.length&&c.forEach(function(t){t instanceof Element&&i.appendChild(t)}),i}},i=c;exports.default=i;
},{}],"QE9W":[function(require,module,exports) {
module.exports="/backgroundImages2.205b6679.png";
},{}],"SPDy":[function(require,module,exports) {
module.exports="/logo.139bde1d.png";
},{}],"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__assign=void 0,exports.__asyncDelegator=b,exports.__asyncGenerator=v,exports.__asyncValues=w,exports.__await=_,exports.__awaiter=c,exports.__classPrivateFieldGet=j,exports.__classPrivateFieldSet=P,exports.__createBinding=void 0,exports.__decorate=o,exports.__exportStar=l,exports.__extends=e,exports.__generator=u,exports.__importDefault=g,exports.__importStar=O,exports.__makeTemplateObject=x,exports.__metadata=i,exports.__param=a,exports.__read=p,exports.__rest=n,exports.__spread=y,exports.__spreadArray=d,exports.__spreadArrays=h,exports.__values=s;var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,i=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,r,i):o(e,r))||i);return a>3&&i&&Object.defineProperty(e,r,i),i}function a(t,e){return function(r,n){e(r,n,t)}}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function c(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{u(n.next(t))}catch(e){a(e)}}function c(t){try{u(n.throw(t))}catch(e){a(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,c)}u((n=n.apply(t,e||[])).next())})}function u(t,e){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(c){a=[6,c],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}exports.__assign=r;var f=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]};function l(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||f(e,t,r)}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t}function h(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var a=arguments[e],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function d(t,e,r){if(r||2===arguments.length)for(var n,o=0,a=e.length;o<a;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||c(t,e)})})}function c(t,e){try{(r=o[t](e)).value instanceof _?Promise.resolve(r.value.v).then(u,f):l(a[0][2],r)}catch(n){l(a[0][3],n)}var r}function u(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}}function b(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:_(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function w(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof s?s(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function x(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}exports.__createBinding=f;var m=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function O(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&f(e,t,r);return m(e,t),e}function g(t){return t&&t.__esModule?t:{default:t}}function j(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function P(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r}
},{}],"pg19":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.$=Wt,exports.C=exports.B=exports.A=void 0,exports.D=S,exports.E=xe,exports.V=exports.U=exports.T=exports.S=exports.R=exports.Q=exports.P=exports.O=exports.N=exports.M=exports.L=exports.K=exports.J=exports.I=exports.H=exports.G=exports.F=void 0,exports.W=St,exports.X=Ut,exports.Y=Ft,exports.Z=Vt,exports._=jt,exports.a=void 0,exports.a0=Kt,exports.a1=Jt,exports.a2=Bt,exports.a3=$t,exports.a4=Yt,exports.a5=Xt,exports.a6=Qt,exports.a7=Zt,exports.a8=en,exports.a9=nn,exports.aA=gr,exports.aB=or,exports.aC=Le,exports.aE=exports.aD=void 0,exports.aF=De,exports.aG=Kn,exports.aJ=exports.aI=exports.aH=void 0,exports.aa=rn,exports.ab=sn,exports.ac=void 0,exports.ad=ht,exports.ae=an,exports.af=cn,exports.ag=un,exports.ah=X,exports.ai=Q,exports.aj=Dt,exports.ak=In,exports.al=ae,exports.am=Sn,exports.an=Ln,exports.ao=Re,exports.ap=A,exports.aq=Ne,exports.ar=Ee,exports.as=I,exports.at=Yr,exports.au=Er,exports.av=_,exports.aw=E,exports.ax=R,exports.ay=ge,exports.b=exports.az=void 0,exports.c=Xi,exports.d=Zi,exports.e=Qi,exports.f=ur,exports.g=pr,exports.h=lr,exports.i=void 0,exports.j=fr,exports.k=void 0,exports.l=Vi,exports.m=void 0,exports.n=us,exports.o=void 0,exports.p=_n,exports.q=yn,exports.r=qi,exports.s=Fi,exports.t=Tn,exports.u=Hi,exports.v=wn,exports.w=En,exports.x=kn,exports.y=An,exports.z=void 0;var e=require("@firebase/util"),t=require("@firebase/app"),n=require("tslib"),i=require("@firebase/logger"),r=require("@firebase/component");const s={PHONE:"phone"};exports.F=s;const o={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};exports.o=o;const a={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"};exports.S=a;const c={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"};exports.O=c;const u={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function d(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}exports.A=u;const h=d;exports.z=h;const p=l;exports.B=p;const m=new e.ErrorFactory("auth","Firebase",l()),f={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized"};exports.C=f;const g=new i.Logger("@firebase/auth");function v(e,...n){g.logLevel<=i.LogLevel.ERROR&&g.error(`Auth (${t.SDK_VERSION}): ${e}`,...n)}function I(e,...t){throw w(e,...t)}function _(e,...t){return w(e,...t)}function y(t,n,i){const r=Object.assign(Object.assign({},p()),{[n]:i});return new e.ErrorFactory("auth","Firebase",r).create(n,{appName:t.name})}function T(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&I(e,"argument-error"),y(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.`+"Did you pass a reference from a different Auth SDK?")}function w(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return m.create(e,...t)}function E(e,t,...n){if(!e)throw w(t,...n)}function k(e){const t="INTERNAL ASSERTION FAILED: "+e;throw v(t),new Error(t)}function A(e,t){e||k(t)}const N=new Map;function R(e){A(e instanceof Function,"Expected a class definition");let t=N.get(e);return t?(A(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,N.set(e,t),t)}function S(n,i){const r=(0,t._getProvider)(n,"auth");if(r.isInitialized()){const t=r.getImmediate(),n=r.getOptions();if((0,e.deepEqual)(n,null!=i?i:{}))return t;I(t,"already-initialized")}return r.initialize({options:i})}function b(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(R);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}function O(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function P(){return"http:"===D()||"https:"===D()}function D(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function C(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(P()||(0,e.isBrowserExtension)()||"connection"in navigator))||navigator.onLine}function L(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}class M{constructor(t,n){this.shortDelay=t,this.longDelay=n,A(n>t,"Short delay should be less than long delay!"),this.isMobile=(0,e.isMobileCordova)()||(0,e.isReactNative)()}get(){return C()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function x(e,t){A(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class U{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void k("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void k("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void k("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}exports.aI=U;const F={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},V=new M(3e4,6e4);function q(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function j(t,n,i,r,s={}){return H(t,s,async()=>{let s={},o={};r&&("GET"===n?o=r:s={body:JSON.stringify(r)});const a=(0,e.querystring)(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),U.fetch()(G(t,t.config.apiHost,i,a),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},s))})}async function H(t,n,i){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},F),n);try{const n=new W(t),o=await Promise.race([i(),n.promise]);n.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw K(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const e=o.ok?a.errorMessage:a.error.message,[n,i]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw K(t,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw K(t,"email-already-in-use",a);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw y(t,s,i);I(t,s)}}catch(s){if(s instanceof e.FirebaseError)throw s;I(t,"network-request-failed")}}async function z(e,t,n,i,r={}){const s=await j(e,t,n,i,r);return"mfaPendingCredential"in s&&I(e,"multi-factor-auth-required",{_serverResponse:s}),s}function G(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?x(e.config,r):`${e.config.apiScheme}://${r}`}class W{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(_(this.auth,"timeout")),V.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function K(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=_(e,t,i);return r.customData._tokenResponse=n,r}async function J(e,t){return j(e,"POST","/v1/accounts:delete",t)}async function B(e,t){return j(e,"POST","/v1/accounts:update",t)}async function $(e,t){return j(e,"POST","/v1/accounts:lookup",t)}function Y(e){if(e)try{const n=new Date(Number(e));if(!isNaN(n.getTime()))return n.toUTCString()}catch(t){}}function X(t,n=!1){return(0,e.getModularInstance)(t).getIdToken(n)}async function Q(t,n=!1){const i=(0,e.getModularInstance)(t),r=await i.getIdToken(n),s=ee(r);E(s&&s.exp&&s.auth_time&&s.iat,i.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:Y(Z(s.auth_time)),issuedAtTime:Y(Z(s.iat)),expirationTime:Y(Z(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function Z(e){return 1e3*Number(e)}function ee(t){const[n,i,r]=t.split(".");if(void 0===n||void 0===i||void 0===r)return v("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,e.base64Decode)(i);return t?JSON.parse(t):(v("Failed to decode base64 JWT payload"),null)}catch(s){return v("Caught error parsing JWT payload as JSON",s),null}}function te(e){const t=ee(e);return E(t,"internal-error"),E(void 0!==t.exp,"internal-error"),E(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function ne(t,n,i=!1){if(i)return n;try{return await n}catch(r){throw r instanceof e.FirebaseError&&ie(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ie({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class re{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class se{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Y(this.lastLoginAt),this.creationTime=Y(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function oe(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ne(e,$(n,{idToken:i}));E(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ue(s.providerUserInfo):[],a=ce(e.providerData,o),c=e.isAnonymous,u=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!c&&u,l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new se(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,l)}async function ae(t){const n=(0,e.getModularInstance)(t);await oe(n),await n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)}function ce(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function ue(e){return e.map(e=>{var{providerId:t}=e,i=(0,n.__rest)(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function de(t,n){const i=await H(t,{},async()=>{const i=(0,e.querystring)({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=G(t,r,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",U.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}class le{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){E(e.idToken,"internal-error"),E(void 0!==e.idToken,"internal-error"),E(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):te(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return E(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await de(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new le;return n&&(E("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(E("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(E("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new le,this.toJSON())}_performRefresh(){return k("not implemented")}}function he(e,t){E("string"==typeof e||void 0===e,"internal-error",{appName:t})}class pe{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=(0,n.__rest)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new re(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.metadata=new se(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ne(this,this.stsTokenManager.getToken(this.auth,e));return E(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Q(this,e)}reload(){return ae(this)}_assign(e){this!==e&&(E(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new pe(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){E(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await oe(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ne(this,J(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,m=null!==(o=t.tenantId)&&void 0!==o?o:void 0,f=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:I,emailVerified:_,isAnonymous:y,providerData:T,stsTokenManager:w}=t;E(I&&w,e,"internal-error");const k=le.fromJSON(this.name,w);E("string"==typeof I,e,"internal-error"),he(d,e.name),he(l,e.name),E("boolean"==typeof _,e,"internal-error"),E("boolean"==typeof y,e,"internal-error"),he(h,e.name),he(p,e.name),he(m,e.name),he(f,e.name),he(g,e.name),he(v,e.name);const A=new pe({uid:I,auth:e,email:l,emailVerified:_,displayName:d,isAnonymous:y,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:k,createdAt:g,lastLoginAt:v});return T&&Array.isArray(T)&&(A.providerData=T.map(e=>Object.assign({},e))),f&&(A._redirectEventId=f),A}static async _fromIdTokenResponse(e,t,n=!1){const i=new le;i.updateFromServerResponse(t);const r=new pe({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await oe(r),r}}exports.aD=pe;class me{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}me.type="NONE";const fe=me;function ge(e,t,n){return`firebase:${e}:${t}:${n}`}exports.K=fe;class ve{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=ge(this.userKey,i.apiKey,r),this.fullPersistenceKey=ge("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?pe._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ve(R(fe),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||R(fe);const s=ge(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=pe._fromJSON(e,t);u!==r&&(o=n),r=u;break}}catch(c){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(c){}})),new ve(r,e,n)):new ve(r,e,n)}}function Ie(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(we(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(_e(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ke(t))return"Blackberry";if(Ae(t))return"Webos";if(ye(t))return"Safari";if((t.includes("chrome/")||Te(t))&&!t.includes("edge/"))return"Chrome";if(Ee(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function _e(t=(0,e.getUA)()){return/firefox\//i.test(t)}function ye(t=(0,e.getUA)()){const n=t.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function Te(t=(0,e.getUA)()){return/crios\//i.test(t)}function we(t=(0,e.getUA)()){return/iemobile/i.test(t)}function Ee(t=(0,e.getUA)()){return/android/i.test(t)}function ke(t=(0,e.getUA)()){return/blackberry/i.test(t)}function Ae(t=(0,e.getUA)()){return/webos/i.test(t)}function Ne(t=(0,e.getUA)()){return/iphone|ipad|ipod/i.test(t)}function Re(t=(0,e.getUA)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function Se(t=(0,e.getUA)()){var n;return Ne(t)&&!!(null===(n=window.navigator)||void 0===n?void 0:n.standalone)}function be(){return(0,e.isIE)()&&10===document.documentMode}function Oe(t=(0,e.getUA)()){return Ne(t)||Ee(t)||Ae(t)||ke(t)||/windows phone/i.test(t)||we(t)}function Pe(){try{return!(!window||window===window.top)}catch(e){return!1}}function De(n,i=[]){let r;switch(n){case"Browser":r=Ie((0,e.getUA)());break;case"Worker":r=`${Ie((0,e.getUA)())}-${n}`;break;default:r=n}const s=i.length?i.join(","):"FirebaseCore-web";return`${r}/JsCore/${t.SDK_VERSION}/${s}`}class Ce{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Me(this),this.idTokenSubscription=new Me(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=R(t)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await ve.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e)):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);i&&i!==r||null==s||!s.user||(n=s.user)}return n?n._redirectEventId?(E(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await oe(e)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=L()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const n=t?(0,e.getModularInstance)(t):null;return n&&E(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&E(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(R(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new e.ErrorFactory("auth","Firebase",t())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&R(e)||this._popupRedirectResolver;E(t,this,"argument-error"),this.redirectPersistenceManager=await ve.create(this,[R(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return E(s,this,"internal-error"),s.then(()=>r(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return E(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=De(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};return this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId),e}}function Le(t){return(0,e.getModularInstance)(t)}exports.aE=Ce;class Me{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,e.createSubscribe)(e=>this.observer=e)}get next(){return E(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function xe(e,t,n){const i=Le(e);E(i._canInitEmulator,i,"emulator-config-failed"),E(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Ue(t),{host:o,port:a}=Fe(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||qe()}function Ue(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Fe(e){const t=Ue(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:Ve(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:Ve(t)}}}function Ve(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function qe(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}class je{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return k("not implemented")}_getIdTokenResponse(e){return k("not implemented")}_linkToIdToken(e,t){return k("not implemented")}_getReauthenticationResolver(e){return k("not implemented")}}async function He(e,t){return j(e,"POST","/v1/accounts:resetPassword",q(e,t))}async function ze(e,t){return j(e,"POST","/v1/accounts:update",t)}async function Ge(e,t){return j(e,"POST","/v1/accounts:update",q(e,t))}async function We(e,t){return z(e,"POST","/v1/accounts:signInWithPassword",q(e,t))}async function Ke(e,t){return j(e,"POST","/v1/accounts:sendOobCode",q(e,t))}async function Je(e,t){return Ke(e,t)}async function Be(e,t){return Ke(e,t)}async function $e(e,t){return Ke(e,t)}async function Ye(e,t){return Ke(e,t)}async function Xe(e,t){return z(e,"POST","/v1/accounts:signInWithEmailLink",q(e,t))}async function Qe(e,t){return z(e,"POST","/v1/accounts:signInWithEmailLink",q(e,t))}exports.G=je;class Ze extends je{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ze(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ze(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return We(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Xe(e,{email:this._email,oobCode:this._password});default:I(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ze(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Qe(e,{idToken:t,email:this._email,oobCode:this._password});default:I(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function et(e,t){return z(e,"POST","/v1/accounts:signInWithIdp",q(e,t))}exports.H=Ze;const tt="http://localhost";class nt extends je{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new nt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):I("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=(0,n.__rest)(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new nt(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return et(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,et(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,et(e,t)}buildRequest(){const t={requestUri:tt,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=(0,e.querystring)(n)}return t}}async function it(e,t){return j(e,"POST","/v1/accounts:sendVerificationCode",q(e,t))}async function rt(e,t){return z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,t))}async function st(e,t){const n=await z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,t));if(n.temporaryProof)throw K(e,"account-exists-with-different-credential",n);return n}exports.I=nt;const ot={USER_NOT_FOUND:"user-not-found"};async function at(e,t){return z(e,"POST","/v1/accounts:signInWithPhoneNumber",q(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ot)}class ct extends je{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ct({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ct({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return rt(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return st(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return at(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new ct({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}function ut(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function dt(t){const n=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).link,i=n?(0,e.querystringDecode)((0,e.extractQuerystring)(n)).deep_link_id:null,r=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).deep_link_id;return(r?(0,e.querystringDecode)((0,e.extractQuerystring)(r)).link:null)||r||i||n||t}exports.J=ct;class lt{constructor(t){var n,i,r,s,o,a;const c=(0,e.querystringDecode)((0,e.extractQuerystring)(t)),u=null!==(n=c.apiKey)&&void 0!==n?n:null,d=null!==(i=c.oobCode)&&void 0!==i?i:null,l=ut(null!==(r=c.mode)&&void 0!==r?r:null);E(u&&d&&l,"argument-error"),this.apiKey=u,this.operation=l,this.code=d,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=dt(e);try{return new lt(t)}catch(n){return null}}}function ht(e){return lt.parseLink(e)}exports.ac=lt;class pt{constructor(){this.providerId=pt.PROVIDER_ID}static credential(e,t){return Ze._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=lt.parseLink(t);return E(n,"argument-error"),Ze._fromEmailAndCode(e,n.code,n.tenantId)}}exports.L=pt,pt.PROVIDER_ID="password",pt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",pt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class mt{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ft extends mt{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class gt extends ft{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return E("providerId"in t&&"signInMethod"in t,"argument-error"),nt._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return E(e.idToken||e.accessToken,"argument-error"),nt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return gt.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return gt.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:s,providerId:o}=e;if(!(n||i||t||r))return null;if(!o)return null;try{return new gt(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:r})}catch(a){return null}}}exports.T=gt;class vt extends ft{constructor(){super("facebook.com")}static credential(e){return nt._fromParams({providerId:vt.PROVIDER_ID,signInMethod:vt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vt.credentialFromTaggedObject(e)}static credentialFromError(e){return vt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return vt.credential(e.oauthAccessToken)}catch(t){return null}}}exports.M=vt,vt.FACEBOOK_SIGN_IN_METHOD="facebook.com",vt.PROVIDER_ID="facebook.com";class It extends ft{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return nt._fromParams({providerId:It.PROVIDER_ID,signInMethod:It.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return It.credentialFromTaggedObject(e)}static credentialFromError(e){return It.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return It.credential(t,n)}catch(i){return null}}}exports.N=It,It.GOOGLE_SIGN_IN_METHOD="google.com",It.PROVIDER_ID="google.com";class _t extends ft{constructor(){super("github.com")}static credential(e){return nt._fromParams({providerId:_t.PROVIDER_ID,signInMethod:_t.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _t.credentialFromTaggedObject(e)}static credentialFromError(e){return _t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return _t.credential(e.oauthAccessToken)}catch(t){return null}}}exports.Q=_t,_t.GITHUB_SIGN_IN_METHOD="github.com",_t.PROVIDER_ID="github.com";const yt="http://localhost";class Tt extends je{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return et(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,et(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,et(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,pendingToken:r}=t;return n&&i&&r&&n===i?new Tt(n,r):null}static _create(e,t){return new Tt(e,t)}buildRequest(){return{requestUri:yt,returnSecureToken:!0,pendingToken:this.pendingToken}}}exports.aJ=Tt;const wt="saml.";class Et extends mt{constructor(e){E(e.startsWith(wt),"argument-error"),super(e)}static credentialFromResult(e){return Et.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Et.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Tt.fromJSON(e);return E(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return Tt._create(n,t)}catch(i){return null}}}exports.U=Et;class kt extends ft{constructor(){super("twitter.com")}static credential(e,t){return nt._fromParams({providerId:kt.PROVIDER_ID,signInMethod:kt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return kt.credentialFromTaggedObject(e)}static credentialFromError(e){return kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return kt.credential(t,n)}catch(i){return null}}}async function At(e,t){return z(e,"POST","/v1/accounts:signUp",q(e,t))}exports.V=kt,kt.TWITTER_SIGN_IN_METHOD="twitter.com",kt.PROVIDER_ID="twitter.com";class Nt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await pe._fromIdTokenResponse(e,n,i),s=Rt(n);return new Nt({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Rt(n);return new Nt({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Rt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function St(e){var t;const n=Le(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Nt({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await At(n,{returnSecureToken:!0}),r=await Nt._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(r.user),r}class bt extends e.FirebaseError{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,bt.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new bt(e,t,n,i)}}function Ot(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw bt._fromErrorAndOperation(e,n,t,i);throw n})}function Pt(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function Dt(t,n){const i=(0,e.getModularInstance)(t);await Lt(!0,i,n);const{providerUserInfo:r}=await B(i.auth,{idToken:await i.getIdToken(),deleteProvider:[n]}),s=Pt(r||[]);return i.providerData=i.providerData.filter(e=>s.has(e.providerId)),s.has("phone")||(i.phoneNumber=null),await i.auth._persistUserIfCurrent(i),i}async function Ct(e,t,n=!1){const i=await ne(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Nt._forOperation(e,"link",i)}async function Lt(e,t,n){await oe(t);const i=!1===e?"provider-already-linked":"no-such-provider";E(Pt(t.providerData).has(n)===e,t.auth,i)}async function Mt(e,t,n=!1){const{auth:i}=e;try{const s=await ne(e,Ot(i,"reauthenticate",t,e),n);E(s.idToken,i,"internal-error");const o=ee(s.idToken);E(o,i,"internal-error");const{sub:a}=o;return E(e.uid===a,i,"user-mismatch"),Nt._forOperation(e,"reauthenticate",s)}catch(r){throw"auth/user-not-found"===(null==r?void 0:r.code)&&I(i,"user-mismatch"),r}}async function xt(e,t,n=!1){const i=await Ot(e,"signIn",t),r=await Nt._fromIdTokenResponse(e,"signIn",i);return n||await e._updateCurrentUser(r.user),r}async function Ut(e,t){return xt(Le(e),t)}async function Ft(t,n){const i=(0,e.getModularInstance)(t);return await Lt(!1,i,n.providerId),Ct(i,n)}async function Vt(t,n){return Mt((0,e.getModularInstance)(t),n)}async function qt(e,t){return z(e,"POST","/v1/accounts:signInWithCustomToken",q(e,t))}async function jt(e,t){const n=Le(e),i=await qt(n,{token:t,returnSecureToken:!0}),r=await Nt._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(r.user),r}class Ht{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?zt._fromServerResponse(e,t):I(e,"internal-error")}}class zt extends Ht{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new zt(t)}}function Gt(e,t,n){var i;E((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),E(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(E(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(E(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Wt(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"PASSWORD_RESET",email:n};i&&Gt(r,s,i),await Be(r,s)}async function Kt(t,n,i){await He((0,e.getModularInstance)(t),{oobCode:n,newPassword:i})}async function Jt(t,n){await Ge((0,e.getModularInstance)(t),{oobCode:n})}async function Bt(t,n){const i=(0,e.getModularInstance)(t),r=await He(i,{oobCode:n}),s=r.requestType;switch(E(s,i,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":E(r.newEmail,i,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":E(r.mfaInfo,i,"internal-error");default:E(r.email,i,"internal-error")}let o=null;return r.mfaInfo&&(o=Ht._fromServerResponse(Le(i),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:o},operation:s}}async function $t(t,n){const{data:i}=await Bt((0,e.getModularInstance)(t),n);return i.email}async function Yt(e,t,n){const i=Le(e),r=await At(i,{returnSecureToken:!0,email:t,password:n}),s=await Nt._fromIdTokenResponse(i,"signIn",r);return await i._updateCurrentUser(s.user),s}function Xt(t,n,i){return Ut((0,e.getModularInstance)(t),pt.credential(n,i))}async function Qt(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"EMAIL_SIGNIN",email:n};E(i.handleCodeInApp,r,"argument-error"),i&&Gt(r,s,i),await $e(r,s)}function Zt(e,t){const n=lt.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function en(t,n,i){const r=(0,e.getModularInstance)(t),s=pt.credentialWithLink(n,i||O());return E(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ut(r,s)}async function tn(e,t){return j(e,"POST","/v1/accounts:createAuthUri",q(e,t))}async function nn(t,n){const i={identifier:n,continueUri:P()?O():"http://localhost"},{signinMethods:r}=await tn((0,e.getModularInstance)(t),i);return r||[]}async function rn(t,n){const i=(0,e.getModularInstance)(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};n&&Gt(i.auth,r,n);const{email:s}=await Je(i.auth,r);s!==t.email&&await t.reload()}async function sn(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:n};i&&Gt(r.auth,s,i);const{email:o}=await Ye(r.auth,s);o!==t.email&&await t.reload()}async function on(e,t){return j(e,"POST","/v1/accounts:update",t)}async function an(t,{displayName:n,photoURL:i}){if(void 0===n&&void 0===i)return;const r=(0,e.getModularInstance)(t),s={idToken:await r.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},o=await ne(r,on(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function cn(t,n){return dn((0,e.getModularInstance)(t),n,null)}function un(t,n){return dn((0,e.getModularInstance)(t),null,n)}async function dn(e,t,n){const{auth:i}=e,r={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(r.email=t),n&&(r.password=n);const s=await ne(e,ze(i,r));await e._updateTokensIfNecessary(s,!0)}function ln(e){var t,n;if(!e)return null;const{providerId:i}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!i&&(null==e?void 0:e.idToken)){const i=null===(n=null===(t=ee(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(i){return new hn(s,"anonymous"!==i&&"custom"!==i?i:null)}}if(!i)return null;switch(i){case"facebook.com":return new mn(s,r);case"github.com":return new fn(s,r);case"google.com":return new gn(s,r);case"twitter.com":return new vn(s,r,e.screenName||null);case"custom":case"anonymous":return new hn(s,null);default:return new hn(s,i,r)}}class hn{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class pn extends hn{constructor(e,t,n,i){super(e,t,n),this.username=i}}class mn extends hn{constructor(e,t){super(e,"facebook.com",t)}}class fn extends pn{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class gn extends hn{constructor(e,t){super(e,"google.com",t)}}class vn extends pn{constructor(e,t,n){super(e,"twitter.com",t,n)}}function In(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:ln(n)}function _n(t,n){return(0,e.getModularInstance)(t).setPersistence(n)}function yn(t,n,i,r){return(0,e.getModularInstance)(t).onIdTokenChanged(n,i,r)}function Tn(t,n,i,r){return(0,e.getModularInstance)(t).onAuthStateChanged(n,i,r)}function wn(t){(0,e.getModularInstance)(t).useDeviceLanguage()}function En(t,n){return(0,e.getModularInstance)(t).updateCurrentUser(n)}function kn(t){return(0,e.getModularInstance)(t).signOut()}async function An(t){return(0,e.getModularInstance)(t).delete()}class Nn{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new Nn("enroll",e)}static _fromMfaPendingCredential(e){return new Nn("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return Nn._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return Nn._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Rn{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Le(e),i=t.customData._serverResponse,r=(i.mfaInfo||[]).map(e=>Ht._fromServerResponse(n,e));E(i.mfaPendingCredential,n,"internal-error");const s=Nn._fromMfaPendingCredential(i.mfaPendingCredential);return new Rn(s,r,async e=>{const r=await e._process(n,s);delete i.mfaInfo,delete i.mfaPendingCredential;const o=Object.assign(Object.assign({},i),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Nt._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return E(t.user,n,"internal-error"),Nt._forOperation(t.user,t.operationType,o);default:I(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function Sn(t,n){var i;const r=(0,e.getModularInstance)(t),s=n;return E(n.customData.operationType,r,"argument-error"),E(null===(i=s.customData._serverResponse)||void 0===i?void 0:i.mfaPendingCredential,r,"argument-error"),Rn._fromError(r,s)}function bn(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:start",q(e,t))}function On(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:finalize",q(e,t))}function Pn(e,t){return j(e,"POST","/v2/accounts/mfaEnrollment:withdraw",q(e,t))}class Dn{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>Ht._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new Dn(e)}async getSession(){return Nn._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,i=await this.getSession(),r=await ne(this.user,n._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken(),i=await ne(this.user,Pn(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(r){if("auth/user-token-expired"!==r.code)throw r}}}const Cn=new WeakMap;function Ln(t){const n=(0,e.getModularInstance)(t);return Cn.has(n)||Cn.set(n,Dn._fromUser(n)),Cn.get(n)}const Mn="__sak";class xn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Mn,"1"),this.storage.removeItem(Mn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function Un(){const t=(0,e.getUA)();return ye(t)||Ne(t)}const Fn=1e3,Vn=10;class qn extends xn{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=((e,t)=>this.onStorageEvent(e,t)),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=Un()&&Pe(),this.fallbackToPolling=Oe(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);be()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Vn):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},Fn)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qn.type="LOCAL";const jn=qn;exports.b=jn;class Hn extends xn{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Hn.type="SESSION";const zn=Hn;function Gn(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}exports.a=zn;class Wn{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Wn(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async e=>e(t.origin,r)),a=await Gn(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Kn(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Wn.receivers=[];class Jn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const c=Kn("",20);i.port1.start();const u=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Bn(){return window}function $n(e){Bn().location.href=e}function Yn(){return void 0!==Bn().WorkerGlobalScope&&"function"==typeof Bn().importScripts}async function Xn(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}function Qn(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}function Zn(){return Yn()?self:null}const ei="firebaseLocalStorageDb",ti=1,ni="firebaseLocalStorage",ii="fbase_key";class ri{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function si(e,t){return e.transaction([ni],t?"readwrite":"readonly").objectStore(ni)}function oi(){const e=indexedDB.deleteDatabase(ei);return new ri(e).toPromise()}function ai(){const e=indexedDB.open(ei,ti);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(ni,{keyPath:ii})}catch(i){n(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(ni)?t(n):(n.close(),await oi(),t(await ai()))})})}async function ci(e,t,n){const i=si(e,!0).put({[ii]:t,value:n});return new ri(i).toPromise()}async function ui(e,t){const n=si(e,!1).get(t),i=await new ri(n).toPromise();return void 0===i?null:i.value}function di(e,t){const n=si(e,!0).delete(t);return new ri(n).toPromise()}const li=800,hi=3;class pi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ai(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(n){if(t++>hi)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Yn()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wn._getInstance(Zn()),this.receiver._subscribe("keyChanged",async(e,t)=>{return{keyProcessed:(await this._poll()).includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Xn(),!this.activeServiceWorker)return;this.sender=new Jn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&Qn()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await ai();return await ci(t,Mn,"1"),await di(t,Mn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ci(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>ui(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>di(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=si(e,!1).getAll();return new ri(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),li)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}pi.type="LOCAL";const mi=pi;function fi(e,t){return j(e,"POST","/v2/accounts/mfaSignIn:start",q(e,t))}function gi(e,t){return j(e,"POST","/v2/accounts/mfaSignIn:finalize",q(e,t))}async function vi(e){return(await j(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}function Ii(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}function _i(e){return new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=(e=>{const t=_("internal-error");t.customData=e,n(t)}),i.type="text/javascript",i.charset="UTF-8",Ii().appendChild(i)})}function yi(e){return`__${e}${Math.floor(1e6*Math.random())}`}exports.i=mi;const Ti=500,wi=6e4,Ei=1e12;class ki{constructor(e){this.auth=e,this.counter=Ei,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Ai(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Ei;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Ei;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Ei;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Ai{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=(()=>{this.execute()});const i="string"==typeof e?document.getElementById(e):e;E(i,"argument-error",{appName:t}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=Ni(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},wi)},Ti))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Ni(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}const Ri=yi("rcb"),Si=new M(3e4,6e4),bi="https://www.google.com/recaptcha/api.js?";class Oi{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!Bn().grecaptcha}load(t,n=""){return E(Pi(n),t,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(Bn().grecaptcha):new Promise((i,r)=>{const s=Bn().setTimeout(()=>{r(_(t,"network-request-failed"))},Si.get());Bn()[Ri]=(()=>{Bn().clearTimeout(s),delete Bn()[Ri];const e=Bn().grecaptcha;if(!e)return void r(_(t,"internal-error"));const o=e.render;e.render=((e,t)=>{const n=o(e,t);return this.counter++,n}),this.hostLanguage=n,i(e)}),_i(`${bi}?${(0,e.querystring)({onload:Ri,render:"explicit",hl:n})}`).catch(()=>{clearTimeout(s),r(_(t,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!Bn().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Pi(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}class Di{async load(e){return new ki(e)}clearedOneInstance(){}}const Ci="recaptcha",Li={theme:"light",type:"image"};class Mi{constructor(e,t=Object.assign({},Li),n){this.parameters=t,this.type=Ci,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Le(n),this.isInvisible="invisible"===this.parameters.size,E("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof e?document.getElementById(e):e;E(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Di:new Oi,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const i=e=>{e&&(this.tokenChangeListeners.delete(i),n(e))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){E(!this.parameters.sitekey,this.auth,"argument-error"),E(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),E("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){const n=Bn()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){E(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){E(P()&&!Yn(),this.auth,"internal-error"),await xi(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await vi(this.auth);E(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return E(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function xi(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=(()=>t()),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}exports.R=Mi;class Ui{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=ct._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Fi(t,n,i){const r=Le(t),s=await ji(r,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Ut(r,e))}async function Vi(t,n,i){const r=(0,e.getModularInstance)(t);await Lt(!1,r,"phone");const s=await ji(r.auth,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Ft(r,e))}async function qi(t,n,i){const r=(0,e.getModularInstance)(t),s=await ji(r.auth,n,(0,e.getModularInstance)(i));return new Ui(s,e=>Vt(r,e))}async function ji(e,t,n){var i;const r=await n.verify();try{let s;if(E("string"==typeof r,e,"argument-error"),E(n.type===Ci,e,"argument-error"),"session"in(s="string"==typeof t?{phoneNumber:t}:t)){const t=s.session;if("phoneNumber"in s){return E("enroll"===t.type,e,"internal-error"),(await bn(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo}{E("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;return E(n,e,"missing-multi-factor-info"),(await fi(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await it(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}async function Hi(t,n){await Ct((0,e.getModularInstance)(t),n)}class zi{constructor(e){this.providerId=zi.PROVIDER_ID,this.auth=Le(e)}verifyPhoneNumber(t,n){return ji(this.auth,t,(0,e.getModularInstance)(n))}static credential(e,t){return ct._fromVerification(e,t)}static credentialFromResult(e){const t=e;return zi.credentialFromTaggedObject(t)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?ct._fromTokenResponse(t,n):null}}function Gi(e,t){return t?R(t):(E(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}exports.P=zi,zi.PROVIDER_ID="phone",zi.PHONE_SIGN_IN_METHOD="phone";class Wi extends je{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return et(e,this._buildIdpRequest())}_linkToIdToken(e,t){return et(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return et(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ki(e){return xt(e.auth,new Wi(e),e.bypassAuthState)}function Ji(e){const{auth:t,user:n}=e;return E(n,t,"internal-error"),Mt(n,new Wi(e),e.bypassAuthState)}async function Bi(e){const{auth:t,user:n}=e;return E(n,t,"internal-error"),Ct(n,new Wi(e),e.bypassAuthState)}class $i{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ki;case"linkViaPopup":case"linkViaRedirect":return Bi;case"reauthViaPopup":case"reauthViaRedirect":return Ji;default:I(this.auth,"internal-error")}}resolve(e){A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){A(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Yi=new M(2e3,1e4);async function Xi(e,t,n){const i=Le(e);T(e,t,mt);const r=Gi(i,n);return new er(i,"signInViaPopup",t,r).executeNotNull()}async function Qi(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);return new er(r.auth,"reauthViaPopup",n,s,r).executeNotNull()}async function Zi(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);return new er(r.auth,"linkViaPopup",n,s,r).executeNotNull()}class er extends $i{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,er.currentPopupAction&&er.currentPopupAction.cancel(),er.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return E(e,this.auth,"internal-error"),e}async onExecution(){A(1===this.filter.length,"Popup operations only handle one event");const e=Kn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,er.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;null!==(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)&&void 0!==n&&n.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_(this.auth,"popup-closed-by-user"))},2e3):this.pollId=window.setTimeout(e,Yi.get())};e()}}er.currentPopupAction=null;const tr="pendingRedirect",nr=new Map;class ir extends $i{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=nr.get(this.auth._key());if(!e){try{const n=await rr(this.resolver,this.auth)?await super.execute():null;e=(()=>Promise.resolve(n))}catch(t){e=(()=>Promise.reject(t))}nr.set(this.auth._key(),e)}return this.bypassAuthState||nr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function rr(e,t){const n=cr(t),i=ar(e);if(!(await i._isAvailable()))return!1;const r="true"===await i._get(n);return await i._remove(n),r}async function sr(e,t){return ar(e)._set(cr(t),"true")}function or(){nr.clear()}function ar(e){return R(e._redirectPersistence)}function cr(e){return ge(tr,e.config.apiKey,e.name)}function ur(e,t,n){return dr(e,t,n)}async function dr(e,t,n){const i=Le(e);T(e,t,mt);const r=Gi(i,n);return await sr(r,i),r._openRedirect(i,t,"signInViaRedirect")}function lr(e,t,n){return hr(e,t,n)}async function hr(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);await sr(s,r.auth);const o=await vr(r);return s._openRedirect(r.auth,n,"reauthViaRedirect",o)}function pr(e,t,n){return mr(e,t,n)}async function mr(t,n,i){const r=(0,e.getModularInstance)(t);T(r.auth,n,mt);const s=Gi(r.auth,i);await Lt(!1,r,n.providerId),await sr(s,r.auth);const o=await vr(r);return s._openRedirect(r.auth,n,"linkViaRedirect",o)}async function fr(e,t){return await Le(e)._initializationPromise,gr(e,t,!1)}async function gr(e,t,n=!1){const i=Le(e),r=Gi(i,t),s=new ir(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}async function vr(e){const t=Kn(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}const Ir=6e5;class _r{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wr(e)?t:(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0),t)}sendToConsumer(e,t){var n;if(e.error&&!Tr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(_(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ir&&this.cachedEventUids.clear(),this.cachedEventUids.has(yr(e))}saveEventToCache(e){this.cachedEventUids.add(yr(e)),this.lastProcessedEventTime=Date.now()}}function yr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Tr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function wr(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tr(e);default:return!1}}async function Er(e,t={}){return j(e,"GET","/v1/projects",t)}exports.az=_r;const kr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ar=/^https?/;async function Nr(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Er(e);for(const i of t)try{if(Rr(i))return}catch(n){}I(e,"unauthorized-domain")}function Rr(e){const t=O(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Ar.test(n))return!1;if(kr.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Sr=new M(3e4,6e4);function br(){const e=Bn().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Or(e){return new Promise((t,n)=>{var i,r,s;function o(){br(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{br(),n(_(e,"network-request-failed"))},timeout:Sr.get()})}if(null===(r=null===(i=Bn().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(null===(s=Bn().gapi)||void 0===s||!s.load){const t=yi("iframefcb");return Bn()[t]=(()=>{gapi.load?o():n(_(e,"network-request-failed"))}),_i(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw Pr=null,e})}let Pr=null;function Dr(e){return Pr=Pr||Or(e)}const Cr=new M(5e3,15e3),Lr="__/auth/iframe",Mr="emulator/auth/iframe",xr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ur=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fr(n){const i=n.config;E(i.authDomain,n,"auth-domain-config-required");const r=i.emulator?x(i,Mr):`https://${n.config.authDomain}/${Lr}`,s={apiKey:i.apiKey,appName:n.name,v:t.SDK_VERSION},o=Ur.get(n.config.apiHost);o&&(s.eid=o);const a=n._getFrameworks();return a.length&&(s.fw=a.join(",")),`${r}?${(0,e.querystring)(s).slice(1)}`}async function Vr(e){const t=await Dr(e),n=Bn().gapi;return E(n,e,"internal-error"),t.open({where:document.body,url:Fr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xr,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=_(e,"network-request-failed"),s=Bn().setTimeout(()=>{i(r)},Cr.get());function o(){Bn().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})}))}const qr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jr=500,Hr=600,zr="_blank",Gr="http://localhost";class Wr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Kr(t,n,i,r=jr,s=Hr){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},qr),{width:r.toString(),height:s.toString(),top:o,left:a}),d=(0,e.getUA)().toLowerCase();i&&(c=Te(d)?zr:i),_e(d)&&(n=n||Gr,u.scrollbars="yes");const l=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(Se(d)&&"_self"!==c)return Jr(n||"",c),new Wr(null);const h=window.open(n||"",c,l);E(h,t,"popup-blocked");try{h.focus()}catch(p){}return new Wr(h)}function Jr(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}exports.aH=Wr;const Br="__/auth/handler",$r="emulator/auth/handler";function Yr(n,i,r,s,o,a){E(n.config.authDomain,n,"auth-domain-config-required"),E(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:r,redirectUrl:s,v:t.SDK_VERSION,eventId:o};if(i instanceof mt){i.setDefaultLanguage(n.languageCode),c.providerId=i.providerId||"",(0,e.isEmpty)(i.getCustomParameters())||(c.customParameters=JSON.stringify(i.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(i instanceof ft){const e=i.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}n.tenantId&&(c.tid=n.tenantId);const u=c;for(const e of Object.keys(u))void 0===u[e]&&delete u[e];return`${Xr(n)}?${(0,e.querystring)(u).slice(1)}`}function Xr({config:e}){return e.emulator?x(e,$r):`https://${e.authDomain}/${Br}`}const Qr="webStorageSupport";class Zr{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zn,this._completeRedirectFn=gr}async _openPopup(e,t,n,i){var r;return A(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),Kr(e,Yr(e,t,n,O(),i),Kn())}async _openRedirect(e,t,n,i){return await this._originValidation(e),$n(Yr(e,t,n,O(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(A(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Vr(e),n=new _r(e);return t.register("authEvent",t=>{return E(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qr,{type:Qr},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Qr];void 0!==r&&t(!!r),I(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Nr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Oe()||ye()||Ne()}}const es=Zr;exports.k=es;class ts{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return k("unexpected MultiFactorSessionType")}}}class ns extends ts{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ns(e)}_finalizeEnroll(e,t,n){return On(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return gi(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class is{constructor(){}static assertion(e){return ns._fromCredential(e)}}exports.m=is,is.FACTOR_ID="phone";var rs="@firebase/auth",ss="0.19.4";class os{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){E(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function as(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function cs(e){(0,t._registerComponent)(new r.Component("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),{apiKey:r,authDomain:s}=i.options;return(t=>{E(r&&!r.includes(":"),"invalid-api-key",{appName:t.name}),E(!(null==s?void 0:s.includes(":")),"argument-error",{appName:t.name});const i={apiKey:r,authDomain:s,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:De(e)},o=new Ce(t,i);return b(o,n),o})(i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,t._registerComponent)(new r.Component("auth-internal",e=>{return(e=>new os(e))(Le(e.getProvider("auth").getImmediate()))},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,t.registerVersion)(rs,ss,as(e)),(0,t.registerVersion)(rs,ss,"esm2017")}function us(e=(0,t.getApp)()){const n=(0,t._getProvider)(e,"auth");return n.isInitialized()?n.getImmediate():S(e,{popupRedirectResolver:es,persistence:[mi,jn,zn]})}cs("Browser");
},{"@firebase/util":"chA2","@firebase/app":"h2Mb","tslib":"vCxL","@firebase/logger":"JJem","@firebase/component":"vhY9"}],"QWyA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ActionCodeOperation",{enumerable:!0,get:function(){return e.A}}),Object.defineProperty(exports,"ActionCodeURL",{enumerable:!0,get:function(){return e.ac}}),Object.defineProperty(exports,"AuthCredential",{enumerable:!0,get:function(){return e.G}}),Object.defineProperty(exports,"AuthErrorCodes",{enumerable:!0,get:function(){return e.C}}),Object.defineProperty(exports,"EmailAuthCredential",{enumerable:!0,get:function(){return e.H}}),Object.defineProperty(exports,"EmailAuthProvider",{enumerable:!0,get:function(){return e.L}}),Object.defineProperty(exports,"FacebookAuthProvider",{enumerable:!0,get:function(){return e.M}}),Object.defineProperty(exports,"FactorId",{enumerable:!0,get:function(){return e.F}}),Object.defineProperty(exports,"GithubAuthProvider",{enumerable:!0,get:function(){return e.Q}}),Object.defineProperty(exports,"GoogleAuthProvider",{enumerable:!0,get:function(){return e.N}}),Object.defineProperty(exports,"OAuthCredential",{enumerable:!0,get:function(){return e.I}}),Object.defineProperty(exports,"OAuthProvider",{enumerable:!0,get:function(){return e.T}}),Object.defineProperty(exports,"OperationType",{enumerable:!0,get:function(){return e.O}}),Object.defineProperty(exports,"PhoneAuthCredential",{enumerable:!0,get:function(){return e.J}}),Object.defineProperty(exports,"PhoneAuthProvider",{enumerable:!0,get:function(){return e.P}}),Object.defineProperty(exports,"PhoneMultiFactorGenerator",{enumerable:!0,get:function(){return e.m}}),Object.defineProperty(exports,"ProviderId",{enumerable:!0,get:function(){return e.o}}),Object.defineProperty(exports,"RecaptchaVerifier",{enumerable:!0,get:function(){return e.R}}),Object.defineProperty(exports,"SAMLAuthProvider",{enumerable:!0,get:function(){return e.U}}),Object.defineProperty(exports,"SignInMethod",{enumerable:!0,get:function(){return e.S}}),Object.defineProperty(exports,"TwitterAuthProvider",{enumerable:!0,get:function(){return e.V}}),Object.defineProperty(exports,"applyActionCode",{enumerable:!0,get:function(){return e.a1}}),Object.defineProperty(exports,"browserLocalPersistence",{enumerable:!0,get:function(){return e.b}}),Object.defineProperty(exports,"browserPopupRedirectResolver",{enumerable:!0,get:function(){return e.k}}),Object.defineProperty(exports,"browserSessionPersistence",{enumerable:!0,get:function(){return e.a}}),Object.defineProperty(exports,"checkActionCode",{enumerable:!0,get:function(){return e.a2}}),Object.defineProperty(exports,"confirmPasswordReset",{enumerable:!0,get:function(){return e.a0}}),Object.defineProperty(exports,"connectAuthEmulator",{enumerable:!0,get:function(){return e.E}}),Object.defineProperty(exports,"createUserWithEmailAndPassword",{enumerable:!0,get:function(){return e.a4}}),Object.defineProperty(exports,"debugErrorMap",{enumerable:!0,get:function(){return e.z}}),Object.defineProperty(exports,"deleteUser",{enumerable:!0,get:function(){return e.y}}),Object.defineProperty(exports,"fetchSignInMethodsForEmail",{enumerable:!0,get:function(){return e.a9}}),Object.defineProperty(exports,"getAdditionalUserInfo",{enumerable:!0,get:function(){return e.ak}}),Object.defineProperty(exports,"getAuth",{enumerable:!0,get:function(){return e.n}}),Object.defineProperty(exports,"getIdToken",{enumerable:!0,get:function(){return e.ah}}),Object.defineProperty(exports,"getIdTokenResult",{enumerable:!0,get:function(){return e.ai}}),Object.defineProperty(exports,"getMultiFactorResolver",{enumerable:!0,get:function(){return e.am}}),Object.defineProperty(exports,"getRedirectResult",{enumerable:!0,get:function(){return e.j}}),Object.defineProperty(exports,"inMemoryPersistence",{enumerable:!0,get:function(){return e.K}}),Object.defineProperty(exports,"indexedDBLocalPersistence",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(exports,"initializeAuth",{enumerable:!0,get:function(){return e.D}}),Object.defineProperty(exports,"isSignInWithEmailLink",{enumerable:!0,get:function(){return e.a7}}),Object.defineProperty(exports,"linkWithCredential",{enumerable:!0,get:function(){return e.Y}}),Object.defineProperty(exports,"linkWithPhoneNumber",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(exports,"linkWithPopup",{enumerable:!0,get:function(){return e.d}}),Object.defineProperty(exports,"linkWithRedirect",{enumerable:!0,get:function(){return e.g}}),Object.defineProperty(exports,"multiFactor",{enumerable:!0,get:function(){return e.an}}),Object.defineProperty(exports,"onAuthStateChanged",{enumerable:!0,get:function(){return e.t}}),Object.defineProperty(exports,"onIdTokenChanged",{enumerable:!0,get:function(){return e.q}}),Object.defineProperty(exports,"parseActionCodeURL",{enumerable:!0,get:function(){return e.ad}}),Object.defineProperty(exports,"prodErrorMap",{enumerable:!0,get:function(){return e.B}}),Object.defineProperty(exports,"reauthenticateWithCredential",{enumerable:!0,get:function(){return e.Z}}),Object.defineProperty(exports,"reauthenticateWithPhoneNumber",{enumerable:!0,get:function(){return e.r}}),Object.defineProperty(exports,"reauthenticateWithPopup",{enumerable:!0,get:function(){return e.e}}),Object.defineProperty(exports,"reauthenticateWithRedirect",{enumerable:!0,get:function(){return e.h}}),Object.defineProperty(exports,"reload",{enumerable:!0,get:function(){return e.al}}),Object.defineProperty(exports,"sendEmailVerification",{enumerable:!0,get:function(){return e.aa}}),Object.defineProperty(exports,"sendPasswordResetEmail",{enumerable:!0,get:function(){return e.$}}),Object.defineProperty(exports,"sendSignInLinkToEmail",{enumerable:!0,get:function(){return e.a6}}),Object.defineProperty(exports,"setPersistence",{enumerable:!0,get:function(){return e.p}}),Object.defineProperty(exports,"signInAnonymously",{enumerable:!0,get:function(){return e.W}}),Object.defineProperty(exports,"signInWithCredential",{enumerable:!0,get:function(){return e.X}}),Object.defineProperty(exports,"signInWithCustomToken",{enumerable:!0,get:function(){return e._}}),Object.defineProperty(exports,"signInWithEmailAndPassword",{enumerable:!0,get:function(){return e.a5}}),Object.defineProperty(exports,"signInWithEmailLink",{enumerable:!0,get:function(){return e.a8}}),Object.defineProperty(exports,"signInWithPhoneNumber",{enumerable:!0,get:function(){return e.s}}),Object.defineProperty(exports,"signInWithPopup",{enumerable:!0,get:function(){return e.c}}),Object.defineProperty(exports,"signInWithRedirect",{enumerable:!0,get:function(){return e.f}}),Object.defineProperty(exports,"signOut",{enumerable:!0,get:function(){return e.x}}),Object.defineProperty(exports,"unlink",{enumerable:!0,get:function(){return e.aj}}),Object.defineProperty(exports,"updateCurrentUser",{enumerable:!0,get:function(){return e.w}}),Object.defineProperty(exports,"updateEmail",{enumerable:!0,get:function(){return e.af}}),Object.defineProperty(exports,"updatePassword",{enumerable:!0,get:function(){return e.ag}}),Object.defineProperty(exports,"updatePhoneNumber",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"updateProfile",{enumerable:!0,get:function(){return e.ae}}),Object.defineProperty(exports,"useDeviceLanguage",{enumerable:!0,get:function(){return e.v}}),Object.defineProperty(exports,"verifyBeforeUpdateEmail",{enumerable:!0,get:function(){return e.ab}}),Object.defineProperty(exports,"verifyPasswordResetCode",{enumerable:!0,get:function(){return e.a3}});var e=require("./index-839de510.js");require("@firebase/util"),require("@firebase/app"),require("tslib"),require("@firebase/logger"),require("@firebase/component");
},{"./index-839de510.js":"pg19","@firebase/util":"chA2","@firebase/app":"h2Mb","tslib":"vCxL","@firebase/logger":"JJem","@firebase/component":"vhY9"}],"zKjx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/auth");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/auth":"QWyA"}],"xTjU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("firebase/auth"),t=n(require("../Router"));function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var u=function(){function n(){o(this,n)}return r(n,[{key:"register",value:function(){var n=(0,e.getAuth)(),o=document.getElementById("emailRegister").value,a=document.getElementById("pwdRegister").value;(0,e.createUserWithEmailAndPassword)(n,o,a).then(function(e){var t=e;console.log(t)}).then(function(){t.default.getRouter().navigate("/")}).catch(function(e){var t=e.code,n=e.message;alert("Error ".concat(t).concat(n))})}},{key:"login",value:function(){var n=(0,e.getAuth)(),o=document.getElementById("email").value,a=document.getElementById("pwd").value;(0,e.signInWithEmailAndPassword)(n,o,a).then(function(e){console.log(e),alert("logged In")}).then(function(){t.default.getRouter().navigate("/dashboard")}).catch(function(e){var t=e.code,n=e.message;alert("Error ".concat(t).concat(n))})}},{key:"loginWithGoogle",value:function(){var n=(0,e.getAuth)(),o=new e.GoogleAuthProvider;(0,e.signInWithPopup)(n,o).then(function(){t.default.getRouter().navigate("/dashboard")})}},{key:"logOut",value:function(){var n=(0,e.getAuth)();(0,e.signOut)(n).then(function(){}).then(function(){t.default.getRouter().navigate("/")}).catch(function(e){var t=e.code,n=e.message;alert("Error ".concat(t).concat(n))})}}]),n}(),c=u;exports.default=c;
},{"firebase/auth":"zKjx","../Router":"jmDk"}],"kXDI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=c(require("../library/Component")),t=c(require("../library/Elements")),n=c(require("../images/backgroundImages2.png")),r=c(require("../images/logo.png")),o=c(require("../Router")),a=c(require("../library/Authenticator"));function c(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=b();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(c){s(u,e.default);var i=d(u);function u(){return l(this,u),i.call(this,{name:"home",routerPath:"/"})}return f(u,[{key:"render",value:function(){this.clearComponent();var e=document.createElement("div"),c=t.default.createImage({newSource:r.default,className:"header__logo"}),i=t.default.createImage({newSource:n.default,className:"header__photo"}),l=t.default.createContainer({className:"header",children:[c,i]}),u=t.default.createHeader({textContent:"Welcome",className:"welcomeBackContainer__sloganOne"}),f=t.default.createText({textContent:"Don't have an account yet? ",className:"welcomeBackContainer__text"}),s=t.default.createInputField({className:"welcomeBackContainer__wrapperFields--inputfieldOne",type:"email",placeholder:"username",id:"email"}),p=t.default.createInputField({className:"welcomeBackContainer__wrapperFields--inputfieldTwo",type:"password",text:"password",placeholder:"password",id:"pwd"}),d=t.default.createButton({className:"welcomeBackContainer__btnLogin",textContent:"Login",onClick:function(){(new a.default).login()}}),m=t.default.createButton({className:"welcomeBackContainer__btnFacebook",textContent:"f"}),y=t.default.createButton({className:"welcomeBackContainer__btnGoogle",textContent:"G",onClick:function(){(new a.default).loginWithGoogle()}}),b=t.default.createButton({className:"welcomeBackContainer__btnRegister",textContent:"Register here",onClick:function(){o.default.getRouter().navigate("/register")}}),h=t.default.createContainer({className:"welcomeBackContainer__wrapperFields",children:[s,p]}),w=t.default.createContainer({className:"welcomeBackContainer",children:[u,h,d,m,y,f,b]}),_=t.default.createContainer({className:"togheter",children:[l,w]});return e.appendChild(_),e}}]),u}(),_=w;exports.default=_;
},{"../library/Component":"XGyB","../library/Elements":"hzEA","../images/backgroundImages2.png":"QE9W","../images/logo.png":"SPDy","../Router":"jmDk","../library/Authenticator":"xTjU"}],"HVOu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=c(require("../library/Component")),t=c(require("../library/Elements")),r=c(require("../images/backgroundImages2.png")),n=c(require("../images/logo.png")),o=c(require("../library/Authenticator")),a=c(require("../Router"));function c(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=b();return function(){var r,n=h(e);if(t){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=function(c){s(l,e.default);var i=d(l);function l(){return u(this,l),i.call(this,{name:"register",routerPath:"/register"})}return f(l,[{key:"render",value:function(){this.clearComponent();var e=document.createElement("div"),c=t.default.createImage({newSource:n.default,className:"header__logo"}),i=t.default.createImage({newSource:r.default,className:"header__photo"}),u=t.default.createContainer({className:"header",children:[c,i]}),l=t.default.createHeader({textContent:"Register",className:"welcomeBackContainer__sloganOne",id:"test"}),f=t.default.createText({textContent:"Already have an account? ",className:"welcomeBackContainer__text"}),s=t.default.createInputField({className:"welcomeBackContainer__wrapperFields--inputfieldOne",id:"emailRegister",placeholder:"E-mail"}),p=t.default.createInputField({className:"welcomeBackContainer__wrapperFields--inputfieldTwo",type:"password",placeholder:"password",id:"pwdRegister"}),d=t.default.createButton({className:"welcomeBackContainer__btnLogin",textContent:"Register",onClick:function(){(new o.default).register()}}),y=t.default.createButton({className:"welcomeBackContainer__btnRegister",textContent:"Login here",onClick:function(){a.default.getRouter().navigate("/")}}),m=t.default.createContainer({className:"welcomeBackContainer__wrapperFields",children:[s,p]}),b=t.default.createContainer({className:"welcomeBackContainer",children:[l,m,d,f,y]}),h=t.default.createContainer({className:"togheter",children:[u,b]});return e.appendChild(h),e}}]),l}(),_=w;exports.default=_;
},{"../library/Component":"XGyB","../library/Elements":"hzEA","../images/backgroundImages2.png":"QE9W","../images/logo.png":"SPDy","../library/Authenticator":"xTjU","../Router":"jmDk"}],"g5f5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("../library/Component")),t=o(require("../library/Elements")),n=o(require("../images/logo.png")),a=o(require("../Router")),r=o(require("../library/Authenticator"));function o(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=_();return function(){var n,a=m(e);if(t){var r=m(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return C(this,n)}}function C(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(o){s(i,e.default);var l=d(i);function i(){return c(this,i),l.call(this,{name:"dashboard",routerPath:"/dashboard"})}return u(i,[{key:"render",value:function(){this.clearComponent();var e=document.createElement("div"),o=t.default.createImage({newSource:n.default,className:"dashboard__logo"}),l=t.default.createButton({className:"dashboard__btnLogOut",textContent:"Log out",onClick:function(){(new r.default).logOut()}}),c=t.default.createContainer({className:"dashboard",children:[o,l]}),i=t.default.createHeader({textContent:"Hello,",className:"dashboardContainer__sloganOne"}),u=t.default.createText({textContent:"Nice to have you back! ",className:"dashboardContainer__text"}),s=t.default.createContainer({className:"dashboardContainer",children:[i,u]}),f=t.default.createButton({textContent:" VIEW EVENTS",className:"AllContainers__divOne--text",onClick:function(){a.default.getRouter().navigate("/")}}),d=t.default.createIcon({classNames:["fas","fa-street-view","input-icon"]}),C=t.default.createContainer({className:"AllContainers__divOne--content",children:[d,f]}),p=t.default.createContainer({className:"AllContainers__divOne",children:[C]}),_=t.default.createButton({textContent:" CHANGE YOUR EVENT",className:"AllContainers__divTwo--text"}),m=t.default.createIcon({classNames:["fas","fa-cog","input-icon"]}),h=t.default.createContainer({className:"AllContainers__divTwo--content",children:[m,_]}),y=t.default.createContainer({className:"AllContainers__divTwo",children:[h]}),b=t.default.createButton({textContent:" SEARCH A PLACE TO PARTY",className:"AllContainers__divThree--text"}),v=t.default.createIcon({classNames:["fas","fa-search-location","input-icon"]}),N=t.default.createContainer({className:"AllContainers__divThree--content",children:[v,b]}),A=t.default.createContainer({className:"AllContainers__divThree",children:[N]}),O=t.default.createButton({textContent:" CHANGE YOUR EVENT",className:"AllContainers__divFour--text"}),x=t.default.createIcon({classNames:["fas","fa-map-marker-alt","input-icon"]}),E=t.default.createContainer({className:"AllContainers__divFour--content",children:[x,O]}),g=t.default.createContainer({className:"AllContainers__divFour",children:[E]}),w=t.default.createButton({textContent:" CHANGE YOUR EVENT",className:"AllContainers__divFive--text"}),T=t.default.createIcon({classNames:["fas","fa-cog","input-icon"]}),P=t.default.createContainer({className:"AllContainers__divFive--content",children:[T,w]}),R=t.default.createContainer({className:"AllContainers__divFive",children:[P]}),j=t.default.createButton({textContent:" PANIC BUTTON",className:"panicButton"}),B=t.default.createContainer({className:"AllContainers__divSix--content",children:[j]}),S=t.default.createContainer({className:"AllContainers__divSix",children:[B]}),I=t.default.createContainer({className:"AllContainers",children:[p,y,A,g,R,S]}),k=t.default.createContainer({className:"togheter",children:[c,s,I]});return e.appendChild(k),e}}]),i}(),y=h;exports.default=y;
},{"../library/Component":"XGyB","../library/Elements":"hzEA","../images/logo.png":"SPDy","../Router":"jmDk","../library/Authenticator":"xTjU"}],"f0XA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._UploadTask=exports._TaskState=exports._TaskEvent=exports._Location=exports._FbsBlob=exports.StringFormat=void 0,exports._dataFromString=te,exports._getChild=Gt,exports._invalidArgument=y,exports._invalidRootOperation=x,exports.connectStorageEmulator=Wt,exports.deleteObject=jt,exports.getBlob=Vt,exports.getBytes=qt,exports.getDownloadURL=Ht,exports.getMetadata=Lt,exports.getStorage=Xt,exports.getStream=Kt,exports.list=Ft,exports.listAll=Dt,exports.ref=$t,exports.updateMetadata=zt,exports.uploadBytes=Mt,exports.uploadBytesResumable=Nt,exports.uploadString=Bt;var e=require("@firebase/app"),t=require("@firebase/util"),n=require("@firebase/component");const r="firebasestorage.googleapis.com",s="storageBucket",o=12e4,i=6e5;class a extends t.FirebaseError{constructor(e,t){super(c(e),`Firebase Storage: ${t} (${c(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,a.prototype)}_codeEquals(e){return c(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function c(e){return"storage/"+e}function u(){return new a("unknown","An unknown error occurred, please check the error payload for server response.")}function l(e){return new a("object-not-found","Object '"+e+"' does not exist.")}function h(e){return new a("quota-exceeded","Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function d(){return new a("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}function _(){return new a("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function p(e){return new a("unauthorized","User does not have permission to access '"+e+"'.")}function f(){return new a("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function g(){return new a("canceled","User canceled the upload/download.")}function m(e){return new a("invalid-url","Invalid URL '"+e+"'.")}function b(e){return new a("invalid-default-bucket","Invalid default bucket '"+e+"'.")}function w(){return new a("no-default-bucket","No default bucket found. Did you set the '"+s+"' property when initializing the app?")}function k(){return new a("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function R(){return new a("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function v(){return new a("no-download-url","The given file does not have any download URLs.")}function y(e){return new a("invalid-argument",e)}function T(){return new a("app-deleted","The Firebase app was deleted.")}function x(e){return new a("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function S(e,t){return new a("invalid-format","String does not match format '"+e+"': "+t)}function C(e){throw new a("internal-error","Internal error: "+e)}class U{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=U.makeFromUrl(e,t)}catch(r){return new U(e,"")}if(""===n.path)return n;throw b(e)}static makeFromUrl(e,t){let n=null;const s=new RegExp("^gs://([A-Za-z0-9.\\-_]+)(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}const i=t.replace(/[.]/g,"\\."),a=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${i}/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-_]+)/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp(`^https?://${t===r?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/([A-Za-z0-9.\\-_]+)/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:o}];for(let r=0;r<a.length;r++){const t=a[r],s=t.regex.exec(e);if(s){const e=s[t.indices.bucket];let r=s[t.indices.path];r||(r=""),n=new U(e,r),t.postModify(n);break}}if(null==n)throw m(e);return n}}exports._Location=U;class O{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function E(e,t,n){let r=1,s=null,o=null,i=!1,a=0;function c(){return 2===a}let u=!1;function l(...e){u||(u=!0,t.apply(null,e))}function h(t){s=setTimeout(()=>{s=null,e(_,c())},t)}function d(){o&&clearTimeout(o)}function _(e,...t){if(u)return void d();if(e)return d(),void l.call(null,e,...t);if(c()||i)return d(),void l.call(null,e,...t);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),h(n)}let p=!1;function f(e){p||(p=!0,d(),u||(null!==s?(e||(a=2),clearTimeout(s),h(0)):e||(a=1)))}return h(0),o=setTimeout(()=>{i=!0,f(!0)},n),f}function P(e){e(!1)}function A(e){return void 0!==e}function I(e){return"function"==typeof e}function q(e){return"object"==typeof e&&!Array.isArray(e)}function M(e){return"string"==typeof e||e instanceof String}function B(e){return N()&&e instanceof Blob}function N(){return"undefined"!=typeof Blob}function L(e,t,n,r){if(r<t)throw y(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw y(`Invalid value for '${e}'. Expected ${n} or less.`)}function z(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function F(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}var D;!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(D||(D={}));class H{constructor(e,t,n,r,s,o,i,a,c,u,l){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=i,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=l,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new j(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===D.NO_ERROR,s=n.getStatus();if(!t||this.isRetryStatusCode_(s)){const t=n.getErrorCode()===D.ABORT;return void e(!1,new j(!1,null,t))}const o=-1!==this.successCodes_.indexOf(s);e(!0,new j(o,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());A(e)?n(e):n()}catch(o){r(o)}else if(null!==s){const e=u();e.serverResponse=s.getErrorText(),this.errorCallback_?r(this.errorCallback_(s,e)):r(e)}else if(t.canceled){r(this.appDelete_?T():g())}else{r(f())}};this.canceled_?t(0,new j(!1,null,!0)):this.backoffId_=E(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&P(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class j{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function $(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}function G(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}function X(e,t){t&&(e["X-Firebase-GMPID"]=t)}function W(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}function V(e,t,n,r,s,o){const i=F(e.urlParams),a=e.url+i,c=Object.assign({},e.headers);return X(c,t),$(c,n),G(c,o),W(c,r),new H(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s)}function K(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Z(...e){const t=K();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(N())return new Blob(e);throw new a("unsupported-environment","This browser doesn't seem to support creating Blobs")}function J(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}function Y(e){return atob(e)}const Q={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};exports.StringFormat=Q;class ee{constructor(e,t){this.data=e,this.contentType=t||null}}function te(e,t){switch(e){case Q.RAW:return new ee(ne(t));case Q.BASE64:case Q.BASE64URL:return new ee(se(e,t));case Q.DATA_URL:return new ee(ie(t),ae(t))}throw u()}function ne(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function re(e){let t;try{t=decodeURIComponent(e)}catch(n){throw S(Q.DATA_URL,"Malformed data URL.")}return ne(t)}function se(e,t){switch(e){case Q.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw S(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case Q.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw S(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Y(t)}catch(s){throw S(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r}class oe{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw S(Q.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=ce(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}function ie(e){const t=new oe(e);return t.base64?se(Q.BASE64,t.rest):re(t.rest)}function ae(e){return new oe(e).contentType}function ce(e,t){return!!(e.length>=t.length)&&e.substring(e.length-t.length)===t}class ue{constructor(e,t){let n=0,r="";B(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(B(this.data_)){const n=J(this.data_,e,t);return null===n?null:new ue(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new ue(n,!0)}}static getBlob(...e){if(N()){const t=e.map(e=>e instanceof ue?e.data_:e);return new ue(Z.apply(null,t))}{const t=e.map(e=>M(e)?te(Q.RAW,e).data:e.data_);let n=0;t.forEach(e=>{n+=e.byteLength});const r=new Uint8Array(n);let s=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)r[s++]=e[t]}),new ue(r,!0)}}uploadData(){return this.data_}}function le(e){let t;try{t=JSON.parse(e)}catch(n){return null}return q(t)?t:null}function he(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}function de(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}function _e(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function pe(e,t){return t}exports._FbsBlob=ue;class fe{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||pe}}let ge=null;function me(e){return!M(e)||e.length<2?e:_e(e)}function be(){if(ge)return ge;const e=[];e.push(new fe("bucket")),e.push(new fe("generation")),e.push(new fe("metageneration")),e.push(new fe("name","fullPath",!0));const t=new fe("name");t.xform=function(e,t){return me(t)},e.push(t);const n=new fe("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new fe("timeCreated")),e.push(new fe("updated")),e.push(new fe("md5Hash",null,!0)),e.push(new fe("cacheControl",null,!0)),e.push(new fe("contentDisposition",null,!0)),e.push(new fe("contentEncoding",null,!0)),e.push(new fe("contentLanguage",null,!0)),e.push(new fe("contentType",null,!0)),e.push(new fe("metadata","customMetadata",!0)),ge=e}function we(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,s=new U(n,r);return t._makeStorageReference(s)}})}function ke(e,t,n){const r={type:"file"},s=n.length;for(let o=0;o<s;o++){const e=n[o];r[e.local]=e.xform(r,t[e.server])}return we(r,e),r}function Re(e,t,n){const r=le(t);return null===r?null:ke(e,r,n)}function ve(e,t,n,r){const s=le(t);if(null===s)return null;if(!M(s.downloadTokens))return null;const o=s.downloadTokens;if(0===o.length)return null;const i=encodeURIComponent;return o.split(",").map(t=>{const s=e.bucket,o=e.fullPath;return z("/b/"+i(s)+"/o/"+i(o),n,r)+F({alt:"media",token:t})})[0]}function ye(e,t){const n={},r=t.length;for(let s=0;s<r;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}const Te="prefixes",xe="items";function Se(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[Te])for(const s of n[Te]){const n=s.replace(/\/$/,""),o=e._makeStorageReference(new U(t,n));r.prefixes.push(o)}if(n[xe])for(const s of n[xe]){const n=e._makeStorageReference(new U(t,s.name));r.items.push(n)}return r}function Ce(e,t,n){const r=le(n);return null===r?null:Se(e,t,r)}class Ue{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Oe(e){if(!e)throw u()}function Ee(e,t){return function(n,r){const s=Re(e,r,t);return Oe(null!==s),s}}function Pe(e,t){return function(n,r){const s=Ce(e,t,r);return Oe(null!==s),s}}function Ae(e,t){return function(n,r){const s=Re(e,r,t);return Oe(null!==s),ve(s,r,e.host,e._protocol)}}function Ie(e){return function(t,n){let r;return(r=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?_():d():402===t.getStatus()?h(e.bucket):403===t.getStatus()?p(e.path):n).serverResponse=n.serverResponse,r}}function qe(e){const t=Ie(e);return function(n,r){let s=t(n,r);return 404===n.getStatus()&&(s=l(e.path)),s.serverResponse=r.serverResponse,s}}function Me(e,t,n){const r=z(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,o=new Ue(r,"GET",Ee(e,n),s);return o.errorHandler=qe(t),o}function Be(e,t,n,r,s){const o={};t.isRoot?o.prefix="":o.prefix=t.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),s&&(o.maxResults=s);const i=z(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,c=new Ue(i,"GET",Pe(e,t.bucket),a);return c.urlParams=o,c.errorHandler=Ie(t),c}function Ne(e,t,n){const r=z(t.fullServerUrl(),e.host,e._protocol)+"?alt=media",s=e.maxOperationRetryTime,o=new Ue(r,"GET",(e,t)=>t,s);return o.errorHandler=qe(t),void 0!==n&&(o.headers.Range=`bytes=0-${n}`,o.successCodes=[200,206]),o}function Le(e,t,n){const r=z(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,o=new Ue(r,"GET",Ae(e,n),s);return o.errorHandler=qe(t),o}function ze(e,t,n,r){const s=z(t.fullServerUrl(),e.host,e._protocol),o=ye(n,r),i=e.maxOperationRetryTime,a=new Ue(s,"PATCH",Ee(e,r),i);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=o,a.errorHandler=qe(t),a}function Fe(e,t){const n=z(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime;const s=new Ue(n,"DELETE",function(e,t){},r);return s.successCodes=[200,204],s.errorHandler=qe(t),s}function De(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function He(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=De(null,t)),r}function je(e,t,n,r,s){const o=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();i["Content-Type"]="multipart/related; boundary="+a;const c=He(t,r,s),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+ye(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=ue.getBlob(u,r,l);if(null===h)throw k();const d={name:c.fullPath},_=z(o,e.host,e._protocol),p=e.maxUploadRetryTime,f=new Ue(_,"POST",Ee(e,n),p);return f.urlParams=d,f.headers=i,f.body=h.uploadData(),f.errorHandler=Ie(t),f}class $e{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function Ge(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){Oe(!1)}return Oe(!!n&&-1!==(t||["active"]).indexOf(n)),n}function Xe(e,t,n,r,s){const o=t.bucketOnlyServerUrl(),i=He(t,r,s),a={name:i.fullPath},c=z(o,e.host,e._protocol),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":i.contentType,"Content-Type":"application/json; charset=utf-8"},l=ye(i,n),h=e.maxUploadRetryTime;const d=new Ue(c,"POST",function(e){let t;Ge(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){Oe(!1)}return Oe(M(t)),t},h);return d.urlParams=a,d.headers=u,d.body=l,d.errorHandler=Ie(t),d}function We(e,t,n,r){const s=e.maxUploadRetryTime,o=new Ue(n,"POST",function(e){const t=Ge(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){Oe(!1)}n||Oe(!1);const s=Number(n);return Oe(!isNaN(s)),new $e(s,r.size(),"final"===t)},s);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Ie(t),o}const Ve=262144;function Ke(e,t,n,r,s,o,i,a){const c=new $e(0,0);if(i?(c.current=i.current,c.total=i.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw R();const u=c.total-c.current;let l=u;s>0&&(l=Math.min(l,s));const h=c.current,d=h+l,_={"X-Goog-Upload-Command":l===u?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},p=r.slice(h,d);if(null===p)throw k();const f=t.maxUploadRetryTime,g=new Ue(n,"POST",function(e,n){const s=Ge(e,["active","final"]),i=c.current+l,a=r.size();let u;return u="final"===s?Ee(t,o)(e,n):null,new $e(i,a,"final"===s,u)},f);return g.headers=_,g.body=p.uploadData(),g.progressCallback=a||null,g.errorHandler=Ie(e),g}const Ze={STATE_CHANGED:"state_changed"};exports._TaskEvent=Ze;const Je={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ye(e){switch(e){case"running":case"pausing":case"canceling":return Je.RUNNING;case"paused":return Je.PAUSED;case"success":return Je.SUCCESS;case"canceled":return Je.CANCELED;case"error":default:return Je.ERROR}}exports._TaskState=Je;class Qe{constructor(e,t,n){if(I(e)||null!=t||null!=n)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function et(e){return(...t)=>{Promise.resolve().then(()=>e(...t))}}let tt=null;class nt{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=D.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=D.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=D.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw C("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw C("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw C("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw C("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw C("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class rt extends nt{initXhr(){this.xhr_.responseType="text"}}function st(){return tt?tt():new rt}class ot extends nt{initXhr(){this.xhr_.responseType="arraybuffer"}}function it(){return new ot}class at extends nt{initXhr(){this.xhr_.responseType="blob"}}function ct(){return new at}class ut{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=be(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=(e=>{this._request=void 0,this._chunkMultiplier=1,e._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=e,this._transition("error"))}),this._metadataErrorHandler=(e=>{this._request=void 0,e._codeEquals("canceled")?this.completeTransitions_():(this._error=e,this._transition("error"))}),this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const n=Xe(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,st,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,n)=>{const r=We(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(r,st,t,n);this._request=s,s.getPromise().then(e=>{e=e,this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Ve*this._chunkMultiplier,t=new $e(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((r,s)=>{let o;try{o=Ke(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(a){return this._error=a,void this._transition("error")}const i=this._ref.storage._makeRequest(o,st,r,s);this._request=i,i.getPromise().then(e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){Ve*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const n=Me(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,st,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const n=je(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,st,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=g(),this._state=e,this._notifyObservers();break;case"error":case"success":this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Ye(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const s=new Qe(t||void 0,n||void 0,r||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Ye(this._state)){case Je.SUCCESS:et(this._resolve.bind(null,this.snapshot))();break;case Je.CANCELED:case Je.ERROR:et(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Ye(this._state)){case Je.RUNNING:case Je.PAUSED:e.next&&et(e.next.bind(e,this.snapshot))();break;case Je.SUCCESS:e.complete&&et(e.complete.bind(e))();break;case Je.CANCELED:case Je.ERROR:e.error&&et(e.error.bind(e,this._error))();break;default:e.error&&et(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}exports._UploadTask=ut;class lt{constructor(e,t){this._service=e,this._location=t instanceof U?t:U.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new lt(e,t)}get root(){const e=new U(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _e(this._location.path)}get storage(){return this._service}get parent(){const e=he(this._location.path);if(null===e)return null;const t=new U(this._location.bucket,e);return new lt(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw x(e)}}function ht(e,t){e._throwIfRoot("getBytes");const n=Ne(e.storage,e._location,t);return e.storage.makeRequestWithTokens(n,it).then(e=>void 0!==t?e.slice(0,t):e)}function dt(e,t){e._throwIfRoot("getBlob");const n=Ne(e.storage,e._location,t);return e.storage.makeRequestWithTokens(n,ct).then(e=>void 0!==t?e.slice(0,t):e)}function _t(e,t,n){e._throwIfRoot("uploadBytes");const r=je(e.storage,e._location,be(),new ue(t,!0),n);return e.storage.makeRequestWithTokens(r,st).then(t=>({metadata:t,ref:e}))}function pt(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new ut(e,new ue(t),n)}function ft(e,t,n=Q.RAW,r){e._throwIfRoot("uploadString");const s=te(n,t),o=Object.assign({},r);return null==o.contentType&&null!=s.contentType&&(o.contentType=s.contentType),_t(e,s.data,o)}function gt(e){const t={prefixes:[],items:[]};return mt(e,t).then(()=>t)}async function mt(e,t,n){const r={pageToken:n},s=await bt(e,r);t.prefixes.push(...s.prefixes),t.items.push(...s.items),null!=s.nextPageToken&&await mt(e,t,s.nextPageToken)}function bt(e,t){null!=t&&"number"==typeof t.maxResults&&L("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=Be(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,st)}function wt(e){e._throwIfRoot("getMetadata");const t=Me(e.storage,e._location,be());return e.storage.makeRequestWithTokens(t,st)}function kt(e,t){e._throwIfRoot("updateMetadata");const n=ze(e.storage,e._location,t,be());return e.storage.makeRequestWithTokens(n,st)}function Rt(e){e._throwIfRoot("getDownloadURL");const t=Le(e.storage,e._location,be());return e.storage.makeRequestWithTokens(t,st).then(e=>{if(null===e)throw v();return e})}function vt(e){e._throwIfRoot("deleteObject");const t=Fe(e.storage,e._location);return e.storage.makeRequestWithTokens(t,st)}function yt(e,t){const n=de(e._location.path,t),r=new U(e._location.bucket,n);return new lt(e.storage,r)}function Tt(e){return/^[A-Za-z]+:\/\//.test(e)}function xt(e,t){return new lt(e,t)}function St(e,t){if(e instanceof Et){const n=e;if(null==n._bucket)throw w();const r=new lt(n,n._bucket);return null!=t?St(r,t):r}return void 0!==t?yt(e,t):e}function Ct(e,t){if(t&&Tt(t)){if(e instanceof Et)return xt(e,t);throw y("To use ref(service, url), the first argument must be a Storage instance.")}return St(e,t)}function Ut(e,t){const n=null==t?void 0:t[s];return null==n?null:U.makeFromBucketSpec(n,e)}function Ot(e,n,r,s={}){e.host=`${n}:${r}`,e._protocol="http";const{mockUserToken:o}=s;o&&(e._overrideAuthToken="string"==typeof o?o:(0,t.createMockUserToken)(o,e.app.options.projectId))}class Et{constructor(e,t,n,s,a){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=r,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=o,this._maxUploadRetryTime=i,this._requests=new Set,this._bucket=null!=s?U.makeFromBucketSpec(s,this._host):Ut(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=U.makeFromBucketSpec(this._url,e):this._bucket=Ut(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){L("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){L("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new lt(this,e)}_makeRequest(e,t,n,r){if(this._deleted)return new O(T());{const s=V(e,this._appId,n,r,t,this._firebaseVersion);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Pt="@firebase/storage",At="0.9.0",It="storage";function qt(e,n){return ht(e=(0,t.getModularInstance)(e),n)}function Mt(e,n,r){return _t(e=(0,t.getModularInstance)(e),n,r)}function Bt(e,n,r,s){return ft(e=(0,t.getModularInstance)(e),n,r,s)}function Nt(e,n,r){return pt(e=(0,t.getModularInstance)(e),n,r)}function Lt(e){return wt(e=(0,t.getModularInstance)(e))}function zt(e,n){return kt(e=(0,t.getModularInstance)(e),n)}function Ft(e,n){return bt(e=(0,t.getModularInstance)(e),n)}function Dt(e){return gt(e=(0,t.getModularInstance)(e))}function Ht(e){return Rt(e=(0,t.getModularInstance)(e))}function jt(e){return vt(e=(0,t.getModularInstance)(e))}function $t(e,n){return Ct(e=(0,t.getModularInstance)(e),n)}function Gt(e,t){return yt(e,t)}function Xt(n=(0,e.getApp)(),r){return n=(0,t.getModularInstance)(n),(0,e._getProvider)(n,It).getImmediate({identifier:r})}function Wt(e,t,n,r={}){Ot(e,t,n,r)}function Vt(e,n){return dt(e=(0,t.getModularInstance)(e),n)}function Kt(e,t){throw new Error("getStream() is only supported by NodeJS builds")}function Zt(t,{instanceIdentifier:n}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Et(r,s,o,n,e.SDK_VERSION)}function Jt(){(0,e._registerComponent)(new n.Component(It,Zt,"PUBLIC").setMultipleInstances(!0)),(0,e.registerVersion)(Pt,At,""),(0,e.registerVersion)(Pt,At,"esm2017")}Jt();
},{"@firebase/app":"h2Mb","@firebase/util":"chA2","@firebase/component":"vhY9"}],"jzRU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/storage");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/storage":"f0XA"}],"qQDx":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStatEventTarget=exports.default=exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.Stat=exports.FetchXmlHttpFactory=exports.EventType=exports.Event=exports.ErrorCode=void 0;var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},i={};exports.default=i;var n,s=s||{},r=e||self;function o(){}function h(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function a(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function l(t){return Object.prototype.hasOwnProperty.call(t,u)&&t[u]||(t[u]=++c)}var u="closure_uid_"+(1e9*Math.random()>>>0),c=0;function f(t,e,i){return t.call.apply(t.bind,arguments)}function g(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function p(t,e,i){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?f:g).apply(null,arguments)}function d(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var e=i.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function v(t,e){function i(){}i.prototype=e.prototype,t.Z=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.Vb=function(t,i,n){for(var s=Array(arguments.length-2),r=2;r<arguments.length;r++)s[r-2]=arguments[r];return e.prototype[i].apply(t,s)}}function y(){this.s=this.s,this.o=this.o}var m=0,b={};y.prototype.s=!1,y.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0!=m)){var t=l(this);delete b[t]}},y.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const w=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1},T=Array.prototype.forEach?function(t,e,i){Array.prototype.forEach.call(t,e,i)}:function(t,e,i){const n=t.length,s="string"==typeof t?t.split(""):t;for(let r=0;r<n;r++)r in s&&e.call(i,s[r],r,t)};function E(t){t:{var e=Bi;const i=t.length,n="string"==typeof t?t.split(""):t;for(let s=0;s<i;s++)if(s in n&&e.call(void 0,n[s],s,t)){e=s;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}function S(t){return Array.prototype.concat.apply([],arguments)}function x(t){const e=t.length;if(0<e){const i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function j(t){return/^[\s\xa0]*$/.test(t)}var C,I=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function A(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var O=r.navigator;if(O){var P=O.userAgent;if(P){C=P;break t}}C=""}function D(t,e,i){for(const n in t)e.call(i,t[n],n,t)}function M(t){const e={};for(const i in t)e[i]=t[i];return e}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(t,e){let i,n;for(let s=1;s<arguments.length;s++){for(i in n=arguments[s])t[i]=n[i];for(let e=0;e<L.length;e++)i=L[e],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function H(t){return H[" "](t),t}function k(t){var e=q;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}H[" "]=o;var _,B=A(C,"Opera"),F=A(C,"Trident")||A(C,"MSIE"),N=A(C,"Edge"),U=N||F,K=A(C,"Gecko")&&!(A(C.toLowerCase(),"webkit")&&!A(C,"Edge"))&&!(A(C,"Trident")||A(C,"MSIE"))&&!A(C,"Edge"),Y=A(C.toLowerCase(),"webkit")&&!A(C,"Edge");function G(){var t=r.document;return t?t.documentMode:void 0}t:{var J="",W=function(){var t=C;return K?/rv:([^\);]+)(\)|;)/.exec(t):N?/Edge\/([\d\.]+)/.exec(t):F?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Y?/WebKit\/(\S+)/.exec(t):B?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(W&&(J=W?W[1]:""),F){var V=G();if(null!=V&&V>parseFloat(J)){_=String(V);break t}}_=J}var $,q={};function z(){return k(function(){let t=0;const e=I(String(_)).split("."),i=I("9").split("."),n=Math.max(e.length,i.length);for(let o=0;0==t&&o<n;o++){var s=e[o]||"",r=i[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;t=R(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||R(0==s[2].length,0==r[2].length)||R(s[2],r[2]),s=s[3],r=r[3]}while(0==t)}return 0<=t})}if(r.document&&F){var Z=G();$=Z||(parseInt(_,10)||void 0)}else $=void 0;var Q=$,tt=function(){if(!r.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{r.addEventListener("test",o,e),r.removeEventListener("test",o,e)}catch(i){}return t}();function et(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function it(t,e){if(et.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(K){t:{try{H(e.nodeName);var s=!0;break t}catch(r){}s=!1}s||(e=null)}}else"mouseover"==i?e=t.fromElement:"mouseout"==i&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:nt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&it.Z.h.call(this)}}et.prototype.h=function(){this.defaultPrevented=!0},v(it,et);var nt={2:"touch",3:"pen",4:"mouse"};it.prototype.h=function(){it.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var st="closure_listenable_"+(1e6*Math.random()|0),rt=0;function ot(t,e,i,n,s){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.ia=s,this.key=++rt,this.ca=this.fa=!1}function ht(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function at(t){this.src=t,this.g={},this.h=0}function lt(t,e){var i=e.type;if(i in t.g){var n,s=t.g[i],r=w(s,e);(n=0<=r)&&Array.prototype.splice.call(s,r,1),n&&(ht(e),0==t.g[i].length&&(delete t.g[i],t.h--))}}function ut(t,e,i,n){for(var s=0;s<t.length;++s){var r=t[s];if(!r.ca&&r.listener==e&&r.capture==!!i&&r.ia==n)return s}return-1}at.prototype.add=function(t,e,i,n,s){var r=t.toString();(t=this.g[r])||(t=this.g[r]=[],this.h++);var o=ut(t,e,n,s);return-1<o?(e=t[o],i||(e.fa=!1)):((e=new ot(e,this.src,r,!!n,s)).fa=i,t.push(e)),e};var ct="closure_lm_"+(1e6*Math.random()|0),ft={};function gt(t,e,i,n,s){if(n&&n.once)return vt(t,e,i,n,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)gt(t,e[r],i,n,s);return null}return i=St(i),t&&t[st]?t.N(e,i,a(n)?!!n.capture:!!n,s):pt(t,e,i,!1,n,s)}function pt(t,e,i,n,s,r){if(!e)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,h=Tt(t);if(h||(t[ct]=h=new at(t)),(i=h.add(e,i,n,o,r)).proxy)return i;if(n=dt(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)tt||(s=o),void 0===s&&(s=!1),t.addEventListener(e.toString(),n,s);else if(t.attachEvent)t.attachEvent(bt(e.toString()),n);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(n)}return i}function dt(){var t=wt;return function e(i){return t.call(e.src,e.listener,i)}}function vt(t,e,i,n,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)vt(t,e[r],i,n,s);return null}return i=St(i),t&&t[st]?t.O(e,i,a(n)?!!n.capture:!!n,s):pt(t,e,i,!0,n,s)}function yt(t,e,i,n,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)yt(t,e[r],i,n,s);else n=a(n)?!!n.capture:!!n,i=St(i),t&&t[st]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(i=ut(r=t.g[e],i,n,s))&&(ht(r[i]),Array.prototype.splice.call(r,i,1),0==r.length&&(delete t.g[e],t.h--)))):t&&(t=Tt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ut(e,i,n,s)),(i=-1<t?e[t]:null)&&mt(i))}function mt(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[st])lt(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(bt(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=Tt(e))?(lt(i,t),0==i.h&&(i.src=null,e[ct]=null)):ht(t)}}}function bt(t){return t in ft?ft[t]:ft[t]="on"+t}function wt(t,e){if(t.ca)t=!0;else{e=new it(e,this);var i=t.listener,n=t.ia||t.src;t.fa&&mt(t),t=i.call(n,e)}return t}function Tt(t){return(t=t[ct])instanceof at?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function St(t){return"function"==typeof t?t:(t[Et]||(t[Et]=function(e){return t.handleEvent(e)}),t[Et])}function xt(){y.call(this),this.i=new at(this),this.P=this,this.I=null}function jt(t,e){var i,n=t.I;if(n)for(i=[];n;n=n.I)i.push(n);if(t=t.P,n=e.type||e,"string"==typeof e)e=new et(e,t);else if(e instanceof et)e.target=e.target||t;else{var s=e;X(e=new et(n,t),s)}if(s=!0,i)for(var r=i.length-1;0<=r;r--){var o=e.g=i[r];s=Ct(o,n,!0,e)&&s}if(s=Ct(o=e.g=t,n,!0,e)&&s,s=Ct(o,n,!1,e)&&s,i)for(r=0;r<i.length;r++)s=Ct(o=e.g=i[r],n,!1,e)&&s}function Ct(t,e,i,n){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ca&&o.capture==i){var h=o.listener,a=o.ia||o.src;o.fa&&lt(t.i,o),s=!1!==h.call(a,n)&&s}}return s&&!n.defaultPrevented}v(xt,y),xt.prototype[st]=!0,xt.prototype.removeEventListener=function(t,e,i,n){yt(this,t,e,i,n)},xt.prototype.M=function(){if(xt.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var i=e.g[t],n=0;n<i.length;n++)ht(i[n]);delete e.g[t],e.h--}}this.I=null},xt.prototype.N=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)},xt.prototype.O=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};var It=r.JSON.stringify;function At(){var t=kt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Rt{constructor(){this.h=this.g=null}add(t,e){const i=Pt.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}}var Ot,Pt=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Dt,t=>t.reset());class Dt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Mt(t){r.setTimeout(()=>{throw t},0)}function Lt(t,e){Ot||Xt(),Ht||(Ot(),Ht=!0),kt.add(t,e)}function Xt(){var t=r.Promise.resolve(void 0);Ot=function(){t.then(_t)}}var Ht=!1,kt=new Rt;function _t(){for(var t;t=At();){try{t.h.call(t.g)}catch(i){Mt(i)}var e=Pt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ht=!1}function Bt(t,e){xt.call(this),this.h=t||1,this.g=e||r,this.j=p(this.kb,this),this.l=Date.now()}function Ft(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Nt(t,e,i){if("function"==typeof t)i&&(t=p(t,i));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=p(t.handleEvent,t)}return 2147483647<Number(e)?-1:r.setTimeout(t,e||0)}function Ut(t){t.g=Nt(()=>{t.g=null,t.i&&(t.i=!1,Ut(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}v(Bt,xt),(n=Bt.prototype).da=!1,n.S=null,n.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),jt(this,"tick"),this.da&&(Ft(this),this.start()))}},n.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},n.M=function(){Bt.Z.M.call(this),Ft(this),delete this.g};class Kt extends y{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:Ut(this)}M(){super.M(),this.g&&(r.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yt(t){y.call(this),this.h=t,this.g={}}v(Yt,y);var Gt=[];function Jt(t,e,i,n){Array.isArray(i)||(i&&(Gt[0]=i.toString()),i=Gt);for(var s=0;s<i.length;s++){var r=gt(e,i[s],n||t.handleEvent,!1,t.h||t);if(!r)break;t.g[r.key]=r}}function Wt(t){D(t.g,function(t,e){this.g.hasOwnProperty(e)&&mt(t)},t),t.g={}}function Vt(){this.g=!0}function $t(t,e,i,n,s,r){t.info(function(){if(t.g)if(r)for(var o="",h=r.split("&"),a=0;a<h.length;a++){var l=h[a].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+n+") [attempt "+s+"]: "+e+"\n"+i+"\n"+o})}function qt(t,e,i,n,s,r,o){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+s+"]: "+e+"\n"+i+"\n"+r+" "+o})}function zt(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Qt(t,i)+(n?" "+n:"")})}function Zt(t,e){t.info(function(){return"TIMEOUT: "+e})}function Qt(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i)for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var s=n[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return It(i)}catch(h){return e}}Yt.prototype.M=function(){Yt.Z.M.call(this),Wt(this)},Yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Vt.prototype.Aa=function(){this.g=!1},Vt.prototype.info=function(){};var te={},ee=null;function ie(){return ee=ee||new xt}function ne(t){et.call(this,te.Ma,t)}function se(t){const e=ie();jt(e,new ne(e,t))}function re(t,e){et.call(this,te.STAT_EVENT,t),this.stat=e}function oe(t){const e=ie();jt(e,new re(e,t))}function he(t,e){et.call(this,te.Na,t),this.size=e}function ae(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return r.setTimeout(function(){t()},e)}te.Ma="serverreachability",v(ne,et),te.STAT_EVENT="statevent",v(re,et),te.Na="timingevent",v(he,et);var le={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ue={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ce(){}function fe(t){return t.h||(t.h=t.i())}function ge(){}ce.prototype.h=null;var pe,de={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ve(){et.call(this,"d")}function ye(){et.call(this,"c")}function me(){}function be(t,e,i,n){this.l=t,this.j=e,this.m=i,this.X=n||1,this.V=new Yt(this),this.P=Te,t=U?125:void 0,this.W=new Bt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new we}function we(){this.i=null,this.g="",this.h=!1}v(ve,et),v(ye,et),v(me,ce),me.prototype.g=function(){return new XMLHttpRequest},me.prototype.i=function(){return{}},pe=new me;var Te=45e3,Ee={},Se={};function xe(t,e,i){t.K=1,t.v=$e(Ke(e)),t.s=i,t.U=!0,je(t,null)}function je(t,e){t.F=Date.now(),Re(t),t.A=Ke(t.v);var i=t.A,n=t.X;Array.isArray(n)||(n=[String(n)]),ui(i.h,"t",n),t.C=0,i=t.l.H,t.h=new we,t.g=yn(t.l,i?e:null,!t.s),0<t.O&&(t.L=new Kt(p(t.Ia,t,t.g),t.O)),Jt(t.V,t.g,"readystatechange",t.gb),e=t.H?M(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),se(1),$t(t.j,t.u,t.A,t.m,t.X,t.s)}function Ce(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Ie(t,e,i){let n,s=!0;for(;!t.I&&t.C<i.length;){if((n=Ae(t,i))==Se){4==e&&(t.o=4,oe(14),s=!1),zt(t.j,t.m,null,"[Incomplete Response]");break}if(n==Ee){t.o=4,oe(15),zt(t.j,t.m,i,"[Invalid Chunk]"),s=!1;break}zt(t.j,t.m,n,null),Le(t,n)}Ce(t)&&n!=Se&&n!=Ee&&(t.h.g="",t.C=0),4!=e||0!=i.length||t.h.h||(t.o=1,oe(16),s=!1),t.i=t.i&&s,s?0<i.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+i.length),ln(e),e.L=!0,oe(11))):(zt(t.j,t.m,i,"[Invalid Chunked Response]"),Me(t),De(t))}function Ae(t,e){var i=t.C,n=e.indexOf("\n",i);return-1==n?Se:(i=Number(e.substring(i,n)),isNaN(i)?Ee:(n+=1)+i>e.length?Se:(e=e.substr(n,i),t.C=n+i,e))}function Re(t){t.Y=Date.now()+t.P,Oe(t,t.P)}function Oe(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ae(p(t.eb,t),e)}function Pe(t){t.B&&(r.clearTimeout(t.B),t.B=null)}function De(t){0==t.l.G||t.I||fn(t.l,t)}function Me(t){Pe(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ft(t.W),Wt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Le(t,e){try{var i=t.l;if(0!=i.G&&(i.g==t||mi(i.i,t)))if(i.I=t.N,!t.J&&mi(i.i,t)&&3==i.G){try{var n=i.Ca.g.parse(e)}catch(l){n=null}if(Array.isArray(n)&&3==n.length){var s=n;if(0==s[0]){t:if(!i.u){if(i.g){if(!(i.g.F+3e3<t.F))break t;cn(i),Zi(i)}an(i),oe(18)}}else i.ta=s[1],0<i.ta-i.U&&37500>s[2]&&i.N&&0==i.A&&!i.v&&(i.v=ae(p(i.ab,i),6e3));if(1>=yi(i.i)&&i.ka){try{i.ka()}catch(l){}i.ka=void 0}}else pn(i,11)}else if((t.J||i.g==t)&&cn(i),!j(e))for(s=i.Ca.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(i.U=l[0],l=l[1],2==i.G)if("c"==l[0]){i.J=l[1],i.la=l[2];const e=l[3];null!=e&&(i.ma=e,i.h.info("VER="+i.ma));const s=l[4];null!=s&&(i.za=s,i.h.info("SVER="+i.za));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(n=1.5*u,i.K=n,i.h.info("backChannelRequestTimeoutMs_="+n)),n=i;const c=t.g;if(c){const t=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var r=n.i;!r.g&&(A(t,"spdy")||A(t,"quic")||A(t,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(bi(r,r.h),r.h=null))}if(n.D){const t=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(n.sa=t,Ve(n.F,n.D,t))}}i.G=3,i.j&&i.j.xa(),i.$&&(i.O=Date.now()-t.F,i.h.info("Handshake RTT: "+i.O+"ms"));var o=t;if((n=i).oa=vn(n,n.H?n.la:null,n.W),o.J){wi(n.i,o);var h=o,a=n.K;a&&h.setTimeout(a),h.B&&(Pe(h),Re(h)),n.g=o}else hn(n);0<i.l.length&&en(i)}else"stop"!=l[0]&&"close"!=l[0]||pn(i,7);else 3==i.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?pn(i,7):zi(i):"noop"!=l[0]&&i.j&&i.j.wa(l),i.A=0)}se(4)}catch(l){}}function Xe(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(h(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}for(n in e=[],i=0,t)e[i++]=t[n];return e}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||"string"==typeof t)T(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var i=t.T();else if(t.R&&"function"==typeof t.R)i=void 0;else if(h(t)||"string"==typeof t){i=[];for(var n=t.length,s=0;s<n;s++)i.push(s)}else for(s in i=[],n=0,t)i[n++]=s;s=(n=Xe(t)).length;for(var r=0;r<s;r++)e.call(void 0,n[r],i&&i[r],t)}}function ke(t,e){this.h={},this.g=[],this.i=0;var i=arguments.length;if(1<i){if(i%2)throw Error("Uneven number of arguments");for(var n=0;n<i;n+=2)this.set(arguments[n],arguments[n+1])}else if(t)if(t instanceof ke)for(i=t.T(),n=0;n<i.length;n++)this.set(i[n],t.get(i[n]));else for(n in t)this.set(n,t[n])}function _e(t){if(t.i!=t.g.length){for(var e=0,i=0;e<t.g.length;){var n=t.g[e];Be(t.h,n)&&(t.g[i++]=n),e++}t.g.length=i}if(t.i!=t.g.length){var s={};for(i=e=0;e<t.g.length;)Be(s,n=t.g[e])||(t.g[i++]=n,s[n]=1),e++;t.g.length=i}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(n=be.prototype).setTimeout=function(t){this.P=t},n.gb=function(t){t=t.target;const e=this.L;e&&3==Gi(t)?e.l():this.Ia(t)},n.Ia=function(t){try{if(t==this.g)t:{const c=Gi(this.g);var e=this.g.Da();const f=this.g.ba();if(!(3>c)&&(3!=c||U||this.g&&(this.h.h||this.g.ga()||Ji(this.g)))){this.I||4!=c||7==e||se(8==e||0>=f?3:2),Pe(this);var i=this.g.ba();this.N=i;e:if(Ce(this)){var n=Ji(this.g);t="";var s=n.length,o=4==Gi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Me(this),De(this);var h="";break e}this.h.i=new r.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:o&&e==s-1});n.splice(0,s),this.h.g+=t,this.C=0,h=this.h.g}else h=this.g.ga();if(this.i=200==i,qt(this.j,this.u,this.A,this.m,this.X,c,i),this.i){if(this.$&&!this.J){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(a)){var u=a;break e}}u=null}if(!(i=u)){this.i=!1,this.o=3,oe(12),Me(this),De(this);break t}zt(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Le(this,i)}this.U?(Ie(this,c,h),U&&this.i&&3==c&&(Jt(this.V,this.W,"tick",this.fb),this.W.start())):(zt(this.j,this.m,h,null),Le(this,h)),4==c&&Me(this),this.i&&!this.I&&(4==c?fn(this.l,this):(this.i=!1,Re(this)))}else 400==i&&0<h.indexOf("Unknown SID")?(this.o=3,oe(12)):(this.o=0,oe(13)),Me(this),De(this)}}}catch(c){}},n.fb=function(){if(this.g){var t=Gi(this.g),e=this.g.ga();this.C<e.length&&(Pe(this),Ie(this,t,e),this.i&&4!=t&&Re(this))}},n.cancel=function(){this.I=!0,Me(this)},n.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Zt(this.j,this.A),2!=this.K&&(se(3),oe(17)),Me(this),this.o=2,De(this)):Oe(this,this.Y-t)},(n=ke.prototype).R=function(){_e(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},n.T=function(){return _e(this),this.g.concat()},n.get=function(t,e){return Be(this.h,t)?this.h[t]:e},n.set=function(t,e){Be(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},n.forEach=function(t,e){for(var i=this.T(),n=0;n<i.length;n++){var s=i[n],r=this.get(s);t.call(e,r,s,this)}};var Fe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ne(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),s=null;if(0<=n){var r=t[i].substring(0,n);s=t[i].substring(n+1)}else r=t[i];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function Ue(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Ue){this.g=void 0!==e?e:t.g,Ye(this,t.j),this.s=t.s,Ge(this,t.i),Je(this,t.m),this.l=t.l,e=t.h;var i=new oi;i.i=e.i,e.g&&(i.g=new ke(e.g),i.h=e.h),We(this,i),this.o=t.o}else t&&(i=String(t).match(Fe))?(this.g=!!e,Ye(this,i[1]||"",!0),this.s=Ze(i[2]||""),Ge(this,i[3]||"",!0),Je(this,i[4]),this.l=Ze(i[5]||"",!0),We(this,i[6]||"",!0),this.o=Ze(i[7]||"")):(this.g=!!e,this.h=new oi(null,this.g))}function Ke(t){return new Ue(t)}function Ye(t,e,i){t.j=i?Ze(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ge(t,e,i){t.i=i?Ze(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function We(t,e,i){e instanceof oi?(t.h=e,fi(t.h,t.g)):(i||(e=Qe(e,si)),t.h=new oi(e,t.g))}function Ve(t,e,i){t.h.set(e,i)}function $e(t){return Ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function qe(t){return t instanceof Ue?Ke(t):new Ue(t,void 0)}function ze(t,e,i,n){var s=new Ue(null,void 0);return t&&Ye(s,t),e&&Ge(s,e),i&&Je(s,i),n&&(s.l=n),s}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Qe(t,e,i){return"string"==typeof t?(t=encodeURI(t).replace(e,ti),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ti(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ue.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Qe(e,ei,!0),":");var i=this.i;return(i||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Qe(e,ei,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.m)&&t.push(":",String(i))),(i=this.l)&&(this.i&&"/"!=i.charAt(0)&&t.push("/"),t.push(Qe(i,"/"==i.charAt(0)?ni:ii,!0))),(i=this.h.toString())&&t.push("?",i),(i=this.o)&&t.push("#",Qe(i,ri)),t.join("")};var ei=/[#\/\?@]/g,ii=/[#\?:]/g,ni=/[#\?]/g,si=/[#\?@]/g,ri=/#/g;function oi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function hi(t){t.g||(t.g=new ke,t.h=0,t.i&&Ne(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}function ai(t,e){hi(t),e=ci(t,e),Be(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Be((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&_e(t)))}function li(t,e){return hi(t),e=ci(t,e),Be(t.g.h,e)}function ui(t,e,i){ai(t,e),0<i.length&&(t.i=null,t.g.set(ci(t,e),x(i)),t.h+=i.length)}function ci(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function fi(t,e){e&&!t.j&&(hi(t),t.i=null,t.g.forEach(function(t,e){var i=e.toLowerCase();e!=i&&(ai(this,e),ui(this,i,t))},t)),t.j=e}(n=oi.prototype).add=function(t,e){hi(this),this.i=null,t=ci(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this},n.forEach=function(t,e){hi(this),this.g.forEach(function(i,n){T(i,function(i){t.call(e,i,n,this)},this)},this)},n.T=function(){hi(this);for(var t=this.g.R(),e=this.g.T(),i=[],n=0;n<e.length;n++)for(var s=t[n],r=0;r<s.length;r++)i.push(e[n]);return i},n.R=function(t){hi(this);var e=[];if("string"==typeof t)li(this,t)&&(e=S(e,this.g.get(ci(this,t))));else{t=this.g.R();for(var i=0;i<t.length;i++)e=S(e,t[i])}return e},n.set=function(t,e){return hi(this),this.i=null,li(this,t=ci(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},n.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),i=0;i<e.length;i++){var n=e[i],s=encodeURIComponent(String(n));n=this.R(n);for(var r=0;r<n.length;r++){var o=s;""!==n[r]&&(o+="="+encodeURIComponent(String(n[r]))),t.push(o)}}return this.i=t.join("&")};var gi=class{constructor(t,e){this.h=t,this.g=e}};function pi(t){this.l=t||di,r.PerformanceNavigationTiming?t=0<(t=r.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(r.g&&r.g.Ea&&r.g.Ea()&&r.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var di=10;function vi(t){return!!t.h||!!t.g&&t.g.size>=t.j}function yi(t){return t.h?1:t.g?t.g.size:0}function mi(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function bi(t,e){t.g?t.g.add(e):t.h=e}function wi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Ti(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const i of t.g.values())e=e.concat(i.D);return e}return x(t.i)}function Ei(){}function Si(){this.g=new Ei}function xi(t,e,i){const n=i||"";try{He(t,function(t,i){let s=t;a(t)&&(s=It(t)),e.push(n+i+"="+encodeURIComponent(s))})}catch(s){throw e.push(n+"type="+encodeURIComponent("_badmap")),s}}function ji(t,e){const i=new Vt;if(r.Image){const n=new Image;n.onload=d(Ci,i,n,"TestLoadImage: loaded",!0,e),n.onerror=d(Ci,i,n,"TestLoadImage: error",!1,e),n.onabort=d(Ci,i,n,"TestLoadImage: abort",!1,e),n.ontimeout=d(Ci,i,n,"TestLoadImage: timeout",!1,e),r.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}function Ci(t,e,i,n,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(n)}catch(r){}}function Ii(t){this.l=t.$b||null,this.j=t.ib||!1}function Ai(t,e){xt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ri,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pi.prototype.cancel=function(){if(this.i=Ti(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},Ei.prototype.stringify=function(t){return r.JSON.stringify(t,void 0)},Ei.prototype.parse=function(t){return r.JSON.parse(t,void 0)},v(Ii,ce),Ii.prototype.g=function(){return new Ai(this.l,this.j)},Ii.prototype.i=function(t){return function(){return t}}({}),v(Ai,xt);var Ri=0;function Oi(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Pi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Di(t)}function Di(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(n=Ai.prototype).open=function(t,e){if(this.readyState!=Ri)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Di(this)},n.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||r).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},n.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pi(this)),this.readyState=Ri},n.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Di(this)),this.g&&(this.readyState=3,Di(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==r.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Oi(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},n.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Pi(this):Di(this),3==this.readyState&&Oi(this)}},n.Ua=function(t){this.g&&(this.response=this.responseText=t,Pi(this))},n.Ta=function(t){this.g&&(this.response=t,Pi(this))},n.ha=function(){this.g&&Pi(this)},n.setRequestHeader=function(t,e){this.v.append(t,e)},n.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join("\r\n")},Object.defineProperty(Ai.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Mi=r.JSON.parse;function Li(t){xt.call(this),this.headers=new ke,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Xi,this.K=this.L=!1}v(Li,xt);var Xi="",Hi=/^https?$/i,ki=["POST","PUT"];function _i(t){return F&&z()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Bi(t){return"content-type"==t.toLowerCase()}function Fi(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ni(t),Ki(t)}function Ni(t){t.D||(t.D=!0,jt(t,"complete"),jt(t,"error"))}function Ui(t){if(t.h&&void 0!==s&&(!t.C[1]||4!=Gi(t)||2!=t.ba()))if(t.v&&4==Gi(t))Nt(t.Fa,0,t);else if(jt(t,"readystatechange"),4==Gi(t)){t.h=!1;try{const s=t.ba();t:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var i;if(!(i=e)){var n;if(n=0===s){var o=String(t.H).match(Fe)[1]||null;if(!o&&r.self&&r.self.location){var h=r.self.location.protocol;o=h.substr(0,h.length-1)}n=!Hi.test(o?o.toLowerCase():"")}i=n}if(i)jt(t,"complete"),jt(t,"success");else{t.m=6;try{var a=2<Gi(t)?t.g.statusText:""}catch(l){a=""}t.j=a+" ["+t.ba()+"]",Ni(t)}}finally{Ki(t)}}}function Ki(t,e){if(t.g){Yi(t);const n=t.g,s=t.C[0]?o:null;t.g=null,t.C=null,e||jt(t,"ready");try{n.onreadystatechange=s}catch(i){}}}function Yi(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(r.clearTimeout(t.A),t.A=null)}function Gi(t){return t.g?t.g.readyState:0}function Ji(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Xi:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Wi(t){let e="";return D(t,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function Vi(t,e,i){t:{for(n in i){var n=!1;break t}n=!0}n||(i=Wi(i),"string"==typeof t?null!=i&&encodeURIComponent(String(i)):Ve(t,e,i))}function $i(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function qi(t){this.za=0,this.l=[],this.h=new Vt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=$i("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=$i("baseRetryDelayMs",5e3,t),this.$a=$i("retryDelaySeedMs",1e4,t),this.Ya=$i("forwardChannelMaxRetries",2,t),this.ra=$i("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new pi(t&&t.concurrentRequestLimit),this.Ca=new Si,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function zi(t){if(Qi(t),3==t.G){var e=t.V++,i=Ke(t.F);Ve(i,"SID",t.J),Ve(i,"RID",e),Ve(i,"TYPE","terminate"),rn(t,i),(e=new be(t,t.h,e,void 0)).K=2,e.v=$e(Ke(i)),i=!1,r.navigator&&r.navigator.sendBeacon&&(i=r.navigator.sendBeacon(e.v.toString(),"")),!i&&r.Image&&((new Image).src=e.v,i=!0),i||(e.g=yn(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Re(e)}dn(t)}function Zi(t){t.g&&(ln(t),t.g.cancel(),t.g=null)}function Qi(t){Zi(t),t.u&&(r.clearTimeout(t.u),t.u=null),cn(t),t.i.cancel(),t.m&&("number"==typeof t.m&&r.clearTimeout(t.m),t.m=null)}function tn(t,e){t.l.push(new gi(t.Za++,e)),3==t.G&&en(t)}function en(t){vi(t.i)||t.m||(t.m=!0,Lt(t.Ha,t),t.C=0)}function nn(t,e){return!(yi(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=e.D.concat(t.l),!0):!(1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya))&&(t.m=ae(p(t.Ha,t,e),gn(t,t.C)),t.C++,!0))}function sn(t,e){var i;i=e?e.m:t.V++;const n=Ke(t.F);Ve(n,"SID",t.J),Ve(n,"RID",i),Ve(n,"AID",t.U),rn(t,n),t.o&&t.s&&Vi(n,t.o,t.s),i=new be(t,t.h,i,t.C+1),null===t.o&&(i.H=t.s),e&&(t.l=e.D.concat(t.l)),e=on(t,i,1e3),i.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),bi(t.i,i),xe(i,n,e)}function rn(t,e){t.j&&He({},function(t,i){Ve(e,i,t)})}function on(t,e,i){i=Math.min(t.l.length,i);var n=t.j?p(t.j.Oa,t.j,t):null;t:{var s=t.l;let e=-1;for(;;){const t=["count="+i];-1==e?0<i?(e=s[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let h=0;h<i;h++){let i=s[h].h;const a=s[h].g;if(0>(i-=e))e=Math.max(0,s[h].h-100),o=!1;else try{xi(a,t,"req"+i+"_")}catch(r){n&&n(a)}}if(o){n=t.join("&");break t}}}return t=t.l.splice(0,i),e.D=t,n}function hn(t){t.g||t.u||(t.Y=1,Lt(t.Ga,t),t.A=0)}function an(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=ae(p(t.Ga,t),gn(t,t.A)),t.A++,!0)}function ln(t){null!=t.B&&(r.clearTimeout(t.B),t.B=null)}function un(t){t.g=new be(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Ke(t.oa);Ve(e,"RID","rpc"),Ve(e,"SID",t.J),Ve(e,"CI",t.N?"0":"1"),Ve(e,"AID",t.U),rn(t,e),Ve(e,"TYPE","xmlhttp"),t.o&&t.s&&Vi(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var i=t.g;t=t.la,i.K=1,i.v=$e(Ke(e)),i.s=null,i.U=!0,je(i,t)}function cn(t){null!=t.v&&(r.clearTimeout(t.v),t.v=null)}function fn(t,e){var i=null;if(t.g==e){cn(t),ln(t),t.g=null;var n=2}else{if(!mi(t.i,e))return;i=e.D,wi(t.i,e),n=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==n){i=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;jt(n=ie(),new he(n,i,e,s)),en(t)}else hn(t);else if(3==(s=e.o)||0==s&&0<t.I||!(1==n&&nn(t,e)||2==n&&an(t)))switch(i&&0<i.length&&(e=t.i,e.i=e.i.concat(i)),s){case 1:pn(t,5);break;case 4:pn(t,10);break;case 3:pn(t,6);break;default:pn(t,2)}}function gn(t,e){let i=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(i*=2),i*e}function pn(t,e){if(t.h.info("Error code "+e),2==e){var i=null;t.j&&(i=null);var n=p(t.jb,t);i||(i=new Ue("//www.google.com/images/cleardot.gif"),r.location&&"http"==r.location.protocol||Ye(i,"https"),$e(i)),ji(i.toString(),n)}else oe(2);t.G=0,t.j&&t.j.va(e),dn(t),Qi(t)}function dn(t){t.G=0,t.I=-1,t.j&&(0==Ti(t.i).length&&0==t.l.length||(t.i.i.length=0,x(t.l),t.l.length=0),t.j.ua())}function vn(t,e,i){let n=qe(i);if(""!=n.i)e&&Ge(n,e+"."+n.i),Je(n,n.m);else{const t=r.location;n=ze(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,i)}return t.aa&&D(t.aa,function(t,e){Ve(n,e,t)}),e=t.D,i=t.sa,e&&i&&Ve(n,e,i),Ve(n,"VER",t.ma),rn(t,n),n}function yn(t,e,i){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=i&&t.Ba&&!t.qa?new Li(new Ii({ib:!0})):new Li(t.qa)).L=t.H,e}function mn(){}function bn(){if(F&&!(10<=Number(Q)))throw Error("Environmental error: no available transport.")}function wn(t,e){xt.call(this),this.g=new qi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!j(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!j(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Sn(this)}function Tn(t){ve.call(this);var e=t.__sm__;if(e){t:{for(const i in e){t=i;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function En(){ye.call(this),this.status=1}function Sn(t){this.g=t}(n=Li.prototype).ea=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():pe.g(),this.C=this.u?fe(this.u):fe(pe),this.g.onreadystatechange=p(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){return void Fi(this,o)}t=i||"";const s=new ke(this.headers);n&&He(n,function(t,e){s.set(e,t)}),n=E(s.T()),i=r.FormData&&t instanceof r.FormData,!(0<=w(ki,e))||n||i||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Yi(this),0<this.B&&((this.K=_i(this.g))?(this.g.timeout=this.B,this.g.ontimeout=p(this.pa,this)):this.A=Nt(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Fi(this,o)}},n.pa=function(){void 0!==s&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,jt(this,"timeout"),this.abort(8))},n.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,jt(this,"complete"),jt(this,"abort"),Ki(this))},n.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ki(this,!0)),Li.Z.M.call(this)},n.Fa=function(){this.s||(this.F||this.v||this.l?Ui(this):this.cb())},n.cb=function(){Ui(this)},n.ba=function(){try{return 2<Gi(this)?this.g.status:-1}catch(t){return-1}},n.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},n.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Mi(e)}},n.Da=function(){return this.m},n.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(n=qi.prototype).ma=8,n.G=1,n.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},n.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new be(this,this.h,t,void 0);let r=this.s;if(this.P&&(r?X(r=M(r),this.P):r=this.P),null===this.o&&(s.H=r),this.ja)t:{for(var e=0,i=0;i<this.l.length;i++){var n=this.l[i];if(void 0===(n="__data__"in n.g&&"string"==typeof(n=n.g.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=i;break t}if(4096===e||i===this.l.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=on(this,s,e),Ve(i=Ke(this.F),"RID",t),Ve(i,"CVER",22),this.D&&Ve(i,"X-HTTP-Session-Id",this.D),rn(this,i),this.o&&r&&Vi(i,this.o,r),bi(this.i,s),this.Ra&&Ve(i,"TYPE","init"),this.ja?(Ve(i,"$req",e),Ve(i,"SID","null"),s.$=!0,xe(s,i,null)):xe(s,i,e),this.G=2}}else 3==this.G&&(t?sn(this,t):0==this.l.length||vi(this.i)||sn(this))},n.Ga=function(){if(this.u=null,un(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ae(p(this.bb,this),t)}},n.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,oe(10),Zi(this),un(this))},n.ab=function(){null!=this.v&&(this.v=null,Zi(this),an(this),oe(19))},n.jb=function(t){t?(this.h.info("Successfully pinged google.com"),oe(2)):(this.h.info("Failed to ping google.com"),oe(1))},(n=mn.prototype).xa=function(){},n.wa=function(){},n.va=function(){},n.ua=function(){},n.Oa=function(){},bn.prototype.g=function(t,e){return new wn(t,e)},v(wn,xt),wn.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,i=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Lt(p(t.hb,t,e))),oe(0),t.W=e,t.aa=i||{},t.N=t.X,t.F=vn(t,null,t.W),en(t)},wn.prototype.close=function(){zi(this.g)},wn.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,tn(this.g,e)}else this.v?((e={}).__data__=It(t),tn(this.g,e)):tn(this.g,t)},wn.prototype.M=function(){this.g.j=null,delete this.j,zi(this.g),delete this.g,wn.Z.M.call(this)},v(Tn,ve),v(En,ye),v(Sn,mn),Sn.prototype.xa=function(){jt(this.g,"a")},Sn.prototype.wa=function(t){jt(this.g,new Tn(t))},Sn.prototype.va=function(t){jt(this.g,new En(t))},Sn.prototype.ua=function(){jt(this.g,"b")},bn.prototype.createWebChannel=bn.prototype.g,wn.prototype.send=wn.prototype.u,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,le.NO_ERROR=0,le.TIMEOUT=8,le.HTTP_ERROR=6,ue.COMPLETE="complete",ge.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",xt.prototype.listen=xt.prototype.N,Li.prototype.listenOnce=Li.prototype.O,Li.prototype.getLastError=Li.prototype.La,Li.prototype.getLastErrorCode=Li.prototype.Da,Li.prototype.getStatus=Li.prototype.ba,Li.prototype.getResponseJson=Li.prototype.Qa,Li.prototype.getResponseText=Li.prototype.ga,Li.prototype.send=Li.prototype.ea;var xn=i.createWebChannelTransport=function(){return new bn};exports.createWebChannelTransport=xn;var jn=i.getStatEventTarget=function(){return ie()};exports.getStatEventTarget=jn;var Cn=i.ErrorCode=le;exports.ErrorCode=Cn;var In=i.EventType=ue;exports.EventType=In;var An=i.Event=te;exports.Event=An;var Rn=i.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20};exports.Stat=Rn;var On=i.FetchXmlHttpFactory=Ii;exports.FetchXmlHttpFactory=On;var Pn=i.WebChannel=ge;exports.WebChannel=Pn;var Dn=i.XhrIo=Li;exports.XhrIo=Dn;
},{}],"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"lBbe":[function(require,module,exports) {
var process = require("process");
var e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports._FieldPath=exports._EmptyAuthCredentialsProvider=exports._EmptyAppCheckTokenProvider=exports._DocumentKey=exports._DatabaseId=exports.WriteBatch=exports.Transaction=exports.Timestamp=exports.SnapshotMetadata=exports.QuerySnapshot=exports.QueryDocumentSnapshot=exports.QueryConstraint=exports.Query=exports.LoadBundleTask=exports.GeoPoint=exports.FirestoreError=exports.Firestore=exports.FieldValue=exports.FieldPath=exports.DocumentSnapshot=exports.DocumentReference=exports.CollectionReference=exports.CACHE_SIZE_UNLIMITED=exports.Bytes=exports.AbstractUserDataWriter=void 0,exports._cast=pc,exports._debugAssert=W,exports._isBase64Available=Ie,exports._logWarn=j,exports._validateIsNotUsedTogether=fc,exports.addDoc=yf,exports.arrayRemove=Sf,exports.arrayUnion=Ef,exports.clearIndexedDbPersistence=Uc,exports.collection=Ic,exports.collectionGroup=Tc,exports.connectFirestoreEmulator=kc,exports.deleteDoc=pf,exports.deleteField=If,exports.disableNetwork=jc,exports.doc=Ec,exports.documentId=Yc,exports.enableIndexedDbPersistence=Pc,exports.enableMultiTabIndexedDbPersistence=Vc,exports.enableNetwork=Kc,exports.endAt=Yl,exports.endBefore=Hl,exports.ensureFirestoreConfigured=Fc,exports.executeWrite=kf,exports.getDoc=of,exports.getDocFromCache=sf,exports.getDocFromServer=cf,exports.getDocs=lf,exports.getDocsFromCache=ff,exports.getDocsFromServer=hf,exports.getFirestore=Mc,exports.increment=Rf,exports.initializeFirestore=Lc,exports.limit=Kl,exports.limitToLast=jl,exports.loadBundle=zc,exports.namedQuery=Qc,exports.onSnapshot=mf,exports.onSnapshotsInSync=gf,exports.orderBy=Ul,exports.query=Ol,exports.queryEqual=Rc,exports.refEqual=Sc,exports.runTransaction=xf,exports.serverTimestamp=Tf,exports.setDoc=df,exports.setLogLevel=U,exports.snapshotEqual=Ll,exports.startAfter=Ql,exports.startAt=zl,exports.terminate=Gc,exports.updateDoc=vf,exports.waitForPendingWrites=Bc,exports.where=Vl,exports.writeBatch=_f;var t=require("@firebase/app"),n=require("@firebase/component"),r=require("@firebase/logger"),i=require("@firebase/util"),a=require("@firebase/webchannel-wrapper");function o(){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=u(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}function s(e,t){return f(e)||l(e,t)||_(e,t)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(s){u=!0,i=s}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}}function f(e){if(Array.isArray(e))return e}function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function v(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){v(a,r,i,o,u,"next",e)}function u(e){v(a,r,i,o,u,"throw",e)}o(void 0)})}}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}function m(e){var t=x();return function(){var n,r=E(e);if(t){var i=E(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){var t="function"==typeof Map?new Map:void 0;return(w=function(e){if(null===e||!I(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return b(e,arguments,E(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),T(n,e)})(e)}function b(e,t,n){return(b=x()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&T(i,n.prototype),i}).apply(null,arguments)}function x(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function I(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){return D(e)||A(e)||_(e)||R()}function R(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}function A(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function D(e){if(Array.isArray(e))return N(e)}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var F="@firebase/firestore",O=function(){function e(t){C(this,e),this.uid=t}return M(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();O.UNAUTHENTICATED=new O(null),O.GOOGLE_CREDENTIALS=new O("google-credentials-uid"),O.FIRST_PARTY=new O("first-party-uid"),O.MOCK_USER=new O("mock-user");var P="9.6.1",V=new r.Logger("@firebase/firestore");function q(){return V.logLevel}function U(e){V.setLogLevel(e)}function B(e){if(V.logLevel<=r.LogLevel.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a=n.map(G);V.debug.apply(V,["Firestore (".concat(P,"): ").concat(e)].concat(S(a)))}}function K(e){if(V.logLevel<=r.LogLevel.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a=n.map(G);V.error.apply(V,["Firestore (".concat(P,"): ").concat(e)].concat(S(a)))}}function j(e){if(V.logLevel<=r.LogLevel.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a=n.map(G);V.warn.apply(V,["Firestore (".concat(P,"): ").concat(e)].concat(S(a)))}}function G(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(P,") INTERNAL ASSERTION FAILED: ")+e;throw K(t),new Error(t)}function Q(e,t){e||z()}function W(e,t){e||z()}function H(e,t){return e}var Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},J=function(e){y(n,w(Error));var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,r)).code=e,i.message=r,i.name="FirebaseError",i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return M(n)}();exports.FirestoreError=J;var X=M(function e(){var t=this;C(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),Z=M(function e(t,n){C(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),$=function(){function e(){C(this,e)}return M(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(O.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}();exports._EmptyAuthCredentialsProvider=$;var ee=function(){function e(t){C(this,e),this.token=t,this.changeListener=null}return M(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable(function(){return t(n.token.user)})}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),te=function(){function e(t){C(this,e),this.t=t,this.currentUser=O.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return M(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new X;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new X,e.enqueueRetryable(function(){return i(n.currentUser)})};var o=function(){var t=a;e.enqueueRetryable(p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){B("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(B("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new X)}},0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(B("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Q("string"==typeof n.accessToken),new Z(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Q(null===e||"string"==typeof e),new O(e)}}]),e}(),ne=M(function e(t,n,r){C(this,e),this.type="FirstParty",this.user=O.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),re=function(){function e(t,n,r){C(this,e),this.h=t,this.l=n,this.m=r}return M(e,[{key:"getToken",value:function(){return Promise.resolve(new ne(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(O.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),ie=M(function e(t){C(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),ae=function(){function e(t){C(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null}return M(e,[{key:"start",value:function(e,t){var n=this;this.o=function(n){e.enqueueRetryable(function(){return null!=(e=n).error&&B("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message)),t(e.token);var e})};var r=function(e){B("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):B("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(function(e){return e?(Q("string"==typeof e.token),new ie(e.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}(),oe=function(){function e(){C(this,e)}return M(e,[{key:"getToken",value:function(){return Promise.resolve(new ie(""))}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){}},{key:"shutdown",value:function(){}}]),e}();exports._EmptyAppCheckTokenProvider=oe;var ue=function(){function e(t,n){var r=this;C(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.p(e)},this.T=function(e){return n.writeSequenceNumber(e)})}return M(e,[{key:"p",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.T&&this.T(e),e}}]),e}();function se(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}ue.I=-1;var ce=function(){function e(){C(this,e)}return M(e,null,[{key:"A",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=se(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function le(e,t){return e<t?-1:e>t?1:0}function fe(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}function he(e){return e+"\0"}var de=function(){function e(t,n){if(C(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new J(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new J(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new J(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return M(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}();exports.Timestamp=de;var ve=function(){function e(t){C(this,e),this.timestamp=t}return M(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new de(0,0))}}]),e}();function pe(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ye(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function me(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var ge=function(){function e(t,n,r){C(this,e),void 0===n?n=0:n>t.length&&z(),void 0===r?r=t.length-n:r>t.length-n&&z(),this.segments=t,this.offset=n,this.len=r}return M(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),ke=function(e){y(n,ge);var t=m(n);function n(){return C(this,n),t.apply(this,arguments)}return M(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var u=o[a];if(u.indexOf("//")>=0)throw new J(Y.INVALID_ARGUMENT,"Invalid segment (".concat(u,"). Paths must not contain // in them."));e.push.apply(e,S(u.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(),we=/^[_a-zA-Z][_a-zA-Z0-9]*$/,be=function(e){y(n,ge);var t=m(n);function n(){return C(this,n),t.apply(this,arguments)}return M(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return we.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new J(Y.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new J(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new J(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(r+=u,i++):(a(),i++)}if(a(),o)throw new J(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}();exports._FieldPath=be;var xe=function(){function e(t){C(this,e),this.fields=t,t.sort(be.comparator)}return M(e,[{key:"covers",value:function(e){var t,n=d(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return fe(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}]),e}();function Ie(){return"undefined"!=typeof atob}var Te=function(){function e(t){C(this,e),this.binaryString=t}return M(e,[{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return le(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(t){return new e(atob(t))}},{key:"fromUint8Array",value:function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))}}]),e}();Te.EMPTY_BYTE_STRING=new Te("");var Ee=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Se(e){if(Q(!!e),"string"==typeof e){var t=0,n=Ee.exec(e);if(Q(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Re(e.seconds),nanos:Re(e.nanos)}}function Re(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function _e(e){return"string"==typeof e?Te.fromBase64String(e):Te.fromUint8Array(e)}function Ae(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function De(e){var t=e.mapValue.fields.__previous_value__;return Ae(t)?De(t):t}function Ne(e){var t=Se(e.mapValue.fields.__local_write_time__.timestampValue);return new de(t.seconds,t.nanos)}function Ce(e){return null==e}function Le(e){return 0===e&&1/e==-1/0}function Me(e){return"number"==typeof e&&Number.isInteger(e)&&!Le(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var Fe=function(){function e(t){C(this,e),this.path=t}return M(e,[{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"isEqual",value:function(e){return null!==e&&0===ke.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(ke.fromString(t))}},{key:"fromName",value:function(t){return new e(ke.fromString(t).popFirst(5))}},{key:"comparator",value:function(e,t){return ke.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new ke(t.slice()))}}]),e}();function Oe(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ae(e)?4:10:z()}function Pe(e,t){var n=Oe(e);if(n!==Oe(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ne(e).isEqual(Ne(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Se(e.timestampValue),r=Se(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return _e(e.bytesValue).isEqual(_e(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Re(e.geoPointValue.latitude)===Re(t.geoPointValue.latitude)&&Re(e.geoPointValue.longitude)===Re(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Re(e.integerValue)===Re(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Re(e.doubleValue),r=Re(t.doubleValue);return n===r?Le(n)===Le(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return fe(e.arrayValue.values||[],t.arrayValue.values||[],Pe);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(pe(n)!==pe(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Pe(n[i],r[i])))return!1;return!0}(e,t);default:return z()}}function Ve(e,t){return void 0!==(e.values||[]).find(function(e){return Pe(e,t)})}function qe(e,t){var n=Oe(e),r=Oe(t);if(n!==r)return le(n,r);switch(n){case 0:return 0;case 1:return le(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Re(e.integerValue||e.doubleValue),r=Re(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ue(e.timestampValue,t.timestampValue);case 4:return Ue(Ne(e),Ne(t));case 5:return le(e.stringValue,t.stringValue);case 6:return function(e,t){var n=_e(e),r=_e(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=le(n[i],r[i]);if(0!==a)return a}return le(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=le(Re(e.latitude),Re(t.latitude));return 0!==n?n:le(Re(e.longitude),Re(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=qe(n[i],r[i]);if(a)return a}return le(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=le(r[o],a[o]);if(0!==u)return u;var s=qe(n[r[o]],i[a[o]]);if(0!==s)return s}return le(r.length,a.length)}(e.mapValue,t.mapValue);default:throw z()}}function Ue(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return le(e,t);var n=Se(e),r=Se(t),i=le(n.seconds,r.seconds);return 0!==i?i:le(n.nanos,r.nanos)}function Be(e){return Ke(e)}function Ke(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=Se(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?_e(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Fe.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=d(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=Ke(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=d(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(Ke(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):z();var t,n}function je(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Ge(e){return!!e&&"integerValue"in e}function ze(e){return!!e&&"arrayValue"in e}function Qe(e){return!!e&&"nullValue"in e}function We(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function He(e){return!!e&&"mapValue"in e}function Ye(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==h(e.timestampValue))return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return ye(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=Ye(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ye(e.arrayValue.values[r]);return n}return Object.assign({},e)}exports._DocumentKey=Fe;var Je=function(){function e(t){C(this,e),this.value=t}return M(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!He(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ye(t)}},{key:"setAll",value:function(e){var t=this,n=be.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=Ye(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());He(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Pe(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];He(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){ye(t,function(t,n){return e[t]=n});var r,i=d(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(Ye(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function Xe(e){var t=[];return ye(e.fields,function(e,n){var r=new be([e]);if(He(n)){var i=Xe(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=d(i);try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push(r.child(u))}}catch(s){o.e(s)}finally{o.f()}}}else t.push(r)}),new xe(t)}var Ze=function(){function e(t,n,r,i,a){C(this,e),this.key=t,this.documentType=n,this.version=r,this.data=i,this.documentState=a}return M(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=Je.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=Je.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"clone",value:function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,ve.min(),Je.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Je.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Je.empty(),2)}}]),e}(),$e=M(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;C(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=u,this.R=null});function et(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new $e(e,t,n,r,i,a,o)}function tt(e){var t=H(e);if(null===t.R){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return ot(e)}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return function(e){return e.field.canonicalString()+e.dir}(e)}).join(","),Ce(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=yt(t.startAt)),t.endAt&&(n+="|ub:",n+=yt(t.endAt)),t.R=n}return t.R}function nt(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(Be(t.value));var t}).join(", "),"]")),Ce(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)}).join(", "),"]")),e.startAt&&(t+=", startAt: "+yt(e.startAt)),e.endAt&&(t+=", endAt: "+yt(e.endAt)),"Target(".concat(t,")")}function rt(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!gt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],a=t.filters[r],i.op!==a.op||!i.field.isEqual(a.field)||!Pe(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!wt(e.startAt,t.startAt)&&wt(e.endAt,t.endAt)}function it(e){return Fe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var at=function(e){y(n,function(){function e(){C(this,e)}return M(e)}());var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return M(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(qe(t,this.value)):null!==t&&Oe(this.value)===Oe(t)&&this.v(qe(t,this.value))}},{key:"v",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return z()}}},{key:"V",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.P(e,t,r):new ut(e,t,r):"array-contains"===t?new ft(e,r):"in"===t?new ht(e,r):"not-in"===t?new dt(e,r):"array-contains-any"===t?new vt(e,r):new n(e,t,r)}},{key:"P",value:function(e,t,n){return"in"===t?new st(e,n):new ct(e,n)}}]),n}();function ot(e){return e.field.canonicalString()+e.op.toString()+Be(e.value)}var ut=function(e){y(n,at);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this,e,r,i)).key=Fe.fromName(i.referenceValue),a}return M(n,[{key:"matches",value:function(e){var t=Fe.comparator(e.key,this.key);return this.v(t)}}]),n}(),st=function(e){y(n,at);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,e,"in",r)).keys=lt("in",r),i}return M(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(),ct=function(e){y(n,at);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,e,"not-in",r)).keys=lt("not-in",r),i}return M(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}();function lt(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return Fe.fromName(e.referenceValue)})}var ft=function(e){y(n,at);var t=m(n);function n(e,r){return C(this,n),t.call(this,e,"array-contains",r)}return M(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return ze(t)&&Ve(t.arrayValue,this.value)}}]),n}(),ht=function(e){y(n,at);var t=m(n);function n(e,r){return C(this,n),t.call(this,e,"in",r)}return M(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Ve(this.value.arrayValue,t)}}]),n}(),dt=function(e){y(n,at);var t=m(n);function n(e,r){return C(this,n),t.call(this,e,"not-in",r)}return M(n,[{key:"matches",value:function(e){if(Ve(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Ve(this.value.arrayValue,t)}}]),n}(),vt=function(e){y(n,at);var t=m(n);function n(e,r){return C(this,n),t.call(this,e,"array-contains-any",r)}return M(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!ze(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return Ve(t.value.arrayValue,e)})}}]),n}(),pt=M(function e(t,n){C(this,e),this.position=t,this.before=n});function yt(e){return"".concat(e.before?"b":"a",":").concat(e.position.map(function(e){return Be(e)}).join(","))}var mt=M(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";C(this,e),this.field=t,this.dir=n});function gt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function kt(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?Fe.comparator(Fe.fromName(o.referenceValue),n.key):qe(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function wt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Pe(e.position[n],t.position[n]))return!1;return!0}var bt=M(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;C(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=u,this.endAt=s,this.S=null,this.D=null,this.startAt,this.endAt});function xt(e,t,n,r,i,a,o,u){return new bt(e,t,n,r,i,a,o,u)}function It(e){return new bt(e)}function Tt(e){return!Ce(e.limit)&&"F"===e.limitType}function Et(e){return!Ce(e.limit)&&"L"===e.limitType}function St(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Rt(e){var t,n=d(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.V())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function _t(e){return null!==e.collectionGroup}function At(e){var t=H(e);if(null===t.S){t.S=[];var n=Rt(t),r=St(t);if(null!==n&&null===r)n.isKeyField()||t.S.push(new mt(n)),t.S.push(new mt(be.keyField(),"asc"));else{var i,a=!1,o=d(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var u=i.value;t.S.push(u),u.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.S.push(new mt(be.keyField(),s))}}}return t.S}function Dt(e){var t=H(e);if(!t.D)if("F"===t.limitType)t.D=et(t.path,t.collectionGroup,At(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=d(At(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new mt(a.field,o))}}catch(c){i.e(c)}finally{i.f()}var u=t.endAt?new pt(t.endAt.position,!t.endAt.before):null,s=t.startAt?new pt(t.startAt.position,!t.startAt.before):null;t.D=et(t.path,t.collectionGroup,r,t.filters,t.limit,u,s)}return t.D}function Nt(e,t,n){return new bt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ct(e,t){return rt(Dt(e),Dt(t))&&e.limitType===t.limitType}function Lt(e){return"".concat(tt(Dt(e)),"|lt:").concat(e.limitType)}function Mt(e){return"Query(target=".concat(nt(Dt(e)),"; limitType=").concat(e.limitType,")")}function Ft(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Fe.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=d(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=d(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!kt(e.startAt,At(e),t))&&(!e.endAt||!kt(e.endAt,At(e),t))}(e,t)}function Ot(e){return function(t,n){var r,i=!1,a=d(At(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,u=Pt(o,t,n);if(0!==u)return u;i=i||o.field.isKeyField()}}catch(s){a.e(s)}finally{a.f()}return 0}}function Pt(e,t,n){var r=e.field.isKeyField()?Fe.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?qe(r,i):z()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return z()}}function Vt(e,t){if(e.C){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Le(t)?"-0":t}}function qt(e){return{integerValue:""+e}}function Ut(e,t){return Me(t)?qt(t):Vt(e,t)}var Bt=M(function e(){C(this,e),this._=void 0});function Kt(e,t,n){return e instanceof zt?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Qt?Wt(e,t):e instanceof Ht?Yt(e,t):function(e,t){var n=Gt(e,t),r=Xt(n)+Xt(e.N);return Ge(n)&&Ge(e.N)?qt(r):Vt(e.k,r)}(e,t)}function jt(e,t,n){return e instanceof Qt?Wt(e,t):e instanceof Ht?Yt(e,t):n}function Gt(e,t){return e instanceof Jt?Ge(n=t)||n&&"doubleValue"in n?t:{integerValue:0}:null;var n}var zt=function(e){y(n,Bt);var t=m(n);function n(){return C(this,n),t.apply(this,arguments)}return M(n)}(),Qt=function(e){y(n,Bt);var t=m(n);function n(e){var r;return C(this,n),(r=t.call(this)).elements=e,r}return M(n)}();function Wt(e,t){var n,r=Zt(t),i=d(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return Pe(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Ht=function(e){y(n,Bt);var t=m(n);function n(e){var r;return C(this,n),(r=t.call(this)).elements=e,r}return M(n)}();function Yt(e,t){var n,r=Zt(t),i=d(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!Pe(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Jt=function(e){y(n,Bt);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this)).k=e,i.N=r,i}return M(n)}();function Xt(e){return Re(e.integerValue||e.doubleValue)}function Zt(e){return ze(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var $t=M(function e(t,n){C(this,e),this.field=t,this.transform=n});function en(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Qt&&t instanceof Qt||e instanceof Ht&&t instanceof Ht?fe(e.elements,t.elements,Pe):e instanceof Jt&&t instanceof Jt?Pe(e.N,t.N):e instanceof zt&&t instanceof zt}(e.transform,t.transform)}var tn=M(function e(t,n){C(this,e),this.version=t,this.transformResults=n}),nn=function(){function e(t,n){C(this,e),this.updateTime=t,this.exists=n}return M(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function rn(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var an=M(function e(){C(this,e)});function on(e,t,n){e instanceof fn?function(e,t,n){var r=e.value.clone(),i=vn(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof hn?function(e,t,n){if(rn(e.precondition,t)){var r=vn(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(dn(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function un(e,t,n){e instanceof fn?function(e,t,n){if(rn(e.precondition,t)){var r=e.value.clone(),i=pn(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(ln(t),r).setHasLocalMutations()}}(e,t,n):e instanceof hn?function(e,t,n){if(rn(e.precondition,t)){var r=pn(e.fieldTransforms,n,t),i=t.data;i.setAll(dn(e)),i.setAll(r),t.convertToFoundDocument(ln(t),i).setHasLocalMutations()}}(e,t,n):function(e,t){rn(e.precondition,t)&&t.convertToNoDocument(ve.min())}(e,t)}function sn(e,t){var n,r=null,i=d(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),u=Gt(a.transform,o||null);null!=u&&(null==r&&(r=Je.empty()),r.set(a.field,u))}}catch(s){i.e(s)}finally{i.f()}return r||null}function cn(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&fe(e,t,function(e,t){return en(e,t)})}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function ln(e){return e.isFoundDocument()?e.version:ve.min()}var fn=function(e){y(n,an);var t=m(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return C(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return M(n)}(),hn=function(e){y(n,an);var t=m(n);function n(e,r,i,a){var o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return C(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=u,o.type=1,o}return M(n)}();function dn(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function vn(e,t,n){var r=new Map;Q(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,jt(o,u,n[i]))}return r}function pn(e,t,n){var r,i=new Map,a=d(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=o.transform,s=n.data.field(o.field);i.set(o.field,Kt(u,s,t))}}catch(c){a.e(c)}finally{a.f()}return i}var yn,mn,gn=function(e){y(n,an);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return M(n)}(),kn=function(e){y(n,an);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return M(n)}(),wn=M(function e(t){C(this,e),this.count=t});function bn(e){switch(e){default:return z();case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0}}function xn(e){if(void 0===e)return K("GRPC error has no .code"),Y.UNKNOWN;switch(e){case yn.OK:return Y.OK;case yn.CANCELLED:return Y.CANCELLED;case yn.UNKNOWN:return Y.UNKNOWN;case yn.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case yn.INTERNAL:return Y.INTERNAL;case yn.UNAVAILABLE:return Y.UNAVAILABLE;case yn.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case yn.NOT_FOUND:return Y.NOT_FOUND;case yn.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case yn.ABORTED:return Y.ABORTED;case yn.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case yn.DATA_LOSS:return Y.DATA_LOSS;default:return z()}}(mn=yn||(yn={}))[mn.OK=0]="OK",mn[mn.CANCELLED=1]="CANCELLED",mn[mn.UNKNOWN=2]="UNKNOWN",mn[mn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mn[mn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mn[mn.NOT_FOUND=5]="NOT_FOUND",mn[mn.ALREADY_EXISTS=6]="ALREADY_EXISTS",mn[mn.PERMISSION_DENIED=7]="PERMISSION_DENIED",mn[mn.UNAUTHENTICATED=16]="UNAUTHENTICATED",mn[mn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mn[mn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mn[mn.ABORTED=10]="ABORTED",mn[mn.OUT_OF_RANGE=11]="OUT_OF_RANGE",mn[mn.UNIMPLEMENTED=12]="UNIMPLEMENTED",mn[mn.INTERNAL=13]="INTERNAL",mn[mn.UNAVAILABLE=14]="UNAVAILABLE",mn[mn.DATA_LOSS=15]="DATA_LOSS";var In=function(){function e(t,n){C(this,e),this.comparator=t,this.root=n||En.EMPTY}return M(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,En.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,En.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Tn(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Tn(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Tn(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Tn(this.root,e,this.comparator,!0)}}]),e}(),Tn=function(){function e(t,n,r,i){C(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return M(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),En=function(){function e(t,n,r,i,a){C(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return M(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw z();if(this.right.isRed())throw z();var e=this.left.check();if(e!==this.right.check())throw z();return e+(this.isRed()?0:1)}}]),e}();En.EMPTY=null,En.RED=!0,En.BLACK=!1,En.EMPTY=new(function(){function e(){C(this,e),this.size=0}return M(e,[{key:"key",get:function(){throw z()}},{key:"value",get:function(){throw z()}},{key:"color",get:function(){throw z()}},{key:"left",get:function(){throw z()}},{key:"right",get:function(){throw z()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new En(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var Sn=function(){function e(t){C(this,e),this.comparator=t,this.data=new In(this.comparator)}return M(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Rn(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Rn(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),Rn=function(){function e(t){C(this,e),this.iter=t}return M(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),_n=new In(Fe.comparator);function An(){return _n}var Dn=new In(Fe.comparator);function Nn(){return Dn}var Cn=new In(Fe.comparator);function Ln(){return Cn}var Mn=new Sn(Fe.comparator);function Fn(){for(var e=Mn,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var On=new Sn(le);function Pn(){return On}var Vn=function(){function e(t,n,r,i,a){C(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return M(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,qn.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(ve.min(),r,Pn(),An(),Fn())}}]),e}(),qn=function(){function e(t,n,r,i,a){C(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return M(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(Te.EMPTY_BYTE_STRING,n,Fn(),Fn(),Fn())}}]),e}(),Un=M(function e(t,n,r,i){C(this,e),this.$=t,this.removedTargetIds=n,this.key=r,this.F=i}),Bn=M(function e(t,n){C(this,e),this.targetId=t,this.O=n}),Kn=M(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Te.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;C(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),jn=function(){function e(){C(this,e),this.M=0,this.L=Qn(),this.B=Te.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}return M(e,[{key:"current",get:function(){return this.U}},{key:"resumeToken",get:function(){return this.B}},{key:"K",get:function(){return 0!==this.M}},{key:"j",get:function(){return this.q}},{key:"W",value:function(e){e.approximateByteSize()>0&&(this.q=!0,this.B=e)}},{key:"G",value:function(){var e=Fn(),t=Fn(),n=Fn();return this.L.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:z()}}),new qn(this.B,this.U,e,t,n)}},{key:"H",value:function(){this.q=!1,this.L=Qn()}},{key:"J",value:function(e,t){this.q=!0,this.L=this.L.insert(e,t)}},{key:"Y",value:function(e){this.q=!0,this.L=this.L.remove(e)}},{key:"X",value:function(){this.M+=1}},{key:"Z",value:function(){this.M-=1}},{key:"tt",value:function(){this.q=!0,this.U=!0}}]),e}(),Gn=function(){function e(t){C(this,e),this.et=t,this.nt=new Map,this.st=An(),this.it=zn(),this.rt=new Sn(le)}return M(e,[{key:"ot",value:function(e){var t,n=d(e.$);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.F&&e.F.isFoundDocument()?this.at(r,e.F):this.ct(r,e.key,e.F)}}catch(u){n.e(u)}finally{n.f()}var i,a=d(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.ct(o,e.key,e.F)}}catch(u){a.e(u)}finally{a.f()}}},{key:"ut",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.ht(n);switch(e.state){case 0:t.lt(n)&&r.W(e.resumeToken);break;case 1:r.Z(),r.K||r.H(),r.W(e.resumeToken);break;case 2:r.Z(),r.K||t.removeTarget(n);break;case 3:t.lt(n)&&(r.tt(),r.W(e.resumeToken));break;case 4:t.lt(n)&&(t.ft(n),r.W(e.resumeToken));break;default:z()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.nt.forEach(function(e,r){n.lt(r)&&t(r)})}},{key:"dt",value:function(e){var t=e.targetId,n=e.O.count,r=this.wt(t);if(r){var i=r.target;if(it(i))if(0===n){var a=new Fe(i.path);this.ct(t,a,Ze.newNoDocument(a,ve.min()))}else Q(1===n);else this._t(t)!==n&&(this.ft(t),this.rt=this.rt.add(t))}}},{key:"gt",value:function(e){var t=this,n=new Map;this.nt.forEach(function(r,i){var a=t.wt(i);if(a){if(r.current&&it(a.target)){var o=new Fe(a.target.path);null!==t.st.get(o)||t.yt(i,o)||t.ct(i,o,Ze.newNoDocument(o,e))}r.j&&(n.set(i,r.G()),r.H())}});var r=Fn();this.it.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.wt(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))});var i=new Vn(e,n,this.rt,this.st,r);return this.st=An(),this.it=zn(),this.rt=new Sn(le),i}},{key:"at",value:function(e,t){if(this.lt(e)){var n=this.yt(e,t.key)?2:0;this.ht(e).J(t.key,n),this.st=this.st.insert(t.key,t),this.it=this.it.insert(t.key,this.Tt(t.key).add(e))}}},{key:"ct",value:function(e,t,n){if(this.lt(e)){var r=this.ht(e);this.yt(e,t)?r.J(t,1):r.Y(t),this.it=this.it.insert(t,this.Tt(t).delete(e)),n&&(this.st=this.st.insert(t,n))}}},{key:"removeTarget",value:function(e){this.nt.delete(e)}},{key:"_t",value:function(e){var t=this.ht(e).G();return this.et.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"X",value:function(e){this.ht(e).X()}},{key:"ht",value:function(e){var t=this.nt.get(e);return t||(t=new jn,this.nt.set(e,t)),t}},{key:"Tt",value:function(e){var t=this.it.get(e);return t||(t=new Sn(le),this.it=this.it.insert(e,t)),t}},{key:"lt",value:function(e){var t=null!==this.wt(e);return t||B("WatchChangeAggregator","Detected inactive target",e),t}},{key:"wt",value:function(e){var t=this.nt.get(e);return t&&t.K?null:this.et.Et(e)}},{key:"ft",value:function(e){var t=this;this.nt.set(e,new jn),this.et.getRemoteKeysForTarget(e).forEach(function(n){t.ct(e,n,null)})}},{key:"yt",value:function(e,t){return this.et.getRemoteKeysForTarget(e).has(t)}}]),e}();function zn(){return new In(Fe.comparator)}function Qn(){return new In(Fe.comparator)}var Wn={asc:"ASCENDING",desc:"DESCENDING"},Hn={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yn=M(function e(t,n){C(this,e),this.databaseId=t,this.C=n});function Jn(e,t){return e.C?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Xn(e,t){return e.C?t.toBase64():t.toUint8Array()}function Zn(e,t){return Jn(e,t.toTimestamp())}function $n(e){return Q(!!e),ve.fromTimestamp(function(e){var t=Se(e);return new de(t.seconds,t.nanos)}(e))}function er(e,t){return function(e){return new ke(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function tr(e){var t=ke.fromString(e);return Q(Ar(t)),t}function nr(e,t){return er(e.databaseId,t.path)}function rr(e,t){var n=tr(t);if(n.get(1)!==e.databaseId.projectId)throw new J(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new J(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Fe(ur(n))}function ir(e,t){return er(e.databaseId,t)}function ar(e){var t=tr(e);return 4===t.length?ke.emptyPath():ur(t)}function or(e){return new ke(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ur(e){return Q(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function sr(e,t,n){return{name:nr(e,t),fields:n.value.mapValue.fields}}function cr(e,t,n){var r=rr(e,t.name),i=$n(t.updateTime),a=new Je({mapValue:{fields:t.fields}}),o=Ze.newFoundDocument(r,i,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function lr(e,t){return"found"in t?function(e,t){Q(!!t.found),t.found.name,t.found.updateTime;var n=rr(e,t.found.name),r=$n(t.found.updateTime),i=new Je({mapValue:{fields:t.found.fields}});return Ze.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){Q(!!t.missing),Q(!!t.readTime);var n=rr(e,t.missing),r=$n(t.readTime);return Ze.newNoDocument(n,r)}(e,t):z()}function fr(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:z()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.C?(Q(void 0===t||"string"==typeof t),Te.fromBase64String(t||"")):(Q(void 0===t||t instanceof Uint8Array),Te.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(e){var t=void 0===e.code?Y.UNKNOWN:xn(e.code);return new J(t,e.message||"")}(o);n=new Kn(r,i,a,u||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var c=rr(e,s.document.name),l=$n(s.document.updateTime),f=new Je({mapValue:{fields:s.document.fields}}),h=Ze.newFoundDocument(c,l,f),d=s.targetIds||[],v=s.removedTargetIds||[];n=new Un(d,v,h.key,h)}else if("documentDelete"in t){t.documentDelete;var p=t.documentDelete;p.document;var y=rr(e,p.document),m=p.readTime?$n(p.readTime):ve.min(),g=Ze.newNoDocument(y,m),k=p.removedTargetIds||[];n=new Un([],k,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=rr(e,w.document),x=w.removedTargetIds||[];n=new Un([],x,b,null)}else{if(!("filter"in t))return z();t.filter;var I=t.filter;I.targetId;var T=I.count||0,E=new wn(T),S=I.targetId;n=new Bn(S,E)}return n}function hr(e,t){var n;if(t instanceof fn)n={update:sr(e,t.key,t.value)};else if(t instanceof gn)n={delete:nr(e,t.key)};else if(t instanceof hn)n={update:sr(e,t.key,t.data),updateMask:_r(t.fieldMask)};else{if(!(t instanceof kn))return z();n={verify:nr(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof zt)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Qt)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ht)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Jt)return{fieldPath:t.field.canonicalString(),increment:n.N};throw z()}(0,e)})),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Zn(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:z()}(e,t.precondition)),n}function dr(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?nn.updateTime($n(e.updateTime)):void 0!==e.exists?nn.exists(e.exists):nn.none()}(t.currentDocument):nn.none(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(e,t){var n=null;if("setToServerValue"in t)Q("REQUEST_TIME"===t.setToServerValue),n=new zt;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Qt(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Ht(i)}else"increment"in t?n=new Jt(e,t.increment):z();var a=be.fromServerFormat(t.fieldPath);return new $t(a,n)}(e,t)}):[];if(t.update){t.update.name;var i=rr(e,t.update.name),a=new Je({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new xe(t.map(function(e){return be.fromServerFormat(e)}))}(t.updateMask);return new hn(i,a,o,n,r)}return new fn(i,a,n,r)}if(t.delete){var u=rr(e,t.delete);return new gn(u,n)}if(t.verify){var s=rr(e,t.verify);return new kn(s,n)}return z()}function vr(e,t){return e&&e.length>0?(Q(void 0!==t),e.map(function(e){return function(e,t){var n=e.updateTime?$n(e.updateTime):$n(t);return n.isEqual(ve.min())&&(n=$n(t)),new tn(n,e.transformResults||[])}(e,t)})):[]}function pr(e,t){return{documents:[ir(e,t.path)]}}function yr(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=ir(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=ir(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(We(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NAN"}};if(Qe(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(We(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NOT_NAN"}};if(Qe(e.value))return{unaryFilter:{field:Tr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tr(e.field),op:Ir(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return function(e){return{field:Tr(e.field),direction:xr(e.dir)}}(e)})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o=function(e,t){return e.C||Ce(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=wr(t.startAt)),t.endAt&&(n.structuredQuery.endAt=wr(t.endAt)),n}function mr(e){var t=ar(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Q(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=kr(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(e){return function(e){return new mt(Er(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)}));var s=null;n.limit&&(s=function(e){var t;return Ce(t="object"==h(e)?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=br(n.startAt));var l=null;return n.endAt&&(l=br(n.endAt)),xt(t,i,u,o,s,"F",c,l)}function gr(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return z()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}function kr(e){return e?void 0!==e.unaryFilter?[Rr(e)]:void 0!==e.fieldFilter?[Sr(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return kr(e)}).reduce(function(e,t){return e.concat(t)}):z():[]}function wr(e){return{before:e.before,values:e.position}}function br(e){var t=!!e.before,n=e.values||[];return new pt(n,t)}function xr(e){return Wn[e]}function Ir(e){return Hn[e]}function Tr(e){return{fieldPath:e.canonicalString()}}function Er(e){return be.fromServerFormat(e.fieldPath)}function Sr(e){return at.create(Er(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return z()}}(e.fieldFilter.op),e.fieldFilter.value)}function Rr(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Er(e.unaryFilter.field);return at.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Er(e.unaryFilter.field);return at.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Er(e.unaryFilter.field);return at.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Er(e.unaryFilter.field);return at.create(i,"!=",{nullValue:"NULL_VALUE"});default:return z()}}function _r(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function Ar(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function Dr(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=Cr(t)),t=Nr(e.get(n),t);return Cr(t)}function Nr(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="";break;case"":n+="";break;default:n+=a}}return n}function Cr(e){return e+""}function Lr(e){var t=e.length;if(Q(t>=2),2===t)return Q(""===e.charAt(0)&&""===e.charAt(1)),ke.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("",a);switch((o<0||o>n)&&z(),e.charAt(o+1)){case"":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"":i+=e.substring(a,o),i+="\0";break;case"":i+=e.substring(a,o+1);break;default:z()}a=o+2}return new ke(r)}var Mr=M(function e(t,n){C(this,e),this.seconds=t,this.nanoseconds=n}),Fr=M(function e(t,n,r){C(this,e),this.ownerId=t,this.allowTabSynchronization=n,this.leaseTimestampMs=r});Fr.store="owner",Fr.key="owner";var Or=M(function e(t,n,r){C(this,e),this.userId=t,this.lastAcknowledgedBatchId=n,this.lastStreamToken=r});Or.store="mutationQueues",Or.keyPath="userId";var Pr=M(function e(t,n,r,i,a){C(this,e),this.userId=t,this.batchId=n,this.localWriteTimeMs=r,this.baseMutations=i,this.mutations=a});Pr.store="mutations",Pr.keyPath="batchId",Pr.userMutationsIndex="userMutationsIndex",Pr.userMutationsKeyPath=["userId","batchId"];var Vr=function(){function e(){C(this,e)}return M(e,null,[{key:"prefixForUser",value:function(e){return[e]}},{key:"prefixForPath",value:function(e,t){return[e,Dr(t)]}},{key:"key",value:function(e,t,n){return[e,Dr(t),n]}}]),e}();Vr.store="documentMutations",Vr.PLACEHOLDER=new Vr;var qr=M(function e(t,n){C(this,e),this.path=t,this.readTime=n}),Ur=M(function e(t,n){C(this,e),this.path=t,this.version=n}),Br=M(function e(t,n,r,i,a,o){C(this,e),this.unknownDocument=t,this.noDocument=n,this.document=r,this.hasCommittedMutations=i,this.readTime=a,this.parentPath=o});Br.store="remoteDocuments",Br.readTimeIndex="readTimeIndex",Br.readTimeIndexPath="readTime",Br.collectionReadTimeIndex="collectionReadTimeIndex",Br.collectionReadTimeIndexPath=["parentPath","readTime"];var Kr=M(function e(t){C(this,e),this.byteSize=t});Kr.store="remoteDocumentGlobal",Kr.key="remoteDocumentGlobalKey";var jr=M(function e(t,n,r,i,a,o,u){C(this,e),this.targetId=t,this.canonicalId=n,this.readTime=r,this.resumeToken=i,this.lastListenSequenceNumber=a,this.lastLimboFreeSnapshotVersion=o,this.query=u});jr.store="targets",jr.keyPath="targetId",jr.queryTargetsIndexName="queryTargetsIndex",jr.queryTargetsKeyPath=["canonicalId","targetId"];var Gr=M(function e(t,n,r){C(this,e),this.targetId=t,this.path=n,this.sequenceNumber=r});Gr.store="targetDocuments",Gr.keyPath=["targetId","path"],Gr.documentTargetsIndex="documentTargetsIndex",Gr.documentTargetsKeyPath=["path","targetId"];var zr=M(function e(t,n,r,i){C(this,e),this.highestTargetId=t,this.highestListenSequenceNumber=n,this.lastRemoteSnapshotVersion=r,this.targetCount=i});zr.key="targetGlobalKey",zr.store="targetGlobal";var Qr=M(function e(t,n){C(this,e),this.collectionId=t,this.parent=n});Qr.store="collectionParents",Qr.keyPath=["collectionId","parent"];var Wr=M(function e(t,n,r,i){C(this,e),this.clientId=t,this.updateTimeMs=n,this.networkEnabled=r,this.inForeground=i});Wr.store="clientMetadata",Wr.keyPath="clientId";var Hr=M(function e(t,n,r){C(this,e),this.bundleId=t,this.createTime=n,this.version=r});Hr.store="bundles",Hr.keyPath="bundleId";var Yr=M(function e(t,n,r){C(this,e),this.name=t,this.readTime=n,this.bundledQuery=r});Yr.store="namedQueries",Yr.keyPath="name";var Jr=[Or.store,Pr.store,Vr.store,Br.store,jr.store,Fr.store,zr.store,Gr.store].concat([Wr.store]).concat([Kr.store]).concat([Qr.store]).concat([Hr.store,Yr.store]),Xr="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Zr=function(){function e(){C(this,e),this.onCommittedListeners=[]}return M(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}(),$r=function(){function e(t){var n=this;C(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return M(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=d(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}}]),e}(),ei=function(){function e(t,n){var r=this;C(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.It=new X,this.transaction.oncomplete=function(){r.It.resolve()},this.transaction.onabort=function(){n.error?r.It.reject(new ri(t,n.error)):r.It.resolve()},this.transaction.onerror=function(e){var n=si(e.target.error);r.It.reject(new ri(t,n))}}return M(e,[{key:"At",get:function(){return this.It.promise}},{key:"abort",value:function(e){e&&this.It.reject(e),this.aborted||(B("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new ai(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new ri(n,t)}}}]),e}(),ti=function(){function t(e,n,r){C(this,t),this.name=e,this.version=n,this.Rt=r,12.2===t.Pt((0,i.getUA)())&&K("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return M(t,[{key:"Ct",value:function(){var e=p(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return B("SimpleDb","Opening database:",this.name),e.next=5,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ri(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new J(Y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new J(Y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new ri(t,n))},i.onupgradeneeded=function(e){B("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.Rt.Nt(t,i.transaction,e.oldVersion,n.version).next(function(){B("SimpleDb","Database upgrade to version "+n.version+" complete")})}});case 5:this.db=e.sent;case 6:return this.kt&&(this.db.onversionchange=function(e){return n.kt(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"xt",value:function(e){this.kt=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=p(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,u,s,c=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,o=0;case 2:return++o,e.prev=3,e.delegateYield(regeneratorRuntime.mark(function e(){var n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.Ct(t);case 2:return c.db=e.sent,n=ei.open(c.db,t,a?"readonly":"readwrite",r),(o=i(n).catch(function(e){return n.abort(e),$r.reject(e)}).toPromise()).catch(function(){}),e.next=7,n.At;case 7:return e.t0=o,e.abrupt("return",{v:e.t0});case 9:case"end":return e.stop()}},e)})(),"t0",5);case 5:if("object"!==h(u=e.t0)){e.next=8;break}return e.abrupt("return",u.v);case 8:e.next=15;break;case 10:if(e.prev=10,e.t1=e.catch(3),s="FirebaseError"!==e.t1.name&&o<3,B("SimpleDb","Transaction failed with error:",e.t1.message,"Retrying:",s),this.close(),s){e.next=15;break}return e.abrupt("return",Promise.reject(e.t1));case 15:e.next=2;break;case 17:case"end":return e.stop()}},e,this,[[3,10]])}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return B("SimpleDb","Removing database:",e),oi(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"bt",value:function(){if(!(0,i.isIndexedDBAvailable)())return!1;if(t.vt())return!0;var e=(0,i.getUA)(),n=t.Pt(e),r=0<n&&n<10,a=t.Vt(e),o=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}},{key:"vt",value:function(){var t;return void 0!==e&&"YES"===(null===(t=e.env)||void 0===t?void 0:t.St)}},{key:"Dt",value:function(e,t){return e.store(t)}},{key:"Pt",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"Vt",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),t}(),ni=function(){function e(t){C(this,e),this.$t=t,this.Ft=!1,this.Ot=null}return M(e,[{key:"isDone",get:function(){return this.Ft}},{key:"Mt",get:function(){return this.Ot}},{key:"cursor",set:function(e){this.$t=e}},{key:"done",value:function(){this.Ft=!0}},{key:"Lt",value:function(e){this.Ot=e}},{key:"delete",value:function(){return oi(this.$t.delete())}}]),e}(),ri=function(e){y(n,J);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,Y.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return M(n)}();function ii(e){return"IndexedDbTransactionError"===e.name}var ai=function(){function e(t){C(this,e),this.store=t}return M(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(B("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(B("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),oi(n)}},{key:"add",value:function(e){return B("SimpleDb","ADD",this.store.name,e,e),oi(this.store.add(e))}},{key:"get",value:function(e){var t=this;return oi(this.store.get(e)).next(function(n){return void 0===n&&(n=null),B("SimpleDb","GET",t.store.name,e,n),n})}},{key:"delete",value:function(e){return B("SimpleDb","DELETE",this.store.name,e),oi(this.store.delete(e))}},{key:"count",value:function(){return B("SimpleDb","COUNT",this.store.name),oi(this.store.count())}},{key:"Bt",value:function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.Ut(n,function(e,t){r.push(t)}).next(function(){return r})}},{key:"qt",value:function(e,t){B("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.Kt=!1;var r=this.cursor(n);return this.Ut(r,function(e,t,n){return n.delete()})}},{key:"jt",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.Ut(r,t)}},{key:"Qt",value:function(e){var t=this.cursor({});return new $r(function(n,r){t.onerror=function(e){var t=si(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next(function(e){e?r.continue():n()}):n()}})}},{key:"Ut",value:function(e,t){var n=[];return new $r(function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new ni(i),o=t(i.primaryKey,i.value,a);if(o instanceof $r){var u=o.catch(function(e){return a.done(),$r.reject(e)});n.push(u)}a.isDone?r():null===a.Mt?i.continue():i.continue(a.Mt)}else r()}}).next(function(){return $r.waitFor(n)})}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.Kt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function oi(e){return new $r(function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=si(e.target.error);n(t)}})}var ui=!1;function si(e){var t=ti.Pt((0,i.getUA)());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new J("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return ui||(ui=!0,setTimeout(function(){throw r},0)),r}}return e}var ci=function(e){y(n,Zr);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this)).Wt=e,i.currentSequenceNumber=r,i}return M(n)}();function li(e,t){var n=H(e);return ti.Dt(n.Wt,t)}var fi=function(){function e(t,n,r,i){C(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return M(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&on(i,e,n[r])}}},{key:"applyToLocalView",value:function(e){var t,n=d(this.baseMutations);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.key.isEqual(e.key)&&un(r,e,this.localWriteTime)}}catch(u){n.e(u)}finally{n.f()}var i,a=d(this.mutations);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.key.isEqual(e.key)&&un(o,e,this.localWriteTime)}}catch(u){a.e(u)}finally{a.f()}}},{key:"applyToLocalDocumentSet",value:function(e){var t=this;this.mutations.forEach(function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(ve.min())})}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},Fn())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&fe(this.mutations,e.mutations,function(e,t){return cn(e,t)})&&fe(this.baseMutations,e.baseMutations,function(e,t){return cn(e,t)})}}]),e}(),hi=function(){function e(t,n,r,i){C(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return M(e,null,[{key:"from",value:function(t,n,r){Q(t.mutations.length===r.length);for(var i=Ln(),a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),di=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ve.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ve.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Te.EMPTY_BYTE_STRING;C(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return M(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),vi=M(function e(t){C(this,e),this.Gt=t});function pi(e,t){if(t.document)return cr(e.Gt,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=Fe.fromSegments(t.noDocument.path),r=wi(t.noDocument.readTime),i=Ze.newNoDocument(n,r);return t.hasCommittedMutations?i.setHasCommittedMutations():i}if(t.unknownDocument){var a=Fe.fromSegments(t.unknownDocument.path),o=wi(t.unknownDocument.version);return Ze.newUnknownDocument(a,o)}return z()}function yi(e,t,n){var r=mi(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){var a=function(e,t){return{name:nr(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Jn(e,t.version.toTimestamp())}}(e.Gt,t),o=t.hasCommittedMutations;return new Br(null,null,a,o,r,i)}if(t.isNoDocument()){var u=t.key.path.toArray(),s=ki(t.version),c=t.hasCommittedMutations;return new Br(null,new qr(u,s),null,c,r,i)}if(t.isUnknownDocument()){var l=t.key.path.toArray(),f=ki(t.version);return new Br(new Ur(l,f),null,null,!0,r,i)}return z()}function mi(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function gi(e){var t=new de(e[0],e[1]);return ve.fromTimestamp(t)}function ki(e){var t=e.toTimestamp();return new Mr(t.seconds,t.nanoseconds)}function wi(e){var t=new de(e.seconds,e.nanoseconds);return ve.fromTimestamp(t)}function bi(e,t){for(var n=(t.baseMutations||[]).map(function(t){return dr(e.Gt,t)}),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map(function(t){return dr(e.Gt,t)}),u=de.fromMillis(t.localWriteTimeMs);return new fi(t.batchId,u,n,o)}function xi(e){var t,n,r=wi(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?wi(e.lastLimboFreeSnapshotVersion):ve.min();return void 0!==e.query.documents?(Q(1===(n=e.query).documents.length),t=Dt(It(ar(n.documents[0])))):t=function(e){return Dt(mr(e))}(e.query),new di(t,e.targetId,0,e.lastListenSequenceNumber,r,i,Te.fromBase64String(e.resumeToken))}function Ii(e,t){var n,r=ki(t.snapshotVersion),i=ki(t.lastLimboFreeSnapshotVersion);n=it(t.target)?pr(e.Gt,t.target):yr(e.Gt,t.target);var a=t.resumeToken.toBase64();return new jr(t.targetId,tt(t.target),r,a,t.sequenceNumber,i,n)}function Ti(e){var t=mr({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Nt(t,t.limit,"L"):t}var Ei=function(){function e(){C(this,e)}return M(e,[{key:"getBundleMetadata",value:function(e,t){return Si(e).get(t).next(function(e){if(e)return{id:(t=e).bundleId,createTime:wi(t.createTime),version:t.version};var t})}},{key:"saveBundleMetadata",value:function(e,t){return Si(e).put({bundleId:(n=t).id,createTime:ki($n(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return Ri(e).get(t).next(function(e){if(e)return{name:(t=e).name,query:Ti(t.bundledQuery),readTime:wi(t.readTime)};var t})}},{key:"saveNamedQuery",value:function(e,t){return Ri(e).put(function(e){return{name:e.name,readTime:ki($n(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function Si(e){return li(e,Hr.store)}function Ri(e){return li(e,Yr.store)}var _i=function(){function e(){C(this,e),this.zt=new Ai}return M(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.zt.add(t),$r.resolve()}},{key:"getCollectionParents",value:function(e,t){return $r.resolve(this.zt.getEntries(t))}}]),e}(),Ai=function(){function e(){C(this,e),this.index={}}return M(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Sn(ke.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Sn(ke.comparator)).toArray()}}]),e}(),Di=function(){function e(){C(this,e),this.Ht=new Ai}return M(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.Ht.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(function(){n.Ht.add(t)});var a={collectionId:r,parent:Dr(i)};return Ni(e).put(a)}return $r.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[he(t),""],!1,!0);return Ni(e).Bt(r).next(function(e){var r,i=d(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(Lr(a.parent))}}catch(o){i.e(o)}finally{i.f()}return n})}}]),e}();function Ni(e){return li(e,Qr.store)}var Ci={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Li=function(){function e(t,n,r){C(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return M(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function Mi(e,t,n){var r=e.store(Pr.store),i=e.store(Vr.store),a=[],o=IDBKeyRange.only(n.batchId),u=0,s=r.jt({range:o},function(e,t,n){return u++,n.delete()});a.push(s.next(function(){Q(1===u)}));var c,l=[],f=d(n.mutations);try{for(f.s();!(c=f.n()).done;){var h=c.value,v=Vr.key(t,h.key.path,n.batchId);a.push(i.delete(v)),l.push(h.key)}}catch(p){f.e(p)}finally{f.f()}return $r.waitFor(a).next(function(){return l})}function Fi(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw z();t=e.noDocument}return JSON.stringify(t).length}Li.DEFAULT_COLLECTION_PERCENTILE=10,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Li.DEFAULT=new Li(41943040,Li.DEFAULT_COLLECTION_PERCENTILE,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Li.DISABLED=new Li(-1,0,0);var Oi=function(){function e(t,n,r,i){C(this,e),this.userId=t,this.k=n,this.Jt=r,this.referenceDelegate=i,this.Yt={}}return M(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).jt({index:Pr.userMutationsIndex,range:n},function(e,n,r){t=!1,r.done()}).next(function(){return t})}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=qi(e),o=Vi(e);return o.add({}).next(function(u){Q("number"==typeof u);var s,c=new fi(u,t,n,r),l=function(e,t,n){var r=n.baseMutations.map(function(t){return hr(e.Gt,t)}),i=n.mutations.map(function(t){return hr(e.Gt,t)});return new Pr(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.k,i.userId,c),f=[],h=new Sn(function(e,t){return le(e.canonicalString(),t.canonicalString())}),v=d(r);try{for(v.s();!(s=v.n()).done;){var p=s.value,y=Vr.key(i.userId,p.key.path,u);h=h.add(p.key.path.popLast()),f.push(o.put(l)),f.push(a.put(y,Vr.PLACEHOLDER))}}catch(m){v.e(m)}finally{v.f()}return h.forEach(function(t){f.push(i.Jt.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(function(){i.Yt[u]=c.keys()}),$r.waitFor(f).next(function(){return c})})}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return Vi(e).get(t).next(function(e){return e?(Q(e.userId===n.userId),bi(n.k,e)):null})}},{key:"Zt",value:function(e,t){var n=this;return this.Yt[t]?$r.resolve(this.Yt[t]):this.lookupMutationBatch(e,t).next(function(e){if(e){var r=e.keys();return n.Yt[t]=r,r}return null})}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return Vi(e).jt({index:Pr.userMutationsIndex,range:i},function(e,t,i){t.userId===n.userId&&(Q(t.batchId>=r),a=bi(n.k,t)),i.done()}).next(function(){return a})}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Vi(e).jt({index:Pr.userMutationsIndex,range:t,reverse:!0},function(e,t,r){n=t.batchId,r.done()}).next(function(){return n})}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).Bt(Pr.userMutationsIndex,n).next(function(e){return e.map(function(e){return bi(t.k,e)})})}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=Vr.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return qi(e).jt({range:i},function(r,i,o){var u=s(r,3),c=u[0],l=u[1],f=u[2],h=Lr(l);if(c===n.userId&&t.path.isEqual(h))return Vi(e).get(f).next(function(e){if(!e)throw z();Q(e.userId===n.userId),a.push(bi(n.k,e))});o.done()}).next(function(){return a})}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Sn(le),i=[];return t.forEach(function(t){var a=Vr.prefixForPath(n.userId,t.path),o=IDBKeyRange.lowerBound(a),u=qi(e).jt({range:o},function(e,i,a){var o=s(e,3),u=o[0],c=o[1],l=o[2],f=Lr(c);u===n.userId&&t.path.isEqual(f)?r=r.add(l):a.done()});i.push(u)}),$r.waitFor(i).next(function(){return n.te(e,r)})}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=Vr.prefixForPath(this.userId,r),o=IDBKeyRange.lowerBound(a),u=new Sn(le);return qi(e).jt({range:o},function(e,t,a){var o=s(e,3),c=o[0],l=o[1],f=o[2],h=Lr(l);c===n.userId&&r.isPrefixOf(h)?h.length===i&&(u=u.add(f)):a.done()}).next(function(){return n.te(e,u)})}},{key:"te",value:function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Vi(e).get(t).next(function(e){if(null===e)throw z();Q(e.userId===n.userId),r.push(bi(n.k,e))}))}),$r.waitFor(i).next(function(){return r})}},{key:"removeMutationBatch",value:function(e,t){var n=this;return Mi(e.Wt,this.userId,t).next(function(r){return e.addOnCommittedListener(function(){n.ee(t.batchId)}),$r.forEach(r,function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)})})}},{key:"ee",value:function(e){delete this.Yt[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next(function(n){if(!n)return $r.resolve();var r=IDBKeyRange.lowerBound(Vr.prefixForUser(t.userId)),i=[];return qi(e).jt({range:r},function(e,n,r){if(e[0]===t.userId){var a=Lr(e[1]);i.push(a)}else r.done()}).next(function(){Q(0===i.length)})})}},{key:"containsKey",value:function(e,t){return Pi(e,this.userId,t)}},{key:"ne",value:function(e){var t=this;return Ui(e).get(this.userId).next(function(e){return e||new Or(t.userId,-1,"")})}}],[{key:"Xt",value:function(t,n,r,i){return Q(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function Pi(e,t,n){var r=Vr.prefixForPath(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return qi(e).jt({range:a,Kt:!0},function(e,n,r){var a=s(e,3),u=a[0],c=a[1];a[2];u===t&&c===i&&(o=!0),r.done()}).next(function(){return o})}function Vi(e){return li(e,Pr.store)}function qi(e){return li(e,Vr.store)}function Ui(e){return li(e,Or.store)}var Bi=function(){function e(t){C(this,e),this.se=t}return M(e,[{key:"next",value:function(){return this.se+=2,this.se}}],[{key:"ie",value:function(){return new e(0)}},{key:"re",value:function(){return new e(-1)}}]),e}(),Ki=function(){function e(t,n){C(this,e),this.referenceDelegate=t,this.k=n}return M(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.oe(e).next(function(n){var r=new Bi(n.highestTargetId);return n.highestTargetId=r.next(),t.ae(e,n).next(function(){return n.highestTargetId})})}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.oe(e).next(function(e){return ve.fromTimestamp(new de(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))})}},{key:"getHighestSequenceNumber",value:function(e){return this.oe(e).next(function(e){return e.highestListenSequenceNumber})}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.oe(e).next(function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.ae(e,i)})}},{key:"addTargetData",value:function(e,t){var n=this;return this.ce(e,t).next(function(){return n.oe(e).next(function(r){return r.targetCount+=1,n.ue(t,r),n.ae(e,r)})})}},{key:"updateTargetData",value:function(e,t){return this.ce(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return ji(e).delete(t.targetId)}).next(function(){return n.oe(e)}).next(function(t){return Q(t.targetCount>0),t.targetCount-=1,n.ae(e,t)})}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return ji(e).jt(function(o,u){var s=xi(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))}).next(function(){return $r.waitFor(a)}).next(function(){return i})}},{key:"forEachTarget",value:function(e,t){return ji(e).jt(function(e,n){var r=xi(n);t(r)})}},{key:"oe",value:function(e){return Gi(e).get(zr.key).next(function(e){return Q(null!==e),e})}},{key:"ae",value:function(e,t){return Gi(e).put(zr.key,t)}},{key:"ce",value:function(e,t){return ji(e).put(Ii(this.k,t))}},{key:"ue",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.oe(e).next(function(e){return e.targetCount})}},{key:"getTargetData",value:function(e,t){var n=tt(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return ji(e).jt({range:r,index:jr.queryTargetsIndexName},function(e,n,r){var a=xi(n);rt(t,a.target)&&(i=a,r.done())}).next(function(){return i})}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=zi(e);return t.forEach(function(t){var o=Dr(t.path);i.push(a.put(new Gr(n,o))),i.push(r.referenceDelegate.addReference(e,n,t))}),$r.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=zi(e);return $r.forEach(t,function(t){var a=Dr(t.path);return $r.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])})}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=zi(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=zi(e),i=Fn();return r.jt({range:n,Kt:!0},function(e,t,n){var r=Lr(e[1]),a=new Fe(r);i=i.add(a)}).next(function(){return i})}},{key:"containsKey",value:function(e,t){var n=Dr(t.path),r=IDBKeyRange.bound([n],[he(n)],!1,!0),i=0;return zi(e).jt({index:Gr.documentTargetsIndex,Kt:!0,range:r},function(e,t,n){var r=s(e,2),a=r[0];r[1];0!==a&&(i++,n.done())}).next(function(){return i>0})}},{key:"Et",value:function(e,t){return ji(e).get(t).next(function(e){return e?xi(e):null})}}]),e}();function ji(e){return li(e,jr.store)}function Gi(e){return li(e,zr.store)}function zi(e){return li(e,Gr.store)}function Qi(e){return Wi.apply(this,arguments)}function Wi(){return(Wi=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Y.FAILED_PRECONDITION&&t.message===Xr){e.next=2;break}throw t;case 2:B("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Hi(e,t){var n=s(e,2),r=n[0],i=n[1],a=s(t,2),o=a[0],u=a[1],c=le(r,o);return 0===c?le(i,u):c}var Yi=function(){function e(t){C(this,e),this.he=t,this.buffer=new Sn(Hi),this.le=0}return M(e,[{key:"fe",value:function(){return++this.le}},{key:"de",value:function(e){var t=[e,this.fe()];if(this.buffer.size<this.he)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Hi(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),Ji=function(){function e(t,n){C(this,e),this.garbageCollector=t,this.asyncQueue=n,this.we=!1,this._e=null}return M(e,[{key:"start",value:function(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.me(e)}},{key:"stop",value:function(){this._e&&(this._e.cancel(),this._e=null)}},{key:"started",get:function(){return null!==this._e}},{key:"me",value:function(e){var t=this,n=this.we?3e5:6e4;B("LruGarbageCollector","Garbage collection scheduled in ".concat(n,"ms")),this._e=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,p(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t._e=null,t.we=!0,n.prev=1,n.next=4,e.collectGarbage(t.garbageCollector);case 4:n.next=14;break;case 6:if(n.prev=6,n.t0=n.catch(1),!ii(n.t0)){n.next=12;break}B("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n.t0),n.next=14;break;case 12:return n.next=14,Qi(n.t0);case 14:return n.next=16,t.me(e);case 16:case"end":return n.stop()}},n,null,[[1,6]])})))}}]),e}(),Xi=function(){function e(t,n){C(this,e),this.ge=t,this.params=n}return M(e,[{key:"calculateTargetCount",value:function(e,t){return this.ge.ye(e).next(function(e){return Math.floor(t/100*e)})}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return $r.resolve(ue.I);var r=new Yi(t);return this.ge.forEachTarget(e,function(e){return r.de(e.sequenceNumber)}).next(function(){return n.ge.pe(e,function(e){return r.de(e)})}).next(function(){return r.maxValue})}},{key:"removeTargets",value:function(e,t,n){return this.ge.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.ge.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector","Garbage collection skipped; disabled"),$r.resolve(Ci)):this.getCacheSize(e).next(function(r){return r<n.params.cacheSizeCollectionThreshold?(B("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),Ci):n.Te(e,t)})}},{key:"getCacheSize",value:function(e){return this.ge.getCacheSize(e)}},{key:"Te",value:function(e,t){var n,i,a,o,u,s,c,l=this,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return t>l.params.maximumSequenceNumbersToCollect?(B("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(l.params.maximumSequenceNumbersToCollect," from ").concat(t)),i=l.params.maximumSequenceNumbersToCollect):i=t,o=Date.now(),l.nthSequenceNumber(e,i)}).next(function(r){return n=r,u=Date.now(),l.removeTargets(e,n,t)}).next(function(t){return a=t,s=Date.now(),l.removeOrphanedDocuments(e,n)}).next(function(e){return c=Date.now(),q()<=r.LogLevel.DEBUG&&B("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(o-f,"ms\n\tDetermined least recently used ").concat(i," in ")+(u-o)+"ms\n"+"\tRemoved ".concat(a," targets in ")+(s-u)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-s)+"ms\n"+"Total Duration: ".concat(c-f,"ms")),$r.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:e})})}}]),e}(),Zi=function(){function e(t,n){C(this,e),this.db=t,this.garbageCollector=function(e,t){return new Xi(e,t)}(this,n)}return M(e,[{key:"ye",value:function(e){var t=this.Ee(e);return this.db.getTargetCache().getTargetCount(e).next(function(e){return t.next(function(t){return e+t})})}},{key:"Ee",value:function(e){var t=0;return this.pe(e,function(e){t++}).next(function(){return t})}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"pe",value:function(e,t){return this.Ie(e,function(e,n){return t(n)})}},{key:"addReference",value:function(e,t,n){return $i(e,n)}},{key:"removeReference",value:function(e,t,n){return $i(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return $i(e,t)}},{key:"Ae",value:function(e,t){return function(e,t){var n=!1;return Ui(e).Qt(function(r){return Pi(e,r,t).next(function(e){return e&&(n=!0),$r.resolve(!e)})}).next(function(){return n})}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Ie(e,function(o,u){if(u<=t){var s=n.Ae(e,o).next(function(t){if(!t)return a++,r.getEntry(e,o).next(function(){return r.removeEntry(o),zi(e).delete([0,Dr(o.path)])})});i.push(s)}}).next(function(){return $r.waitFor(i)}).next(function(){return r.apply(e)}).next(function(){return a})}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return $i(e,t)}},{key:"Ie",value:function(e,t){var n,r=zi(e),i=ue.I;return r.jt({index:Gr.documentTargetsIndex},function(e,r){var a=s(e,2),o=a[0],u=(a[1],r.path),c=r.sequenceNumber;0===o?(i!==ue.I&&t(new Fe(Lr(n)),i),i=c,n=u):i=ue.I}).next(function(){i!==ue.I&&t(new Fe(Lr(n)),i)})}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function $i(e,t){return zi(e).put(function(e,t){return new Gr(0,Dr(e.path),t)}(t,e.currentSequenceNumber))}var ea=function(){function e(t,n){C(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={}}return M(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=d(n);try{for(i.s();!(r=i.n()).done;){var a=s(r.value,2),o=a[0],u=a[1];if(this.equalsFn(o,e))return u}}catch(c){i.e(c)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}},{key:"forEach",value:function(e){ye(this.inner,function(t,n){var r,i=d(n);try{for(i.s();!(r=i.n()).done;){var a=s(r.value,2),o=a[0],u=a[1];e(o,u)}}catch(c){i.e(c)}finally{i.f()}})}},{key:"isEmpty",value:function(){return me(this.inner)}}]),e}(),ta=function(){function e(){C(this,e),this.changes=new ea(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return M(e,[{key:"getReadTime",value:function(e){var t=this.changes.get(e);return t?t.readTime:ve.min()}},{key:"addEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}},{key:"removeEntry",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.assertNotApplied(),this.changes.set(e,{document:Ze.newInvalidDocument(e),readTime:t})}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?$r.resolve(n.document):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),na=function(){function e(t,n){C(this,e),this.k=t,this.Jt=n}return M(e,[{key:"addEntry",value:function(e,t,n){return aa(e).put(oa(t),n)}},{key:"removeEntry",value:function(e,t){var n=aa(e),r=oa(t);return n.delete(r)}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next(function(r){return r.byteSize+=t,n.Re(e,r)})}},{key:"getEntry",value:function(e,t){var n=this;return aa(e).get(oa(t)).next(function(e){return n.Pe(t,e)})}},{key:"be",value:function(e,t){var n=this;return aa(e).get(oa(t)).next(function(e){return{document:n.Pe(t,e),size:Fi(e)}})}},{key:"getEntries",value:function(e,t){var n=this,r=An();return this.ve(e,t,function(e,t){var i=n.Pe(e,t);r=r.insert(e,i)}).next(function(){return r})}},{key:"Ve",value:function(e,t){var n=this,r=An(),i=new In(Fe.comparator);return this.ve(e,t,function(e,t){var a=n.Pe(e,t);r=r.insert(e,a),i=i.insert(e,Fi(t))}).next(function(){return{documents:r,Se:i}})}},{key:"ve",value:function(e,t,n){if(t.isEmpty())return $r.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),a=i.getNext();return aa(e).jt({range:r},function(e,t,r){for(var o=Fe.fromSegments(e);a&&Fe.comparator(a,o)<0;)n(a,null),a=i.getNext();a&&a.isEqual(o)&&(n(a,t),a=i.hasNext()?i.getNext():null),a?r.Lt(a.path.toArray()):r.done()}).next(function(){for(;a;)n(a,null),a=i.hasNext()?i.getNext():null})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){var r=this,i=An(),a=t.path.length+1,o={};if(n.isEqual(ve.min())){var u=t.path.toArray();o.range=IDBKeyRange.lowerBound(u)}else{var s=t.path.toArray(),c=mi(n);o.range=IDBKeyRange.lowerBound([s,c],!0),o.index=Br.collectionReadTimeIndex}return aa(e).jt(o,function(e,n,o){if(e.length===a){var u=pi(r.k,n);t.path.isPrefixOf(u.key.path)?Ft(t,u)&&(i=i.insert(u.key,u)):o.done()}}).next(function(){return i})}},{key:"newChangeBuffer",value:function(e){return new ra(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next(function(e){return e.byteSize})}},{key:"getMetadata",value:function(e){return ia(e).get(Kr.key).next(function(e){return Q(!!e),e})}},{key:"Re",value:function(e,t){return ia(e).put(Kr.key,t)}},{key:"Pe",value:function(e,t){if(t){var n=pi(this.k,t);if(!n.isNoDocument()||!n.version.isEqual(ve.min()))return n}return Ze.newInvalidDocument(e)}}]),e}(),ra=function(e){y(n,ta);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this)).De=e,i.trackRemovals=r,i.Ce=new ea(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),i}return M(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new Sn(function(e,t){return le(e.canonicalString(),t.canonicalString())});return this.changes.forEach(function(a,o){var u=t.Ce.get(a);if(o.document.isValidDocument()){var s=yi(t.De.k,o.document,t.getReadTime(a));i=i.add(a.path.popLast());var c=Fi(s);r+=c-u,n.push(t.De.addEntry(e,a,s))}else if(r-=u,t.trackRemovals){var l=yi(t.De.k,Ze.newNoDocument(a,ve.min()),t.getReadTime(a));n.push(t.De.addEntry(e,a,l))}else n.push(t.De.removeEntry(e,a))}),i.forEach(function(r){n.push(t.De.Jt.addToCollectionParentIndex(e,r))}),n.push(this.De.updateMetadata(e,r)),$r.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.De.be(e,t).next(function(e){return n.Ce.set(t,e.size),e.document})}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.De.Ve(e,t).next(function(e){var t=e.documents;return e.Se.forEach(function(e,t){n.Ce.set(e,t)}),t})}}]),n}();function ia(e){return li(e,Kr.store)}function aa(e){return li(e,Br.store)}function oa(e){return e.path.toArray()}var ua=function(){function e(t){C(this,e),this.k=t}return M(e,[{key:"Nt",value:function(e,t,n,r){var i=this;Q(n<r&&n>=0&&r<=11);var a=new ei("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Fr.store)}(e),function(e){e.createObjectStore(Or.store,{keyPath:Or.keyPath}),e.createObjectStore(Pr.store,{keyPath:Pr.keyPath,autoIncrement:!0}).createIndex(Pr.userMutationsIndex,Pr.userMutationsKeyPath,{unique:!0}),e.createObjectStore(Vr.store)}(e),sa(e),function(e){e.createObjectStore(Br.store)}(e));var o=$r.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(Gr.store),e.deleteObjectStore(jr.store),e.deleteObjectStore(zr.store)}(e),sa(e)),o=o.next(function(){return e=a.store(zr.store),t=new zr(0,0,ve.min().toTimestamp(),0),e.put(zr.key,t);var e,t})),n<4&&r>=4&&(0!==n&&(o=o.next(function(){return function(e,t){return t.store(Pr.store).Bt().next(function(n){e.deleteObjectStore(Pr.store),e.createObjectStore(Pr.store,{keyPath:Pr.keyPath,autoIncrement:!0}).createIndex(Pr.userMutationsIndex,Pr.userMutationsKeyPath,{unique:!0});var r=t.store(Pr.store),i=n.map(function(e){return r.put(e)});return $r.waitFor(i)})}(e,a)})),o=o.next(function(){!function(e){e.createObjectStore(Wr.store,{keyPath:Wr.keyPath})}(e)})),n<5&&r>=5&&(o=o.next(function(){return i.Ne(a)})),n<6&&r>=6&&(o=o.next(function(){return function(e){e.createObjectStore(Kr.store)}(e),i.ke(a)})),n<7&&r>=7&&(o=o.next(function(){return i.xe(a)})),n<8&&r>=8&&(o=o.next(function(){return i.$e(e,a)})),n<9&&r>=9&&(o=o.next(function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(Br.store);t.createIndex(Br.readTimeIndex,Br.readTimeIndexPath,{unique:!1}),t.createIndex(Br.collectionReadTimeIndex,Br.collectionReadTimeIndexPath,{unique:!1})}(t)})),n<10&&r>=10&&(o=o.next(function(){return i.Fe(a)})),n<11&&r>=11&&(o=o.next(function(){!function(e){e.createObjectStore(Hr.store,{keyPath:Hr.keyPath})}(e),function(e){e.createObjectStore(Yr.store,{keyPath:Yr.keyPath})}(e)})),o}},{key:"ke",value:function(e){var t=0;return e.store(Br.store).jt(function(e,n){t+=Fi(n)}).next(function(){var n=new Kr(t);return e.store(Kr.store).put(Kr.key,n)})}},{key:"Ne",value:function(e){var t=this,n=e.store(Or.store),r=e.store(Pr.store);return n.Bt().next(function(n){return $r.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Bt(Pr.userMutationsIndex,i).next(function(r){return $r.forEach(r,function(r){Q(r.userId===n.userId);var i=bi(t.k,r);return Mi(e,n.userId,i).next(function(){})})})})})}},{key:"xe",value:function(e){var t=e.store(Gr.store),n=e.store(Br.store);return e.store(zr.store).get(zr.key).next(function(e){var r=[];return n.jt(function(n,i){var a=new ke(n),o=[0,Dr(a)];r.push(t.get(o).next(function(n){return n?$r.resolve():function(n){return t.put(new Gr(0,Dr(n),e.highestListenSequenceNumber))}(a)}))}).next(function(){return $r.waitFor(r)})})}},{key:"$e",value:function(e,t){e.createObjectStore(Qr.store,{keyPath:Qr.keyPath});var n=t.store(Qr.store),r=new Ai,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:Dr(i)})}};return t.store(Br.store).jt({Kt:!0},function(e,t){var n=new ke(e);return i(n.popLast())}).next(function(){return t.store(Vr.store).jt({Kt:!0},function(e,t){var n=s(e,3),r=(n[0],n[1]),a=(n[2],Lr(r));return i(a.popLast())})})}},{key:"Fe",value:function(e){var t=this,n=e.store(jr.store);return n.jt(function(e,r){var i=xi(r),a=Ii(t.k,i);return n.put(a)})}}]),e}();function sa(e){e.createObjectStore(Gr.store,{keyPath:Gr.keyPath}).createIndex(Gr.documentTargetsIndex,Gr.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(jr.store,{keyPath:jr.keyPath}).createIndex(jr.queryTargetsIndexName,jr.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(zr.store)}var ca="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",la=function(){function e(t,n,r,i,a,o,u,s,c,l){if(C(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Oe=a,this.window=o,this.document=u,this.Me=c,this.Le=l,this.Be=null,this.Ue=!1,this.isPrimary=!1,this.networkEnabled=!0,this.qe=null,this.inForeground=!1,this.Ke=null,this.je=null,this.Qe=Number.NEGATIVE_INFINITY,this.We=function(e){return Promise.resolve()},!e.bt())throw new J(Y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Zi(this,i),this.Ge=n+"main",this.k=new vi(s),this.ze=new ti(this.Ge,11,new ua(this.k)),this.He=new Ki(this.referenceDelegate,this.k),this.Jt=new Di,this.Je=function(e,t){return new na(e,t)}(this.k,this.Jt),this.Ye=new Ei,this.window&&this.window.localStorage?this.Xe=this.window.localStorage:(this.Xe=null,!1===l&&K("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return M(e,[{key:"start",value:function(){var e=this;return this.Ze().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new J(Y.FAILED_PRECONDITION,ca);return e.tn(),e.en(),e.nn(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.He.getHighestSequenceNumber(t)})}).then(function(t){e.Be=new ue(t,e.Me)}).then(function(){e.Ue=!0}).catch(function(t){return e.ze&&e.ze.close(),Promise.reject(t)})}},{key:"sn",value:function(e){var t=this;return this.We=function(){var n=p(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.ze.xt(function(){var t=p(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Oe.enqueueAndForget(p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.Ze();case 4:case"end":return e.stop()}},e)}))))}},{key:"Ze",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(t){return ha(t).put(new Wr(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next(function(){if(e.isPrimary)return e.rn(t).next(function(t){t||(e.isPrimary=!1,e.Oe.enqueueRetryable(function(){return e.We(!1)}))})}).next(function(){return e.on(t)}).next(function(n){return e.isPrimary&&!n?e.an(t).next(function(){return!1}):!!n&&e.cn(t).next(function(){return!0})})}).catch(function(t){if(ii(t))return B("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return B("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){e.isPrimary!==t&&e.Oe.enqueueRetryable(function(){return e.We(t)}),e.isPrimary=t})}},{key:"rn",value:function(e){var t=this;return fa(e).get(Fr.key).next(function(e){return $r.resolve(t.un(e))})}},{key:"hn",value:function(e){return ha(e).delete(this.clientId)}},{key:"ln",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,n,r,i,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.fn(this.Qe,18e5)){e.next=6;break}return this.Qe=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var t=li(e,Wr.store);return t.Bt().next(function(e){var n=a.dn(e,18e5),r=e.filter(function(e){return-1===n.indexOf(e)});return $r.forEach(r,function(e){return t.delete(e.clientId)}).next(function(){return r})})}).catch(function(){return[]});case 4:if(t=e.sent,this.Xe){n=d(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this.Xe.removeItem(this.wn(i.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"nn",value:function(){var e=this;this.je=this.Oe.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.Ze().then(function(){return e.ln()}).then(function(){return e.nn()})})}},{key:"un",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"on",value:function(e){var t=this;return this.Le?$r.resolve(!0):fa(e).get(Fr.key).next(function(n){if(null!==n&&t.fn(n.leaseTimestampMs,5e3)&&!t._n(n.ownerId)){if(t.un(n)&&t.networkEnabled)return!0;if(!t.un(n)){if(!n.allowTabSynchronization)throw new J(Y.FAILED_PRECONDITION,ca);return!1}}return!(!t.networkEnabled||!t.inForeground)||ha(e).Bt().next(function(e){return void 0===t.dn(e,5e3).find(function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(e){return t.isPrimary!==e&&B("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e})}},{key:"shutdown",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.Ue=!1,this.mn(),this.je&&(this.je.cancel(),this.je=null),this.gn(),this.yn(),e.next=7,this.ze.runTransaction("shutdown","readwrite",[Fr.store,Wr.store],function(e){var n=new ci(e,ue.I);return t.an(n).next(function(){return t.hn(n)})});case 7:this.ze.close(),this.pn();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"dn",value:function(e,t){var n=this;return e.filter(function(e){return n.fn(e.updateTimeMs,t)&&!n._n(e.clientId)})}},{key:"Tn",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return ha(t).Bt().next(function(t){return e.dn(t,18e5).map(function(e){return e.clientId})})})}},{key:"started",get:function(){return this.Ue}},{key:"getMutationQueue",value:function(e){return Oi.Xt(e,this.k,this.Jt,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.He}},{key:"getRemoteDocumentCache",value:function(){return this.Je}},{key:"getIndexManager",value:function(){return this.Jt}},{key:"getBundleCache",value:function(){return this.Ye}},{key:"runTransaction",value:function(e,t,n){var r=this;B("IndexedDbPersistence","Starting transaction:",e);var i,a="readonly"===t?"readonly":"readwrite";return this.ze.runTransaction(e,a,Jr,function(a){return i=new ci(a,r.Be?r.Be.next():ue.I),"readwrite-primary"===t?r.rn(i).next(function(e){return!!e||r.on(i)}).next(function(t){if(!t)throw K("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Oe.enqueueRetryable(function(){return r.We(!1)}),new J(Y.FAILED_PRECONDITION,Xr);return n(i)}).next(function(e){return r.cn(i).next(function(){return e})}):r.En(i).next(function(){return n(i)})}).then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"En",value:function(e){var t=this;return fa(e).get(Fr.key).next(function(e){if(null!==e&&t.fn(e.leaseTimestampMs,5e3)&&!t._n(e.ownerId)&&!t.un(e)&&!(t.Le||t.allowTabSynchronization&&e.allowTabSynchronization))throw new J(Y.FAILED_PRECONDITION,ca)})}},{key:"cn",value:function(e){var t=new Fr(this.clientId,this.allowTabSynchronization,Date.now());return fa(e).put(Fr.key,t)}},{key:"an",value:function(e){var t=this,n=fa(e);return n.get(Fr.key).next(function(e){return t.un(e)?(B("IndexedDbPersistence","Releasing primary lease."),n.delete(Fr.key)):$r.resolve()})}},{key:"fn",value:function(e,t){var n=Date.now();return!(e<n-t||e>n&&(K("Detected an update time that is in the future: ".concat(e," > ").concat(n)),1))}},{key:"tn",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ke=function(){e.Oe.enqueueAndForget(function(){return e.inForeground="visible"===e.document.visibilityState,e.Ze()})},this.document.addEventListener("visibilitychange",this.Ke),this.inForeground="visible"===this.document.visibilityState)}},{key:"gn",value:function(){this.Ke&&(this.document.removeEventListener("visibilitychange",this.Ke),this.Ke=null)}},{key:"en",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.qe=function(){t.mn(),(0,i.isSafari)()&&navigator.appVersion.match(/Version\/1[45]/)&&t.Oe.enterRestrictedMode(!0),t.Oe.enqueueAndForget(function(){return t.shutdown()})},this.window.addEventListener("pagehide",this.qe))}},{key:"yn",value:function(){this.qe&&(this.window.removeEventListener("pagehide",this.qe),this.qe=null)}},{key:"_n",value:function(e){var t;try{var n=null!==(null===(t=this.Xe)||void 0===t?void 0:t.getItem(this.wn(e)));return B("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return K("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"mn",value:function(){if(this.Xe)try{this.Xe.setItem(this.wn(this.clientId),String(Date.now()))}catch(e){K("Failed to set zombie client id.",e)}}},{key:"pn",value:function(){if(this.Xe)try{this.Xe.removeItem(this.wn(this.clientId))}catch(e){}}},{key:"wn",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"bt",value:function(){return ti.bt()}}]),e}();function fa(e){return li(e,Fr.store)}function ha(e){return li(e,Wr.store)}function da(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var va=M(function e(t,n){C(this,e),this.progress=t,this.In=n}),pa=function(){function e(t,n,r){C(this,e),this.Je=t,this.An=n,this.Jt=r}return M(e,[{key:"Rn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKey(e,t).next(function(r){return n.Pn(e,t,r)})}},{key:"Pn",value:function(e,t,n){return this.Je.getEntry(e,t).next(function(e){var t,r=d(n);try{for(r.s();!(t=r.n()).done;){t.value.applyToLocalView(e)}}catch(i){r.e(i)}finally{r.f()}return e})}},{key:"bn",value:function(e,t){e.forEach(function(e,n){var r,i=d(t);try{for(i.s();!(r=i.n()).done;){r.value.applyToLocalView(n)}}catch(a){i.e(a)}finally{i.f()}})}},{key:"vn",value:function(e,t){var n=this;return this.Je.getEntries(e,t).next(function(t){return n.Vn(e,t).next(function(){return t})})}},{key:"Vn",value:function(e,t){var n=this;return this.An.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){return n.bn(t,e)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return Fe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Sn(e,t.path):_t(t)?this.Dn(e,t,n):this.Cn(e,t,n)}},{key:"Sn",value:function(e,t){return this.Rn(e,new Fe(t)).next(function(e){var t=Nn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"Dn",value:function(e,t,n){var r=this,i=t.collectionGroup,a=Nn();return this.Jt.getCollectionParents(e,i).next(function(o){return $r.forEach(o,function(o){var u=function(e,t){return new bt(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return r.Cn(e,u,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"Cn",value:function(e,t,n){var r,i,a=this;return this.Je.getDocumentsMatchingQuery(e,t,n).next(function(n){return r=n,a.An.getAllMutationBatchesAffectingQuery(e,t)}).next(function(t){return i=t,a.Nn(e,i,r).next(function(e){r=e;var t,n=d(i);try{for(n.s();!(t=n.n()).done;){var a,o=t.value,u=d(o.mutations);try{for(u.s();!(a=u.n()).done;){var s=a.value,c=s.key,l=r.get(c);null==l&&(l=Ze.newInvalidDocument(c),r=r.insert(c,l)),un(s,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}catch(f){u.e(f)}finally{u.f()}}}catch(f){n.e(f)}finally{n.f()}})}).next(function(){return r.forEach(function(e,n){Ft(t,n)||(r=r.remove(e))}),r})}},{key:"Nn",value:function(e,t,n){var r,i=Fn(),a=d(t);try{for(a.s();!(r=a.n()).done;){var o,u=d(r.value.mutations);try{for(u.s();!(o=u.n()).done;){var s=o.value;s instanceof hn&&null===n.get(s.key)&&(i=i.add(s.key))}}catch(l){u.e(l)}finally{u.f()}}}catch(l){a.e(l)}finally{a.f()}var c=n;return this.Je.getEntries(e,i).next(function(e){return e.forEach(function(e,t){t.isFoundDocument()&&(c=c.insert(e,t))}),c})}}]),e}(),ya=function(){function e(t,n,r,i){C(this,e),this.targetId=t,this.fromCache=n,this.kn=r,this.xn=i}return M(e,null,[{key:"$n",value:function(t,n){var r,i=Fn(),a=Fn(),o=d(n.docChanges);try{for(o.s();!(r=o.n()).done;){var u=r.value;switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:a=a.add(u.doc.key)}}}catch(s){o.e(s)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),ma=function(){function e(){C(this,e)}return M(e,[{key:"Fn",value:function(e){this.On=e}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,i){var a=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(ve.min())?this.Mn(e,t):this.On.vn(e,i).next(function(o){var u=a.Ln(t,o);return(Tt(t)||Et(t))&&a.Bn(t.limitType,u,i,n)?a.Mn(e,t):(q()<=r.LogLevel.DEBUG&&B("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Mt(t)),a.On.getDocumentsMatchingQuery(e,t,n).next(function(e){return u.forEach(function(t){e=e.insert(t.key,t)}),e}))})}},{key:"Ln",value:function(e,t){var n=new Sn(Ot(e));return t.forEach(function(t,r){Ft(e,r)&&(n=n.add(r))}),n}},{key:"Bn",value:function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Mn",value:function(e,t){return q()<=r.LogLevel.DEBUG&&B("QueryEngine","Using full collection scan to execute query:",Mt(t)),this.On.getDocumentsMatchingQuery(e,t,ve.min())}}]),e}(),ga=function(){function e(t,n,r,i){C(this,e),this.persistence=t,this.Un=n,this.k=i,this.qn=new In(le),this.Kn=new ea(function(e){return tt(e)},rt),this.jn=ve.min(),this.An=t.getMutationQueue(r),this.Qn=t.getRemoteDocumentCache(),this.He=t.getTargetCache(),this.Wn=new pa(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=t.getBundleCache(),this.Un.Fn(this.Wn)}return M(e,[{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.qn)})}}]),e}();function ka(e,t,n,r){return new ga(e,t,n,r)}function wa(e,t){return ba.apply(this,arguments)}function ba(){return(ba=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=H(t),i=r.An,a=r.Wn,e.next=4,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.An.getAllMutationBatches(e).next(function(o){return t=o,i=r.persistence.getMutationQueue(n),a=new pa(r.Qn,i,r.persistence.getIndexManager()),i.getAllMutationBatches(e)}).next(function(n){var r,i=[],o=[],u=Fn(),s=d(t);try{for(s.s();!(r=s.n()).done;){var c=r.value;i.push(c.batchId);var l,f=d(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;u=u.add(h.key)}}catch(w){f.e(w)}finally{f.f()}}}catch(w){s.e(w)}finally{s.f()}var v,p=d(n);try{for(p.s();!(v=p.n()).done;){var y=v.value;o.push(y.batchId);var m,g=d(y.mutations);try{for(g.s();!(m=g.n()).done;){var k=m.value;u=u.add(k.key)}}catch(w){g.e(w)}finally{g.f()}}}catch(w){p.e(w)}finally{p.f()}return a.vn(e,u).next(function(e){return{Gn:e,removedBatchIds:i,addedBatchIds:o}})})});case 4:return o=e.sent,e.abrupt("return",(r.An=i,r.Wn=a,r.Un.Fn(r.Wn),o));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xa(e,t){var n=H(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r=t.batch.keys(),i=n.Qn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=$r.resolve();return a.forEach(function(e){o=o.next(function(){return r.getEntry(t,e)}).next(function(t){var a=n.docVersions.get(e);Q(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))})}),o.next(function(){return e.An.removeMutationBatch(t,i)})}(n,e,t,i).next(function(){return i.apply(e)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,r)})})}function Ia(e){var t=H(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.He.getLastRemoteSnapshotVersion(e)})}function Ta(e,t){var n=H(e),r=t.snapshotVersion,i=n.qn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Qn.newChangeBuffer({trackRemovals:!0});i=n.qn;var o=[];t.targetChanges.forEach(function(t,a){var u=i.get(a);if(u){o.push(n.He.removeMatchingKeys(e,t.removedDocuments,a).next(function(){return n.He.addMatchingKeys(e,t.addedDocuments,a)}));var s=t.resumeToken;if(s.approximateByteSize()>0){var c=u.withResumeToken(s,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(a,c),function(e,t,n){return Q(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(u,c,t)&&o.push(n.He.updateTargetData(e,c))}}});var u=An();if(t.documentUpdates.forEach(function(r,i){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(Ea(e,a,t.documentUpdates,r,void 0).next(function(e){u=e})),!r.isEqual(ve.min())){var s=n.He.getLastRemoteSnapshotVersion(e).next(function(t){return n.He.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(s)}return $r.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.Wn.Vn(e,u)}).next(function(){return u})}).then(function(e){return n.qn=i,e})}function Ea(e,t,n,r,i){var a=Fn();return n.forEach(function(e){return a=a.add(e)}),t.getEntries(e,a).next(function(e){var a=An();return n.forEach(function(n,o){var u=e.get(n),s=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(ve.min())?(t.removeEntry(n,s),a=a.insert(n,o)):!u.isValidDocument()||o.version.compareTo(u.version)>0||0===o.version.compareTo(u.version)&&u.hasPendingWrites?(t.addEntry(o,s),a=a.insert(n,o)):B("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",o.version)}),a})}function Sa(e,t){var n=H(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.An.getNextMutationBatchAfterBatchId(e,t)})}function Ra(e,t){var n=H(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.He.getTargetData(e,t).next(function(i){return i?(r=i,$r.resolve(r)):n.He.allocateTargetId(e).next(function(i){return r=new di(t,i,0,e.currentSequenceNumber),n.He.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.qn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.qn=n.qn.insert(e.targetId,e),n.Kn.set(t,e.targetId)),e})}function _a(e,t,n){return Aa.apply(this,arguments)}function Aa(){return(Aa=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=H(t),a=i.qn.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),ii(e.t1)){e.next=12;break}throw e.t1;case 12:B("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.qn=i.qn.remove(n),i.Kn.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function Da(e,t,n){var r=H(e),i=ve.min(),a=Fn();return r.persistence.runTransaction("Execute query","readonly",function(e){return function(e,t,n){var r=H(e),i=r.Kn.get(n);return void 0!==i?$r.resolve(r.qn.get(i)):r.He.getTargetData(t,n)}(r,e,Dt(t)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.He.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Un.getDocumentsMatchingQuery(e,t,n?i:ve.min(),n?a:Fn())}).next(function(e){return{documents:e,zn:a}})})}function Na(e,t){var n=H(e),r=H(n.He),i=n.qn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(e){return r.Et(e,t).next(function(e){return e?e.target:null})})}function Ca(e){var t=H(e);return t.persistence.runTransaction("Get new document changes","readonly",function(e){return function(e,t,n){var r=H(e),i=An(),a=mi(n),o=aa(t),u=IDBKeyRange.lowerBound(a,!0);return o.jt({index:Br.readTimeIndex,range:u},function(e,t){var n=pi(r.k,t);i=i.insert(n.key,n),a=t.readTime}).next(function(){return{In:i,readTime:gi(a)}})}(t.Qn,e,t.jn)}).then(function(e){var n=e.In,r=e.readTime;return t.jn=r,n})}function La(e){return Ma.apply(this,arguments)}function Ma(){return(Ma=p(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=H(t),e.abrupt("return",n.persistence.runTransaction("Synchronize last document change read time","readonly",function(e){return function(e){var t=aa(e),n=ve.min();return t.jt({index:Br.readTimeIndex,reverse:!0},function(e,t,r){t.readTime&&(n=gi(t.readTime)),r.done()}).next(function(){return n})}(e)}).then(function(e){n.jn=e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fa(e,t,n,r){return Oa.apply(this,arguments)}function Oa(){return(Oa=p(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,u,s,c,l,f,h,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=H(t),o=Fn(),u=An(),s=Ln(),c=d(r);try{for(c.s();!(l=c.n()).done;)f=l.value,h=n.Hn(f.metadata.name),f.document&&(o=o.add(h)),u=u.insert(h,n.Jn(f)),s=s.insert(h,n.Yn(f.metadata.readTime))}catch(y){c.e(y)}finally{c.f()}return v=a.Qn.newChangeBuffer({trackRemovals:!0}),e.next=7,Ra(a,function(e){return Dt(It(ke.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return p=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Ea(e,v,u,ve.min(),s).next(function(t){return v.apply(e),t}).next(function(t){return a.He.removeMatchingKeysForTargetId(e,p.targetId).next(function(){return a.He.addMatchingKeys(e,o,p.targetId)}).next(function(){return a.Wn.Vn(e,t)}).next(function(){return t})})}));case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pa(e,t){return Va.apply(this,arguments)}function Va(){return(Va=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:Fn(),e.next=3,Ra(t,Dt(Ti(n.bundledQuery)));case 3:return i=e.sent,a=H(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",function(e){var t=$n(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.Ye.saveNamedQuery(e,n);var o=i.withResumeToken(Te.EMPTY_BYTE_STRING,t);return a.qn=a.qn.insert(o.targetId,o),a.He.updateTargetData(e,o).next(function(){return a.He.removeMatchingKeysForTargetId(e,i.targetId)}).next(function(){return a.He.addMatchingKeys(e,r,i.targetId)}).next(function(){return a.Ye.saveNamedQuery(e,n)})}));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var qa=function(){function e(t){C(this,e),this.k=t,this.Xn=new Map,this.Zn=new Map}return M(e,[{key:"getBundleMetadata",value:function(e,t){return $r.resolve(this.Xn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Xn.set(t.id,{id:(n=t).id,version:n.version,createTime:$n(n.createTime)}),$r.resolve()}},{key:"getNamedQuery",value:function(e,t){return $r.resolve(this.Zn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Zn.set(t.name,function(e){return{name:e.name,query:Ti(e.bundledQuery),readTime:$n(e.readTime)}}(t)),$r.resolve()}}]),e}(),Ua=function(){function e(){C(this,e),this.ts=new Sn(Ba.es),this.ns=new Sn(Ba.ss)}return M(e,[{key:"isEmpty",value:function(){return this.ts.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Ba(e,t);this.ts=this.ts.add(n),this.ns=this.ns.add(n)}},{key:"rs",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.os(new Ba(e,t))}},{key:"cs",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new Fe(new ke([])),r=new Ba(n,e),i=new Ba(n,e+1),a=[];return this.ns.forEachInRange([r,i],function(e){t.os(e),a.push(e.key)}),a}},{key:"hs",value:function(){var e=this;this.ts.forEach(function(t){return e.os(t)})}},{key:"os",value:function(e){this.ts=this.ts.delete(e),this.ns=this.ns.delete(e)}},{key:"ls",value:function(e){var t=new Fe(new ke([])),n=new Ba(t,e),r=new Ba(t,e+1),i=Fn();return this.ns.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new Ba(e,0),n=this.ts.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Ba=function(){function e(t,n){C(this,e),this.key=t,this.fs=n}return M(e,null,[{key:"es",value:function(e,t){return Fe.comparator(e.key,t.key)||le(e.fs,t.fs)}},{key:"ss",value:function(e,t){return le(e.fs,t.fs)||Fe.comparator(e.key,t.key)}}]),e}(),Ka=function(){function e(t,n){C(this,e),this.Jt=t,this.referenceDelegate=n,this.An=[],this.ds=1,this.ws=new Sn(Ba.es)}return M(e,[{key:"checkEmpty",value:function(e){return $r.resolve(0===this.An.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ds;this.ds++,this.An.length>0&&this.An[this.An.length-1];var a=new fi(i,t,n,r);this.An.push(a);var o,u=d(r);try{for(u.s();!(o=u.n()).done;){var s=o.value;this.ws=this.ws.add(new Ba(s.key,i)),this.Jt.addToCollectionParentIndex(e,s.key.path.popLast())}}catch(c){u.e(c)}finally{u.f()}return $r.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return $r.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.gs(n),i=r<0?0:r;return $r.resolve(this.An.length>i?this.An[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return $r.resolve(0===this.An.length?-1:this.ds-1)}},{key:"getAllMutationBatches",value:function(e){return $r.resolve(this.An.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Ba(t,0),i=new Ba(t,Number.POSITIVE_INFINITY),a=[];return this.ws.forEachInRange([r,i],function(e){var t=n._s(e.fs);a.push(t)}),$r.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Sn(le);return t.forEach(function(e){var t=new Ba(e,0),i=new Ba(e,Number.POSITIVE_INFINITY);n.ws.forEachInRange([t,i],function(e){r=r.add(e.fs)})}),$r.resolve(this.ys(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;Fe.isDocumentKey(i)||(i=i.child(""));var a=new Ba(new Fe(i),0),o=new Sn(le);return this.ws.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.fs)),!0)},a),$r.resolve(this.ys(o))}},{key:"ys",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Q(0===this.ps(t.batchId,"removed")),this.An.shift();var r=this.ws;return $r.forEach(t.mutations,function(i){var a=new Ba(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ws=r})}},{key:"ee",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Ba(t,0),r=this.ws.firstAfterOrEqual(n);return $r.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.An.length,$r.resolve()}},{key:"ps",value:function(e,t){return this.gs(e)}},{key:"gs",value:function(e){return 0===this.An.length?0:e-this.An[0].batchId}},{key:"_s",value:function(e){var t=this.gs(e);return t<0||t>=this.An.length?null:this.An[t]}}]),e}(),ja=function(){function e(t,n){C(this,e),this.Jt=t,this.Ts=n,this.docs=new In(Fe.comparator),this.size=0}return M(e,[{key:"addEntry",value:function(e,t,n){var r=t.key,i=this.docs.get(r),a=i?i.size:0,o=this.Ts(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:o,readTime:n}),this.size+=o-a,this.Jt.addToCollectionParentIndex(e,r.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return $r.resolve(n?n.document.clone():Ze.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=An();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.clone():Ze.newInvalidDocument(e))}),$r.resolve(r)}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){for(var r=An(),i=new Fe(t.path.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),u=o.key,s=o.value,c=s.document,l=s.readTime;if(!t.path.isPrefixOf(u.path))break;l.compareTo(n)<=0||Ft(t,c)&&(r=r.insert(c.key,c.clone()))}return $r.resolve(r)}},{key:"Es",value:function(e,t){return $r.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new Ga(this)}},{key:"getSize",value:function(e){return $r.resolve(this.size)}}]),e}(),Ga=function(e){y(n,ta);var t=m(n);function n(e){var r;return C(this,n),(r=t.call(this)).De=e,r}return M(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.document.isValidDocument()?n.push(t.De.addEntry(e,i.document,t.getReadTime(r))):t.De.removeEntry(r)}),$r.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.De.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.De.getEntries(e,t)}}]),n}(),za=function(){function e(t){C(this,e),this.persistence=t,this.Is=new ea(function(e){return tt(e)},rt),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.As=0,this.Rs=new Ua,this.targetCount=0,this.Ps=Bi.ie()}return M(e,[{key:"forEachTarget",value:function(e,t){return this.Is.forEach(function(e,n){return t(n)}),$r.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return $r.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return $r.resolve(this.As)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Ps.next(),$r.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.As&&(this.As=t),$r.resolve()}},{key:"ce",value:function(e){this.Is.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Ps=new Bi(t),this.highestTargetId=t),e.sequenceNumber>this.As&&(this.As=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.ce(t),this.targetCount+=1,$r.resolve()}},{key:"updateTargetData",value:function(e,t){return this.ce(t),$r.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Is.delete(t.target),this.Rs.us(t.targetId),this.targetCount-=1,$r.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Is.forEach(function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.Is.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),$r.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return $r.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Is.get(t)||null;return $r.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Rs.rs(t,n),$r.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Rs.cs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),$r.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Rs.us(t),$r.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Rs.ls(t);return $r.resolve(n)}},{key:"containsKey",value:function(e,t){return $r.resolve(this.Rs.containsKey(t))}}]),e}(),Qa=function(){function e(t,n){var r=this;C(this,e),this.bs={},this.Be=new ue(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=t(this),this.He=new za(this),this.Jt=new _i,this.Je=function(e,t){return new ja(e,function(e){return r.referenceDelegate.vs(e)})}(this.Jt),this.k=new vi(n),this.Ye=new qa(this.k)}return M(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ue=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ue}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(){return this.Jt}},{key:"getMutationQueue",value:function(e){var t=this.bs[e.toKey()];return t||(t=new Ka(this.Jt,this.referenceDelegate),this.bs[e.toKey()]=t),t}},{key:"getTargetCache",value:function(){return this.He}},{key:"getRemoteDocumentCache",value:function(){return this.Je}},{key:"getBundleCache",value:function(){return this.Ye}},{key:"runTransaction",value:function(e,t,n){var r=this;B("MemoryPersistence","Starting transaction:",e);var i=new Wa(this.Be.next());return this.referenceDelegate.Vs(),n(i).next(function(e){return r.referenceDelegate.Ss(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ds",value:function(e,t){return $r.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),Wa=function(e){y(n,Zr);var t=m(n);function n(e){var r;return C(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return M(n)}(),Ha=function(){function e(t){C(this,e),this.persistence=t,this.Cs=new Ua,this.Ns=null}return M(e,[{key:"xs",get:function(){if(this.Ns)return this.Ns;throw z()}},{key:"addReference",value:function(e,t,n){return this.Cs.addReference(n,t),this.xs.delete(n.toString()),$r.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Cs.removeReference(n,t),this.xs.add(n.toString()),$r.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.xs.add(t.toString()),$r.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Cs.us(t.targetId).forEach(function(e){return n.xs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.xs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Vs",value:function(){this.Ns=new Set}},{key:"Ss",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $r.forEach(this.xs,function(r){var i=Fe.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i)})}).next(function(){return t.Ns=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.xs.delete(t.toString()):n.xs.add(t.toString())})}},{key:"vs",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return $r.or([function(){return $r.resolve(n.Cs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ds(e,t)}])}}],[{key:"ks",value:function(t){return new e(t)}}]),e}();function Ya(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function Ja(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function Xa(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var Za=function(){function e(t,n,r,i){C(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return M(e,[{key:"Os",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Fs",value:function(t,n,r){var i,a=JSON.parse(r),o="object"==h(a)&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==h(a.error));return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new J(a.error.code,a.error.message))),o?new e(t,n,a.state,i):(K("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),$a=function(){function e(t,n,r){C(this,e),this.targetId=t,this.state=n,this.error=r}return M(e,[{key:"Os",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Fs",value:function(t,n){var r,i=JSON.parse(n),a="object"==h(i)&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==h(i.error));return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new J(i.error.code,i.error.message))),a?new e(t,i.state,r):(K("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),eo=function(){function e(t,n){C(this,e),this.clientId=t,this.activeTargetIds=n}return M(e,null,[{key:"Fs",value:function(t,n){for(var r=JSON.parse(n),i="object"==h(r)&&r.activeTargetIds instanceof Array,a=Pn(),o=0;i&&o<r.activeTargetIds.length;++o)i=Me(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new e(t,a):(K("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),to=function(){function e(t,n){C(this,e),this.clientId=t,this.onlineState=n}return M(e,null,[{key:"Fs",value:function(t){var n=JSON.parse(t);return"object"==h(n)&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(K("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),no=function(){function e(){C(this,e),this.activeTargetIds=Pn()}return M(e,[{key:"Ms",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Ls",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Os",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),ro=function(){function e(t,n,r,i,a){C(this,e),this.window=t,this.Oe=n,this.persistenceKey=r,this.Bs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Us=this.qs.bind(this),this.Ks=new In(le),this.started=!1,this.js=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.Qs=Ya(this.persistenceKey,this.Bs),this.Ws=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.Ks=this.Ks.insert(this.Bs,new no),this.Gs=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.zs=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this.Hs=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.Js=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.Ys=function(e){return"firestore_bundle_loaded_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.Us)}return M(e,[{key:"start",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,n,r,i,a,o,u,s,c,l,f,h=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.Tn();case 2:t=e.sent,n=d(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.Bs){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(Ya(this.persistenceKey,i)))&&(o=eo.Fs(i,a))&&(this.Ks=this.Ks.insert(o.clientId,o));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this.Xs(),(u=this.storage.getItem(this.Js))&&(s=this.Zs(u))&&this.ti(s),c=d(this.js);try{for(c.s();!(l=c.n()).done;)f=l.value,this.qs(f)}catch(v){c.e(v)}finally{c.f()}this.js=[],this.window.addEventListener("pagehide",function(){return h.shutdown()}),this.started=!0;case 28:case"end":return e.stop()}},e,this,[[4,16,19,22]])}));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.Ws,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.ei(this.Ks)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.Ks.forEach(function(n,r){r.activeTargetIds.has(e)&&(t=!0)}),t}},{key:"addPendingMutation",value:function(e){this.ni(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.ni(e,t,n),this.si(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Xa(this.persistenceKey,e));if(n){var r=$a.Fs(e,n);r&&(t=r.state)}}return this.ii.Ms(e),this.Xs(),t}},{key:"removeLocalQueryTarget",value:function(e){this.ii.Ls(e),this.Xs()}},{key:"isLocalQueryTarget",value:function(e){return this.ii.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(Xa(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.ri(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach(function(e){r.si(e)}),this.currentUser=e,n.forEach(function(e){r.addPendingMutation(e)})}},{key:"setOnlineState",value:function(e){this.oi(e)}},{key:"notifyBundleLoaded",value:function(){this.ai()}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.Us),this.removeItem(this.Qs),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return B("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){B("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){B("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"qs",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(B("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Qs)return void K("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Oe.enqueueRetryable(p(regeneratorRuntime.mark(function e(){var r,i,a,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=41;break}if(null===n.key){e.next=39;break}if(!t.Gs.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.ci(n.key),e.abrupt("return",t.ui(r,null));case 6:if(!(i=t.hi(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.ui(i.clientId,i));case 9:e.next=39;break;case 11:if(!t.zs.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.li(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.fi(a));case 16:e.next=39;break;case 18:if(!t.Hs.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(o=t.di(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.wi(o));case 23:e.next=39;break;case 25:if(n.key!==t.Js){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(u=t.Zs(n.newValue))){e.next=30;break}return e.abrupt("return",t.ti(u));case 30:e.next=39;break;case 32:if(n.key!==t.Ws){e.next=37;break}(s=function(e){var t=ue.I;if(null!=e)try{var n=JSON.parse(e);Q("number"==typeof n),t=n}catch(e){K("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==ue.I&&t.sequenceNumberHandler(s),e.next=39;break;case 37:if(n.key!==t.Ys){e.next=39;break}return e.abrupt("return",t.syncEngine._i());case 39:e.next=42;break;case 41:t.js.push(n);case 42:case"end":return e.stop()}},e)})))}}},{key:"ii",get:function(){return this.Ks.get(this.Bs)}},{key:"Xs",value:function(){this.setItem(this.Qs,this.ii.Os())}},{key:"ni",value:function(e,t,n){var r=new Za(this.currentUser,e,t,n),i=Ja(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Os())}},{key:"si",value:function(e){var t=Ja(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"oi",value:function(e){var t={clientId:this.Bs,onlineState:e};this.storage.setItem(this.Js,JSON.stringify(t))}},{key:"ri",value:function(e,t,n){var r=Xa(this.persistenceKey,e),i=new $a(e,t,n);this.setItem(r,i.Os())}},{key:"ai",value:function(){this.setItem(this.Ys,"value-not-used")}},{key:"ci",value:function(e){var t=this.Gs.exec(e);return t?t[1]:null}},{key:"hi",value:function(e,t){var n=this.ci(e);return eo.Fs(n,t)}},{key:"li",value:function(e,t){var n=this.zs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Za.Fs(new O(i),r,t)}},{key:"di",value:function(e,t){var n=this.Hs.exec(e),r=Number(n[1]);return $a.Fs(r,t)}},{key:"Zs",value:function(e){return to.Fs(e)}},{key:"fi",value:function(){var e=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.mi(t.batchId,t.state,t.error));case 2:B("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"wi",value:function(e){return this.syncEngine.gi(e.targetId,e.state,e.error)}},{key:"ui",value:function(e,t){var n=this,r=t?this.Ks.insert(e,t):this.Ks.remove(e),i=this.ei(this.Ks),a=this.ei(r),o=[],u=[];return a.forEach(function(e){i.has(e)||o.push(e)}),i.forEach(function(e){a.has(e)||u.push(e)}),this.syncEngine.yi(o,u).then(function(){n.Ks=r})}},{key:"ti",value:function(e){this.Ks.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"ei",value:function(e){var t=Pn();return e.forEach(function(e,n){t=t.unionWith(n.activeTargetIds)}),t}}],[{key:"bt",value:function(e){return!(!e||!e.localStorage)}}]),e}(),io=function(){function e(){C(this,e),this.pi=new no,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return M(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.pi.Ms(e),this.Ti[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Ti[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.pi.Ls(e)}},{key:"isLocalQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Ti[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.pi.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.pi.activeTargetIds.has(e)}},{key:"start",value:function(){return this.pi=new no,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(){}}]),e}(),ao=function(){function e(){C(this,e)}return M(e,[{key:"Ei",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),oo=function(){function e(){var t=this;C(this,e),this.Ii=function(){return t.Ai()},this.Ri=function(){return t.Pi()},this.bi=[],this.vi()}return M(e,[{key:"Ei",value:function(e){this.bi.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}},{key:"vi",value:function(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}},{key:"Ai",value:function(){B("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=d(this.bi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Pi",value:function(){B("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=d(this.bi);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"bt",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),uo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},so=function(){function e(t){C(this,e),this.Vi=t.Vi,this.Si=t.Si}return M(e,[{key:"Di",value:function(e){this.Ci=e}},{key:"Ni",value:function(e){this.ki=e}},{key:"onMessage",value:function(e){this.xi=e}},{key:"close",value:function(){this.Si()}},{key:"send",value:function(e){this.Vi(e)}},{key:"$i",value:function(){this.Ci()}},{key:"Fi",value:function(e){this.ki(e)}},{key:"Oi",value:function(e){this.xi(e)}}]),e}(),co=function(e){y(n,function(){function e(t){C(this,e);this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.Mi=n+"://"+t.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}M(e,[{key:"Bi",value:function e(t,n,r,i,a){var o=this.Ui(t,n);B("RestConnection","Sending: ",o,r);var u={};return this.qi(u,i,a),this.Ki(t,o,u,r).then(function(e){return B("RestConnection","Received: ",e),e},function(e){throw j("RestConnection","".concat(t," failed with error: "),e,"url: ",o,"request:",r),e})}},{key:"ji",value:function e(t,n,r,i,a){return this.Bi(t,n,r,i,a)}},{key:"qi",value:function e(t,n,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+P,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(function(e,n){return t[n]=e}),r&&r.headers.forEach(function(e,n){return t[n]=e})}},{key:"Ui",value:function e(t,n){var r=uo[t];return"".concat(this.Mi,"/v1/").concat(n,":").concat(r)}}]);return e}());var t=m(n);function n(e){var r;return C(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return M(n,[{key:"Ki",value:function(e,t,n,r){return new Promise(function(i,o){var u=new a.XhrIo;u.listenOnce(a.EventType.COMPLETE,function(){try{switch(u.getLastErrorCode()){case a.ErrorCode.NO_ERROR:var t=u.getResponseJson();B("Connection","XHR received:",JSON.stringify(t)),i(t);break;case a.ErrorCode.TIMEOUT:B("Connection",'RPC "'+e+'" timed out'),o(new J(Y.DEADLINE_EXCEEDED,"Request time out"));break;case a.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(B("Connection",'RPC "'+e+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var s=(c=r.status.toLowerCase().replace(/_/g,"-"),Object.values(Y).indexOf(c)>=0?c:Y.UNKNOWN);o(new J(s,r.message))}else o(new J(Y.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new J(Y.UNAVAILABLE,"Connection failed."));break;default:z()}}finally{B("Connection",'RPC "'+e+'" completed.')}var c});var s=JSON.stringify(r);u.send(t,"POST",s,n,15)})}},{key:"Qi",value:function(e,t,n){var r=[this.Mi,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=(0,a.createWebChannelTransport)(),u=(0,a.getStatEventTarget)(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new a.FetchXmlHttpFactory({})),this.qi(s.initMessageHeaders,t,n),(0,i.isMobileCordova)()||(0,i.isReactNative)()||(0,i.isElectron)()||(0,i.isIE)()||(0,i.isUWP)()||(0,i.isBrowserExtension)()||(s.httpHeadersOverwriteParam="$httpHeaders");var c=r.join("");B("Connection","Creating WebChannel: "+c,s);var l=o.createWebChannel(c,s),f=!1,h=!1,d=new so({Vi:function(e){h?B("Connection","Not sending because WebChannel is closed:",e):(f||(B("Connection","Opening WebChannel transport."),l.open(),f=!0),B("Connection","WebChannel sending:",e),l.send(e))},Si:function(){return l.close()}}),v=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(e){setTimeout(function(){throw e},0)}})};return v(l,a.WebChannel.EventType.OPEN,function(){h||B("Connection","WebChannel transport opened.")}),v(l,a.WebChannel.EventType.CLOSE,function(){h||(h=!0,B("Connection","WebChannel transport closed"),d.Fi())}),v(l,a.WebChannel.EventType.ERROR,function(e){h||(h=!0,j("Connection","WebChannel transport errored:",e),d.Fi(new J(Y.UNAVAILABLE,"The operation could not be completed")))}),v(l,a.WebChannel.EventType.MESSAGE,function(e){var t;if(!h){var n=e.data[0];Q(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){B("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=yn[a];if(void 0!==t)return xn(t)}(),u=i.message;void 0===o&&(o=Y.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),h=!0,d.Fi(new J(o,u)),l.close()}else B("Connection","WebChannel received:",n),d.Oi(n)}}),v(u,a.Event.STAT_EVENT,function(e){e.stat===a.Stat.PROXY?B("Connection","Detected buffering proxy"):e.stat===a.Stat.NOPROXY&&B("Connection","Detected no buffering proxy")}),setTimeout(function(){d.$i()},0),d}}]),n}();function lo(){return"undefined"!=typeof window?window:null}function fo(){return"undefined"!=typeof document?document:null}function ho(e){return new Yn(e,!0)}var vo=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;C(this,e),this.Oe=t,this.timerId=n,this.Wi=r,this.Gi=i,this.zi=a,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}return M(e,[{key:"reset",value:function(){this.Hi=0}},{key:"Xi",value:function(){this.Hi=this.zi}},{key:"Zi",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Hi+this.tr()),r=Math.max(0,Date.now()-this.Yi),i=Math.max(0,n-r);i>0&&B("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Hi," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Ji=this.Oe.enqueueAfterDelay(this.timerId,i,function(){return t.Yi=Date.now(),e()}),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}},{key:"er",value:function(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}},{key:"cancel",value:function(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}},{key:"tr",value:function(){return(Math.random()-.5)*this.Hi}}]),e}(),po=function(){function e(t,n,r,i,a,o,u,s){C(this,e),this.Oe=t,this.nr=r,this.sr=i,this.ir=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=s,this.state=0,this.rr=0,this.ar=null,this.cr=null,this.stream=null,this.ur=new vo(t,n)}return M(e,[{key:"hr",value:function(){return 1===this.state||5===this.state||this.lr()}},{key:"lr",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.dr()}},{key:"stop",value:function(){var e=p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.hr(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"wr",value:function(){this.state=0,this.ur.reset()}},{key:"_r",value:function(){var e=this;this.lr()&&null===this.ar&&(this.ar=this.Oe.enqueueAfterDelay(this.nr,6e4,function(){return e.mr()}))}},{key:"gr",value:function(e){this.yr(),this.stream.send(e)}},{key:"mr",value:function(){var e=p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.lr()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"yr",value:function(){this.ar&&(this.ar.cancel(),this.ar=null)}},{key:"pr",value:function(){this.cr&&(this.cr.cancel(),this.cr=null)}},{key:"close",value:function(){var e=p(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.yr(),this.pr(),this.ur.cancel(),this.rr++,4!==t?this.ur.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(K(n.toString()),K("Using maximum backoff delay to prevent overloading the backend."),this.ur.Xi()):n&&n.code===Y.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Tr(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Ni(n);case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"Tr",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Er(this.rr),n=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=s(t,2),i=r[0],a=r[1];e.rr===n&&e.Ir(i,a)},function(n){t(function(){var t=new J(Y.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Ar(t)})})}},{key:"Ir",value:function(e,t){var n=this,r=this.Er(this.rr);this.stream=this.Rr(e,t),this.stream.Di(function(){r(function(){return n.state=2,n.cr=n.Oe.enqueueAfterDelay(n.sr,1e4,function(){return n.lr()&&(n.state=3),Promise.resolve()}),n.listener.Di()})}),this.stream.Ni(function(e){r(function(){return n.Ar(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"dr",value:function(){var e=this;this.state=5,this.ur.Zi(p(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"Ar",value:function(e){return B("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Er",value:function(e){var t=this;return function(n){t.Oe.enqueueAndForget(function(){return t.rr===e?n():(B("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),yo=function(e){y(n,po);var t=m(n);function n(e,r,i,a,o,u){var s;return C(this,n),(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,u)).k=o,s}return M(n,[{key:"Rr",value:function(e,t){return this.ir.Qi("Listen",e,t)}},{key:"onMessage",value:function(e){this.ur.reset();var t=fr(this.k,e),n=function(e){if(!("targetChange"in e))return ve.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?ve.min():t.readTime?$n(t.readTime):ve.min()}(e);return this.listener.Pr(t,n)}},{key:"br",value:function(e){var t={};t.database=or(this.k),t.addTarget=function(e,t){var n,r=t.target;return(n=it(r)?{documents:pr(e,r)}:{query:yr(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Xn(e,t.resumeToken):t.snapshotVersion.compareTo(ve.min())>0&&(n.readTime=Jn(e,t.snapshotVersion.toTimestamp())),n}(this.k,e);var n=gr(this.k,e);n&&(t.labels=n),this.gr(t)}},{key:"vr",value:function(e){var t={};t.database=or(this.k),t.removeTarget=e,this.gr(t)}}]),n}(),mo=function(e){y(n,po);var t=m(n);function n(e,r,i,a,o,u){var s;return C(this,n),(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,u)).k=o,s.Vr=!1,s}return M(n,[{key:"Sr",get:function(){return this.Vr}},{key:"start",value:function(){this.Vr=!1,this.lastStreamToken=void 0,o(E(n.prototype),"start",this).call(this)}},{key:"Tr",value:function(){this.Vr&&this.Dr([])}},{key:"Rr",value:function(e,t){return this.ir.Qi("Write",e,t)}},{key:"onMessage",value:function(e){if(Q(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Vr){this.ur.reset();var t=vr(e.writeResults,e.commitTime),n=$n(e.commitTime);return this.listener.Cr(n,t)}return Q(!e.writeResults||0===e.writeResults.length),this.Vr=!0,this.listener.Nr()}},{key:"kr",value:function(){var e={};e.database=or(this.k),this.gr(e)}},{key:"Dr",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return hr(t.k,e)})};this.gr(n)}}]),n}(),go=function(e){y(n,function(){function e(){C(this,e)}return M(e)}());var t=m(n);function n(e,r,i,a){var o;return C(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.ir=i,o.k=a,o.$r=!1,o}return M(n,[{key:"Fr",value:function(){if(this.$r)throw new J(Y.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"Bi",value:function(e,t,n){var r=this;return this.Fr(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=s(i,2),o=a[0],u=a[1];return r.ir.Bi(e,t,n,o,u)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Y.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new J(Y.UNKNOWN,e.toString())})}},{key:"ji",value:function(e,t,n){var r=this;return this.Fr(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=s(i,2),o=a[0],u=a[1];return r.ir.ji(e,t,n,o,u)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Y.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new J(Y.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.$r=!0}}]),n}(),ko=function(){function e(t,n){C(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.Or=0,this.Mr=null,this.Lr=!0}return M(e,[{key:"Br",value:function(){var e=this;0===this.Or&&(this.Ur("Unknown"),this.Mr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.Mr=null,e.qr("Backend didn't respond within 10 seconds."),e.Ur("Offline"),Promise.resolve()}))}},{key:"Kr",value:function(e){"Online"===this.state?this.Ur("Unknown"):(this.Or++,this.Or>=1&&(this.jr(),this.qr("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.Ur("Offline")))}},{key:"set",value:function(e){this.jr(),this.Or=0,"Online"===e&&(this.Lr=!1),this.Ur(e)}},{key:"Ur",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"qr",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.Lr?(K(t),this.Lr=!1):B("OnlineStateTracker",t)}},{key:"jr",value:function(){null!==this.Mr&&(this.Mr.cancel(),this.Mr=null)}}]),e}(),wo=M(function e(t,n,r,i,a){var o=this;C(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=a,this.Hr.Ei(function(e){r.enqueueAndForget(p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=No(o),!e.t0){e.next=5;break}return B("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=p(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=H(t)).Gr.add(4),e.next=4,Io(n);case 4:return n.Jr.set("Unknown"),n.Gr.delete(4),e.next=8,bo(n);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}},e)})))}),this.Jr=new ko(r,i)});function bo(e){return xo.apply(this,arguments)}function xo(){return(xo=p(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!No(t)){e.next=18;break}n=d(t.zr),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])}))).apply(this,arguments)}function Io(e){return To.apply(this,arguments)}function To(){return(To=p(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=d(t.zr),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])}))).apply(this,arguments)}function Eo(e,t){var n=H(e);n.Wr.has(t.targetId)||(n.Wr.set(t.targetId,t),Do(n)?Ao(n):iu(n).lr()&&Ro(n,t))}function So(e,t){var n=H(e),r=iu(n);n.Wr.delete(t),r.lr()&&_o(n,t),0===n.Wr.size&&(r.lr()?r._r():No(n)&&n.Jr.set("Unknown"))}function Ro(e,t){e.Yr.X(t.targetId),iu(e).br(t)}function _o(e,t){e.Yr.X(t),iu(e).vr(t)}function Ao(e){e.Yr=new Gn({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},Et:function(t){return e.Wr.get(t)||null}}),iu(e).start(),e.Jr.Br()}function Do(e){return No(e)&&!iu(e).hr()&&e.Wr.size>0}function No(e){return 0===H(e).Gr.size}function Co(e){e.Yr=void 0}function Lo(e){return Mo.apply(this,arguments)}function Mo(){return(Mo=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.Wr.forEach(function(e,n){Ro(t,e)});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fo(e,t){return Oo.apply(this,arguments)}function Oo(){return(Oo=p(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Co(t),Do(t)?(t.Jr.Kr(n),Ao(t)):t.Jr.set("Unknown");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Po(e,t,n){return Vo.apply(this,arguments)}function Vo(){return(Vo=p(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.Jr.set("Online"),!(n instanceof Kn&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=d(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.Wr.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.Wr.delete(o),t.Yr.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])}));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),B("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,qo(t,e.t0);case 11:e.next=29;break;case 13:if(n instanceof Un?t.Yr.ot(n):n instanceof Bn?t.Yr.dt(n):t.Yr.ut(n),r.isEqual(ve.min())){e.next=29;break}return e.prev=14,e.next=17,Ia(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.Yr.gt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.Wr.get(r);i&&e.Wr.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.Wr.get(t);if(n){e.Wr.set(t,n.withResumeToken(Te.EMPTY_BYTE_STRING,n.snapshotVersion)),_o(e,t);var r=new di(n.target,t,1,n.sequenceNumber);Ro(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 22:e.next=29;break;case 24:return e.prev=24,e.t2=e.catch(14),B("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,qo(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])}))).apply(this,arguments)}function qo(e,t,n){return Uo.apply(this,arguments)}function Uo(){return(Uo=p(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ii(n)){e.next=2;break}throw n;case 2:return t.Gr.add(1),e.next=5,Io(t);case 5:t.Jr.set("Offline"),r||(r=function(){return Ia(t.localStore)}),t.asyncQueue.enqueueRetryable(p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.Gr.delete(1),e.next=6,bo(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Bo(e,t){return t().catch(function(n){return qo(e,n,t)})}function Ko(e){return jo.apply(this,arguments)}function jo(){return(jo=p(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=H(t),r=au(n),i=n.Qr.length>0?n.Qr[n.Qr.length-1].batchId:-1;case 2:if(!Go(n)){e.next=19;break}return e.prev=3,e.next=6,Sa(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.Qr.length&&r._r(),e.abrupt("break",19);case 10:i=a.batchId,zo(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,qo(n,e.t0);case 17:e.next=2;break;case 19:Qo(n)&&Wo(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])}))).apply(this,arguments)}function Go(e){return No(e)&&e.Qr.length<10}function zo(e,t){e.Qr.push(t);var n=au(e);n.lr()&&n.Sr&&n.Dr(t.mutations)}function Qo(e){return No(e)&&!au(e).hr()&&e.Qr.length>0}function Wo(e){au(e).start()}function Ho(e){return Yo.apply(this,arguments)}function Yo(){return(Yo=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:au(t).kr();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Jo(e){return Xo.apply(this,arguments)}function Xo(){return(Xo=p(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=au(t),r=d(t.Qr);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Dr(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Zo(e,t,n){return $o.apply(this,arguments)}function $o(){return($o=p(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.Qr.shift(),a=hi.from(i,n,r),e.next=3,Bo(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,Ko(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function eu(e,t){return tu.apply(this,arguments)}function tu(){return(tu=p(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&au(t).Sr,!e.t0){e.next=4;break}return e.next=4,function(){var e=p(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!bn(i=n.code)||i===Y.ABORTED){e.next=7;break}return r=t.Qr.shift(),au(t).wr(),e.next=5,Bo(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,Ko(t);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:Qo(t)&&Wo(t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function nu(e,t){return ru.apply(this,arguments)}function ru(){return(ru=p(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=H(t),!n){e.next=7;break}return r.Gr.delete(2),e.next=5,bo(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.Gr.add(2),e.next=12,Io(r);case 12:r.Jr.set("Unknown");case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function iu(e){return e.Xr||(e.Xr=function(e,t,n){var r=H(e);return r.Fr(),new yo(t,r.ir,r.authCredentials,r.appCheckCredentials,r.k,n)}(e.datastore,e.asyncQueue,{Di:Lo.bind(null,e),Ni:Fo.bind(null,e),Pr:Po.bind(null,e)}),e.zr.push(function(){var t=p(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.Xr.wr(),Do(e)?Ao(e):e.Jr.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Xr.stop();case 6:Co(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Xr}function au(e){return e.Zr||(e.Zr=function(e,t,n){var r=H(e);return r.Fr(),new mo(t,r.ir,r.authCredentials,r.appCheckCredentials,r.k,n)}(e.datastore,e.asyncQueue,{Di:Ho.bind(null,e),Ni:eu.bind(null,e),Nr:Jo.bind(null,e),Cr:Zo.bind(null,e)}),e.zr.push(function(){var t=p(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.Zr.wr(),t.next=4,Ko(e);case 4:t.next=9;break;case 6:return t.next=8,e.Zr.stop();case 8:e.Qr.length>0&&(B("RemoteStore","Stopping write stream with ".concat(e.Qr.length," pending writes")),e.Qr=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.Zr}var ou=function(){function e(t,n,r,i,a){C(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new X,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return M(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new J(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function uu(e,t){if(K("AsyncQueue","".concat(t,": ").concat(e)),ii(e))return new J(Y.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var su=function(){function e(t){C(this,e),this.comparator=t?function(e,n){return t(e,n)||Fe.comparator(e.key,n.key)}:function(e,t){return Fe.comparator(e.key,t.key)},this.keyedMap=Nn(),this.sortedSet=new In(this.comparator)}return M(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),cu=function(){function e(){C(this,e),this.eo=new In(Fe.comparator)}return M(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.eo.get(t);n?0!==e.type&&3===n.type?this.eo=this.eo.insert(t,e):3===e.type&&1!==n.type?this.eo=this.eo.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.eo=this.eo.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.eo=this.eo.remove(t):1===e.type&&2===n.type?this.eo=this.eo.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.eo=this.eo.insert(t,{type:2,doc:e.doc}):z():this.eo=this.eo.insert(t,e)}},{key:"no",value:function(){var e=[];return this.eo.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),lu=function(){function e(t,n,r,i,a,o,u,s){C(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=s}return M(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ct(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,su.emptySet(n),a,r,i,!0,!1)}}]),e}(),fu=M(function e(){C(this,e),this.so=void 0,this.listeners=[]}),hu=M(function e(){C(this,e),this.queries=new ea(function(e){return Lt(e)},Ct),this.onlineState="Unknown",this.io=new Set});function du(e,t){return vu.apply(this,arguments)}function vu(){return(vu=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=H(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new fu),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.so=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=uu(e.t0,"Initialization of query '".concat(Mt(n.query),"' failed")),e.abrupt("return",void n.onError(u));case 13:r.queries.set(i,o),o.listeners.push(n),n.ro(r.onlineState),o.so&&n.oo(o.so)&&ku(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])}))).apply(this,arguments)}function pu(e,t){return yu.apply(this,arguments)}function yu(){return(yu=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=H(t),i=n.query,a=!1,(o=r.queries.get(i))&&(u=o.listeners.indexOf(n))>=0&&(o.listeners.splice(u,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mu(e,t){var n,r=H(e),i=!1,a=d(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,u=o.query,s=r.queries.get(u);if(s){var c,l=d(s.listeners);try{for(l.s();!(c=l.n()).done;){c.value.oo(o)&&(i=!0)}}catch(f){l.e(f)}finally{l.f()}s.so=o}}}catch(f){a.e(f)}finally{a.f()}i&&ku(r)}function gu(e,t,n){var r=H(e),i=r.queries.get(t);if(i){var a,o=d(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(u){o.e(u)}finally{o.f()}}r.queries.delete(t)}function ku(e){e.io.forEach(function(e){e.next()})}var wu=function(){function e(t,n,r){C(this,e),this.query=t,this.ao=n,this.co=!1,this.uo=null,this.onlineState="Unknown",this.options=r||{}}return M(e,[{key:"oo",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=d(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new lu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.co?this.ho(e)&&(this.ao.next(e),a=!0):this.lo(e,this.onlineState)&&(this.fo(e),a=!0),this.uo=e,a}},{key:"onError",value:function(e){this.ao.error(e)}},{key:"ro",value:function(e){this.onlineState=e;var t=!1;return this.uo&&!this.co&&this.lo(this.uo,e)&&(this.fo(this.uo),t=!0),t}},{key:"lo",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return!(this.options.wo&&n||e.docs.isEmpty()&&"Offline"!==t)}},{key:"ho",value:function(e){if(e.docChanges.length>0)return!0;var t=this.uo&&this.uo.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"fo",value:function(e){e=lu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.co=!0,this.ao.next(e)}}]),e}(),bu=function(){function e(t,n){C(this,e),this.payload=t,this.byteLength=n}return M(e,[{key:"_o",value:function(){return"metadata"in this.payload}}]),e}(),xu=function(){function e(t){C(this,e),this.k=t}return M(e,[{key:"Hn",value:function(e){return rr(this.k,e)}},{key:"Jn",value:function(e){return e.metadata.exists?cr(this.k,e.document,!1):Ze.newNoDocument(this.Hn(e.metadata.name),this.Yn(e.metadata.readTime))}},{key:"Yn",value:function(e){return $n(e)}}]),e}(),Iu=function(){function e(t,n,r){C(this,e),this.mo=t,this.localStore=n,this.k=r,this.queries=[],this.documents=[],this.progress=Tu(t)}return M(e,[{key:"yo",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"po",value:function(e){var t,n=new Map,r=new xu(this.k),i=d(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var o,u=r.Hn(a.metadata.name),s=d(a.metadata.queries);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=(n.get(c)||Fn()).add(u);n.set(c,l)}}catch(f){s.e(f)}finally{s.f()}}}}catch(f){i.e(f)}finally{i.f()}return n}},{key:"complete",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fa(this.localStore,new xu(this.k),this.documents,this.mo.id);case 2:t=e.sent,n=this.po(this.documents),r=d(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,Pa(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",new va(Object.assign({},this.progress),t)));case 22:case"end":return e.stop()}},e,this,[[5,15,18,21]])}));return function(){return e.apply(this,arguments)}}()}]),e}();function Tu(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var Eu=M(function e(t){C(this,e),this.key=t}),Su=M(function e(t){C(this,e),this.key=t}),Ru=function(){function e(t,n){C(this,e),this.query=t,this.To=n,this.Eo=null,this.current=!1,this.Io=Fn(),this.mutatedKeys=Fn(),this.Ao=Ot(t),this.Ro=new su(this.Ao)}return M(e,[{key:"Po",get:function(){return this.To}},{key:"bo",value:function(e,t){var n=this,r=t?t.vo:new cu,i=t?t.Ro:this.Ro,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s=Tt(this.query)&&i.size===this.query.limit?i.last():null,c=Et(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=Ft(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Vo(l,f)||(r.track({type:2,doc:f}),v=!0,(s&&n.Ao(f,s)>0||c&&n.Ao(f,c)<0)&&(u=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(u=!0)),v&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),Tt(this.query)||Et(this.query))for(;o.size>this.query.limit;){var l=Tt(this.query)?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Ro:o,vo:r,Bn:u,mutatedKeys:a}}},{key:"Vo",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Ro;this.Ro=e.Ro,this.mutatedKeys=e.mutatedKeys;var a=e.vo.no();a.sort(function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return z()}};return n(e)-n(t)}(e.type,t.type)||r.Ao(e.doc,t.doc)}),this.So(n);var o=t?this.Do():[],u=0===this.Io.size&&this.current?1:0,s=u!==this.Eo;return this.Eo=u,0!==a.length||s?{snapshot:new lu(this.query,e.Ro,i,a,e.mutatedKeys,0===u,s,!1),Co:o}:{Co:o}}},{key:"ro",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new cu,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}},{key:"No",value:function(e){return!this.To.has(e)&&!!this.Ro.has(e)&&!this.Ro.get(e).hasLocalMutations}},{key:"So",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.To=t.To.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.To=t.To.delete(e)}),this.current=e.current)}},{key:"Do",value:function(){var e=this;if(!this.current)return[];var t=this.Io;this.Io=Fn(),this.Ro.forEach(function(t){e.No(t.key)&&(e.Io=e.Io.add(t.key))});var n=[];return t.forEach(function(t){e.Io.has(t)||n.push(new Su(t))}),this.Io.forEach(function(e){t.has(e)||n.push(new Eu(e))}),n}},{key:"ko",value:function(e){this.To=e.zn,this.Io=Fn();var t=this.bo(e.documents);return this.applyChanges(t,!0)}},{key:"xo",value:function(){return lu.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}]),e}(),_u=M(function e(t,n,r){C(this,e),this.query=t,this.targetId=n,this.view=r}),Au=M(function e(t){C(this,e),this.key=t,this.$o=!1}),Du=function(){function e(t,n,r,i,a,o){C(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Fo={},this.Oo=new ea(function(e){return Lt(e)},Ct),this.Mo=new Map,this.Lo=new Set,this.Bo=new In(Fe.comparator),this.Uo=new Map,this.qo=new Ua,this.Ko={},this.jo=new Map,this.Qo=Bi.re(),this.onlineState="Unknown",this.Wo=void 0}return M(e,[{key:"isPrimaryClient",get:function(){return!0===this.Wo}}]),e}();function Nu(e,t){return Cu.apply(this,arguments)}function Cu(){return(Cu=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Ts(t),!(o=r.Oo.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.xo(),e.next=15;break;case 6:return e.next=8,Ra(r.localStore,Dt(n));case 8:return u=e.sent,s=r.sharedClientState.addLocalQueryTarget(u.targetId),i=u.targetId,e.next=13,Lu(r,n,i,"current"===s);case 13:a=e.sent,r.isPrimaryClient&&Eo(r.remoteStore,u);case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Lu(e,t,n,r){return Mu.apply(this,arguments)}function Mu(){return(Mu=p(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,u,s,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.Go=function(e,n,r){return(i=p(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.bo(r),e.t0=a.Bn,!e.t0){e.next=6;break}return e.next=5,Da(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.bo(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),u=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(es(t,n.targetId,u.Co),u.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,Da(t.localStore,n,!0);case 3:return a=e.sent,o=new Ru(n,a.zn),u=o.bo(a.documents),s=qn.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(u,t.isPrimaryClient,s),es(t,r,c.Co),l=new _u(n,r,o),e.abrupt("return",(t.Oo.set(n,l),t.Mo.has(r)?t.Mo.get(r).push(n):t.Mo.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Fu(e,t){return Ou.apply(this,arguments)}function Ou(){return(Ou=p(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=H(t),i=r.Oo.get(n),!((a=r.Mo.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.Mo.set(i.targetId,a.filter(function(e){return!Ct(e,n)})),void r.Oo.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,_a(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),So(r.remoteStore,i.targetId),Zu(r,i.targetId)}).catch(Qi);case 9:e.next=14;break;case 11:return Zu(r,i.targetId),e.next=14,_a(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pu(e,t,n){return Vu.apply(this,arguments)}function Vu(){return(Vu=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=Es(t),e.prev=1,e.next=4,function(e,t){var n,r=H(e),i=de.now(),a=t.reduce(function(e,t){return e.add(t.key)},Fn());return r.persistence.runTransaction("Locally write mutations","readwrite",function(e){return r.Wn.vn(e,a).next(function(a){n=a;var o,u=[],s=d(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=sn(c,n.get(c.key));null!=l&&u.push(new hn(c.key,l,Xe(l.value.mapValue),nn.exists(!0)))}}catch(f){s.e(f)}finally{s.f()}return r.An.addMutationBatch(e,i,u,t)})}).then(function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.Ko[e.currentUser.toKey()];r||(r=new In(le)),r=r.insert(t,n),e.Ko[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,rs(i,a.changes);case 9:return e.next=11,Ko(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=uu(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}},e,null,[[1,13]])}))).apply(this,arguments)}function qu(e,t){return Uu.apply(this,arguments)}function Uu(){return(Uu=p(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=H(t),e.prev=1,e.next=4,Ta(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.Uo.get(t);n&&(Q(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.$o=!0:e.modifiedDocuments.size>0?Q(n.$o):e.removedDocuments.size>0&&(Q(n.$o),n.$o=!1))}),e.next=8,rs(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Qi(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])}))).apply(this,arguments)}function Bu(e,t,n){var r=H(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Oo.forEach(function(e,n){var r=n.view.ro(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=H(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=d(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.ro(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&ku(n)}(r.eventManager,t),i.length&&r.Fo.Pr(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Ku(e,t,n){return ju.apply(this,arguments)}function ju(){return(ju=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,u,s,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=H(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.Uo.get(n),!(o=a&&a.key)){e.next=14;break}return u=(u=new In(Fe.comparator)).insert(o,Ze.newNoDocument(o,ve.min())),s=Fn().add(o),c=new Vn(ve.min(),new Map,new Sn(le),u,s),e.next=9,qu(i,c);case 9:i.Bo=i.Bo.remove(o),i.Uo.delete(n),ns(i),e.next=16;break;case 14:return e.next=16,_a(i.localStore,n,!1).then(function(){return Zu(i,n,r)}).catch(Qi);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Gu(e,t){return zu.apply(this,arguments)}function zu(){return(zu=p(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=H(t),i=n.batch.batchId,e.prev=1,e.next=4,xa(r.localStore,n);case 4:return a=e.sent,Xu(r,i,null),Ju(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,rs(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Qi(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function Qu(e,t,n){return Wu.apply(this,arguments)}function Wu(){return(Wu=p(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=H(t),e.prev=1,e.next=4,function(e,t){var n=H(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.An.lookupMutationBatch(e,t).next(function(t){return Q(null!==t),r=t.keys(),n.An.removeMutationBatch(e,t)}).next(function(){return n.An.performConsistencyCheck(e)}).next(function(){return n.Wn.vn(e,r)})})}(i.localStore,n);case 4:return a=e.sent,Xu(i,n,r),Ju(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,rs(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Qi(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}function Hu(e,t){return Yu.apply(this,arguments)}function Yu(){return(Yu=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return No((r=H(t)).remoteStore)||B("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=H(r.localStore);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(e){return t.An.getHighestUnacknowledgedBatchId(e)})}();case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.jo.get(i)||[]).push(n),r.jo.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),o=uu(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(o);case 16:case"end":return e.stop()}},e,null,[[2,12]])}))).apply(this,arguments)}function Ju(e,t){(e.jo.get(t)||[]).forEach(function(e){e.resolve()}),e.jo.delete(t)}function Xu(e,t,n){var r=H(e),i=r.Ko[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.Ko[r.currentUser.toKey()]=i}}function Zu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=d(e.Mo.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.Oo.delete(a),n&&e.Fo.zo(a,n)}}catch(o){i.e(o)}finally{i.f()}e.Mo.delete(t),e.isPrimaryClient&&e.qo.us(t).forEach(function(t){e.qo.containsKey(t)||$u(e,t)})}function $u(e,t){e.Lo.delete(t.path.canonicalString());var n=e.Bo.get(t);null!==n&&(So(e.remoteStore,n),e.Bo=e.Bo.remove(t),e.Uo.delete(n),ns(e))}function es(e,t,n){var r,i=d(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof Eu?(e.qo.addReference(a.key,t),ts(e,a)):a instanceof Su?(B("SyncEngine","Document no longer in limbo: "+a.key),e.qo.removeReference(a.key,t),e.qo.containsKey(a.key)||$u(e,a.key)):z()}}catch(o){i.e(o)}finally{i.f()}}function ts(e,t){var n=t.key,r=n.path.canonicalString();e.Bo.get(n)||e.Lo.has(r)||(B("SyncEngine","New document in limbo: "+n),e.Lo.add(r),ns(e))}function ns(e){for(;e.Lo.size>0&&e.Bo.size<e.maxConcurrentLimboResolutions;){var t=e.Lo.values().next().value;e.Lo.delete(t);var n=new Fe(ke.fromString(t)),r=e.Qo.next();e.Uo.set(r,new Au(n)),e.Bo=e.Bo.insert(n,r),Eo(e.remoteStore,new di(Dt(It(n.path)),r,2,ue.I))}}function rs(e,t,n){return is.apply(this,arguments)}function is(){return(is=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=H(t),a=[],o=[],u=[],e.t0=i.Oo.isEmpty(),e.t0){e.next=9;break}return i.Oo.forEach(function(e,t){u.push(i.Go(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=ya.$n(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(u);case 6:return i.Fo.Pr(a),e.next=9,function(){var e=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u,s,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=H(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return $r.forEach(n,function(t){return $r.forEach(t.kn,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return $r.forEach(t.xn,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),ii(e.t0)){e.next=10;break}throw e.t0;case 10:B("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=d(n);try{for(i.s();!(a=i.n()).done;)o=a.value,u=o.targetId,o.fromCache||(s=r.qn.get(u),c=s.snapshotVersion,l=s.withLastLimboFreeSnapshotVersion(c),r.qn=r.qn.insert(u,l))}catch(f){i.e(f)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,o);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function as(e,t){return os.apply(this,arguments)}function os(){return(os=p(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=H(t)).currentUser.isEqual(n)){e.next=11;break}return B("SyncEngine","User change. New user:",n.toKey()),e.next=5,wa(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.jo.forEach(function(e){e.forEach(function(e){e.reject(new J(Y.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.jo.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,rs(r,i.Gn);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function us(e,t){var n=H(e),r=n.Uo.get(t);if(r&&r.$o)return Fn().add(r.key);var i=Fn(),a=n.Mo.get(t);if(!a)return i;var o,u=d(a);try{for(u.s();!(o=u.n()).done;){var s=o.value,c=n.Oo.get(s);i=i.unionWith(c.view.Po)}}catch(l){u.e(l)}finally{u.f()}return i}function ss(e,t){return cs.apply(this,arguments)}function cs(){return(cs=p(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=H(t),e.next=3,Da(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.ko(i),e.abrupt("return",(r.isPrimaryClient&&es(r,n.targetId,a.Co),a));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ls(e){return fs.apply(this,arguments)}function fs(){return(fs=p(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=H(t),e.abrupt("return",Ca(n.localStore).then(function(e){return rs(n,e)}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function hs(e,t,n,r){return ds.apply(this,arguments)}function ds(){return(ds=p(regeneratorRuntime.mark(function e(t,n,r,i){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=H(t),e.next=3,function(e,t){var n=H(e),r=H(n.An);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return r.Zt(e,t).next(function(t){return t?n.Wn.vn(e,t):$r.resolve(null)})})}(a.localStore,n);case 3:if(null===(o=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,Ko(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(Xu(a,n,i||null),Ju(a,n),function(e,t){H(H(e).An).ee(t)}(a.localStore,n)):z();case 11:return e.next=13,rs(a,o);case 13:e.next=16;break;case 15:B("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vs(e,t){return ps.apply(this,arguments)}function ps(){return(ps=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u,s,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ts(r=H(t)),Es(r),!0!==n||!0===r.Wo){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,ys(r,i.toArray());case 5:return a=e.sent,r.Wo=!0,e.next=9,nu(r.remoteStore,!0);case 9:o=d(a);try{for(o.s();!(u=o.n()).done;)s=u.value,Eo(r.remoteStore,s)}catch(f){o.e(f)}finally{o.f()}e.next=25;break;case 13:if(!1!==n||!1===r.Wo){e.next=25;break}return c=[],l=Promise.resolve(),r.Mo.forEach(function(e,t){r.sharedClientState.isLocalQueryTarget(t)?c.push(t):l=l.then(function(){return Zu(r,t),_a(r.localStore,t,!0)}),So(r.remoteStore,t)}),e.next=19,l;case 19:return e.next=21,ys(r,c);case 21:return function(e){var t=H(r);t.Uo.forEach(function(e,n){So(t.remoteStore,n)}),t.qo.hs(),t.Uo=new Map,t.Bo=new In(Fe.comparator)}(),r.Wo=!1,e.next=25,nu(r.remoteStore,!1);case 25:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ys(e,t,n){return ms.apply(this,arguments)}function ms(){return(ms=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,u,s,c,l,f,h,v,p,y,m,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=H(t),a=[],o=[],u=d(n),e.prev=2,u.s();case 4:if((s=u.n()).done){e.next=45;break}if(c=s.value,l=void 0,!(f=i.Mo.get(c))||0===f.length){e.next=34;break}return e.next=11,Ra(i.localStore,Dt(f[0]));case 11:l=e.sent,h=d(f),e.prev=13,h.s();case 15:if((v=h.n()).done){e.next=24;break}return p=v.value,y=i.Oo.get(p),e.next=20,ss(i,y);case 20:(m=e.sent).snapshot&&o.push(m.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),h.e(e.t0);case 29:return e.prev=29,h.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,Na(i.localStore,c);case 36:return g=e.sent,e.next=39,Ra(i.localStore,g);case 39:return l=e.sent,e.next=42,Lu(i,gs(g),c,!1);case 42:a.push(l);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),u.e(e.t1);case 50:return e.prev=50,u.f(),e.finish(50);case 53:return e.abrupt("return",(i.Fo.Pr(o),a));case 54:case"end":return e.stop()}},e,null,[[2,47,50,53],[13,26,29,32]])}))).apply(this,arguments)}function gs(e){return xt(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function ks(e){var t=H(e);return H(H(t.localStore).persistence).Tn()}function ws(e,t,n,r){return bs.apply(this,arguments)}function bs(){return(bs=p(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=H(t)).Wo){e.next=5;break}B("SyncEngine","Ignoring unexpected query state notification."),e.next=21;break;case 5:if(!a.Mo.has(n)){e.next=21;break}e.t0=r,e.next="current"===e.t0?9:"not-current"===e.t0?9:"rejected"===e.t0?16:20;break;case 9:return e.next=11,Ca(a.localStore);case 11:return o=e.sent,u=Vn.createSynthesizedRemoteEventForCurrentChange(n,"current"===r),e.next=15,rs(a,o,u);case 15:return e.abrupt("break",21);case 16:return e.next=18,_a(a.localStore,n,!0);case 18:return Zu(a,n,i),e.abrupt("break",21);case 20:z();case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xs(e,t,n){return Is.apply(this,arguments)}function Is(){return(Is=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,u,s,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=Ts(t)).Wo){e.next=45;break}a=d(n),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=21;break}if(u=o.value,!i.Mo.has(u)){e.next=10;break}return B("SyncEngine","Adding an already active target "+u),e.abrupt("continue",19);case 10:return e.next=12,Na(i.localStore,u);case 12:return s=e.sent,e.next=15,Ra(i.localStore,s);case 15:return c=e.sent,e.next=18,Lu(i,gs(s),c.targetId,!1);case 18:Eo(i.remoteStore,c);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:l=d(r),e.prev=30,h=regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.value,e.t0=i.Mo.has(t),!e.t0){e.next=5;break}return e.next=5,_a(i.localStore,t,!1).then(function(){So(i.remoteStore,t),Zu(i,t)}).catch(Qi);case 5:case"end":return e.stop()}},e)}),l.s();case 33:if((f=l.n()).done){e.next=37;break}return e.delegateYield(h(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),l.e(e.t2);case 42:return e.prev=42,l.f(),e.finish(42);case 45:case"end":return e.stop()}},e,null,[[3,23,26,29],[30,39,42,45]])}))).apply(this,arguments)}function Ts(e){var t=H(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=qu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=us.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ku.bind(null,t),t.Fo.Pr=mu.bind(null,t.eventManager),t.Fo.zo=gu.bind(null,t.eventManager),t}function Es(e){var t=H(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Gu.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Qu.bind(null,t),t}function Ss(e,t,n){var r,i=H(e);(r=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=H(e),r=$n(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",function(e){return n.Ye.getBundleMetadata(e,t.id)}).then(function(e){return!!e&&e.createTime.compareTo(r)>=0})}(t.localStore,i);case 6:if(!e.sent){e.next=10;break}return e.next=9,n.close();case 9:return e.abrupt("return",void r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)));case 10:return r._updateProgress(Tu(i)),a=new Iu(i,t.localStore,n.k),e.next=14,n.Ho();case 14:o=e.sent;case 15:if(!o){e.next=25;break}return e.next=18,a.yo(o);case 18:return(u=e.sent)&&r._updateProgress(u),e.next=22,n.Ho();case 22:o=e.sent;case 23:e.next=15;break;case 25:return e.next=27,a.complete();case 27:return s=e.sent,e.next=30,rs(t,s.In,void 0);case 30:return e.next=32,function(e,t){var n=H(e);return n.persistence.runTransaction("Save bundle","readwrite",function(e){return n.Ye.saveBundleMetadata(e,t)})}(t.localStore,i);case 32:r._completeWith(s.progress),e.next=38;break;case 35:e.prev=35,e.t0=e.catch(0),j("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0);case 38:case"end":return e.stop()}},e,null,[[0,35]])})),function(e,t,n){return r.apply(this,arguments)})(i,t,n).then(function(){i.sharedClientState.notifyBundleLoaded()})}var Rs=function(){function e(){C(this,e),this.synchronizeTabs=!1}return M(e,[{key:"initialize",value:function(){var e=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.k=ho(t.databaseInfo.databaseId),this.sharedClientState=this.Jo(t),this.persistence=this.Yo(t),e.next=5,this.persistence.start();case 5:this.gcScheduler=this.Xo(t),this.localStore=this.Zo(t);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Xo",value:function(e){return null}},{key:"Zo",value:function(e){return ka(this.persistence,new ma,e.initialUser,this.k)}},{key:"Yo",value:function(e){return new Qa(Ha.ks,this.k)}},{key:"Jo",value:function(e){return new io}},{key:"terminate",value:function(){var e=p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),_s=function(e){y(n,Rs);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this)).ta=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return M(n,[{key:"initialize",value:function(){var e=p(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(E(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,La(this.localStore);case 4:return e.next=6,this.ta.initialize(this,t);case 6:return e.next=8,Es(this.ta.syncEngine);case 8:return e.next=10,Ko(this.ta.remoteStore);case 10:return e.next=12,this.persistence.sn(function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(r.localStore),Promise.resolve()});case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Zo",value:function(e){return ka(this.persistence,new ma,e.initialUser,this.k)}},{key:"Xo",value:function(e){var t=this.persistence.referenceDelegate.garbageCollector;return new Ji(t,e.asyncQueue)}},{key:"Yo",value:function(e){var t=da(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Li.withCacheSize(this.cacheSizeBytes):Li.DEFAULT;return new la(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,lo(),fo(),this.k,this.sharedClientState,!!this.forceOwnership)}},{key:"Jo",value:function(e){return new io}}]),n}(),As=function(e){y(n,_s);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,e,r,!1)).ta=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return M(n,[{key:"initialize",value:function(){var e=p(regeneratorRuntime.mark(function e(t){var r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(E(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.ta.syncEngine,e.t0=this.sharedClientState instanceof ro,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={mi:hs.bind(null,r),gi:ws.bind(null,r),yi:xs.bind(null,r),Tn:ks.bind(null,r),_i:ls.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.sn(function(){var e=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vs(i.ta.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start(i.localStore):t||i.gcScheduler.stop());case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"Jo",value:function(e){var t=lo();if(!ro.bt(t))throw new J(Y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=da(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ro(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(),Ds=function(){function e(){C(this,e)}return M(e,[{key:"initialize",value:function(){var e=p(regeneratorRuntime.mark(function e(t,n){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return Bu(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=as.bind(null,this.syncEngine),e.next=12,nu(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new hu}},{key:"createDatastore",value:function(e){var t,n=ho(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new co(t));return function(e,t,n,r){return new go(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return Bu(o.syncEngine,e,0)},a=oo.bt()?new oo:new ao,new wo(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new Du(e,t,n,r,i,a);return o&&(u.Wo=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return(e=p(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=H(t),B("RemoteStore","RemoteStore shutting down."),n.Gr.add(5),e.next=5,Io(n);case 5:n.Hr.shutdown(),n.Jr.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}();function Ns(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return p(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}},r)}))()},cancel:function(){return p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Cs=function(){function e(t){C(this,e),this.observer=t,this.muted=!1}return M(e,[{key:"next",value:function(e){this.observer.next&&this.ea(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.ea(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"na",value:function(){this.muted=!0}},{key:"ea",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),Ls=function(){function e(t,n){var r=this;C(this,e),this.sa=t,this.k=n,this.metadata=new X,this.buffer=new Uint8Array,this.ia=new TextDecoder("utf-8"),this.ra().then(function(e){e&&e._o()?r.metadata.resolve(e.payload.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.payload))))},function(e){return r.metadata.reject(e)})}return M(e,[{key:"close",value:function(){return this.sa.cancel()}},{key:"getMetadata",value:function(){var e=p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Ho",value:function(){var e=p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.ra());case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"ra",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.oa();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.ia.decode(t),r=Number(n),isNaN(r)&&this.aa("length string (".concat(n,") is not valid number")),e.next=9,this.ca(r);case 9:return i=e.sent,e.abrupt("return",new bu(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"ua",value:function(){return this.buffer.findIndex(function(e){return e==="{".charCodeAt(0)})}},{key:"oa",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.ua()<0)){e.next=7;break}return e.next=3,this.ha();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.ua())<0&&this.aa("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"ca",value:function(){var e=p(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.ha();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.aa("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.ia.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"aa",value:function(e){throw this.sa.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"ha",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sa.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),Ms=function(){function e(t){C(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return M(e,[{key:"lookup",value:function(){var e=p(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new J(Y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=p(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=H(t),i=or(r.k)+"/documents",a={documents:n.map(function(e){return nr(r.k,e)})},e.next=5,r.ji("BatchGetDocuments",i,a);case 5:return o=e.sent,u=new Map,o.forEach(function(e){var t=lr(r.k,e);u.set(t.key.toString(),t)}),s=[],e.abrupt("return",(n.forEach(function(e){var t=u.get(e.toString());Q(!!t),s.push(t)}),s));case 10:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach(function(e){return r.recordVersion(e)}),n));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new gn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(e,t){var r=Fe.fromPath(t);n.mutations.push(new kn(r,n.precondition(r)))}),e.next=7,function(){var e=p(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=H(t),i=or(r.k)+"/documents",a={writes:n.map(function(e){return hr(r.k,e)})},e.next=3,r.Bi("Commit",i,a);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw z();t=ve.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new J(Y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?nn.updateTime(t):nn.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ve.min()))throw new J(Y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return nn.updateTime(t)}return nn.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),Fs=function(){function e(t,n,r,i){C(this,e),this.asyncQueue=t,this.datastore=n,this.updateFunction=r,this.deferred=i,this.la=5,this.ur=new vo(this.asyncQueue,"transaction_retry")}return M(e,[{key:"run",value:function(){this.la-=1,this.fa()}},{key:"fa",value:function(){var e=this;this.ur.Zi(p(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=new Ms(e.datastore),(r=e.da(n))&&r.then(function(t){e.asyncQueue.enqueueAndForget(function(){return n.commit().then(function(){e.deferred.resolve(t)}).catch(function(t){e.wa(t)})})}).catch(function(t){e.wa(t)});case 2:case"end":return t.stop()}},t)})))}},{key:"da",value:function(e){try{var t=this.updateFunction(e);return!Ce(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"wa",value:function(e){var t=this;this.la>0&&this._a(e)?(this.la-=1,this.asyncQueue.enqueueAndForget(function(){return t.fa(),Promise.resolve()})):this.deferred.reject(e)}},{key:"_a",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!bn(t)}return!1}}]),e}(),Os=function(){function e(t,n,r,i){var a=this;C(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=O.UNAUTHENTICATED,this.clientId=ce.A(),this.authCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return B("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,function(){return Promise.resolve()})}return M(e,[{key:"getConfiguration",value:function(){var e=p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new J(Y.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new X;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(p(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=uu(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function Ps(e,t){return Vs.apply(this,arguments)}function Vs(){return(Vs=p(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),B("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,wa(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function qs(e,t){return Us.apply(this,arguments)}function Us(){return(Us=p(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,Bs(t);case 3:return r=e.sent,B("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return(t=p(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=H(t)).asyncQueue.verifyOperationInProgress(),B("RemoteStore","RemoteStore received new credentials"),i=No(r),r.Gr.add(3),e.next=6,Io(r);case 6:return i&&r.Jr.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.Gr.delete(3),e.next=12,bo(r);case 12:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)})(n.remoteStore,e);var t}),t.onlineComponents=n;case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Bs(e){return Ks.apply(this,arguments)}function Ks(){return(Ks=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return B("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,Ps(t,new Rs);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function js(e){return Gs.apply(this,arguments)}function Gs(){return(Gs=p(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return B("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,qs(t,new Ds);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zs(e){return Bs(e).then(function(e){return e.persistence})}function Qs(e){return Bs(e).then(function(e){return e.localStore})}function Ws(e){return js(e).then(function(e){return e.remoteStore})}function Hs(e){return js(e).then(function(e){return e.syncEngine})}function Ys(e){return Js.apply(this,arguments)}function Js(){return(Js=p(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,js(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=Nu.bind(null,n.syncEngine),r.onUnlisten=Fu.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Xs(e){return e.asyncQueue.enqueue(p(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,zs(e);case 2:return n=t.sent,t.next=5,Ws(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=H(r);return t.Gr.delete(0),bo(t)}()));case 7:case"end":return t.stop()}},t)})))}function Zs(e){return e.asyncQueue.enqueue(p(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,zs(e);case 2:return n=t.sent,t.next=5,Ws(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=p(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=H(t)).Gr.add(0),e.next=4,Io(n);case 4:n.Jr.set("Offline");case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}},t)})))}function $s(e,t){var n=new X;return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=p(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=H(e);return n.persistence.runTransaction("read document","readonly",function(e){return n.Wn.Rn(e,t)})}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new J(Y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=uu(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,Qs(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}function ec(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new X;return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Cs({next:function(a){t.enqueueAndForget(function(){return pu(e,o)});var u=a.docs.has(n);!u&&a.fromCache?i.reject(new J(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new J(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new wu(It(n.path),a,{includeMetadataChanges:!0,wo:!0});return du(e,o)},i.next=3,Ys(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}function tc(e,t){var n=new X;return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=p(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Da(t,n,!0);case 3:i=e.sent,a=new Ru(n,i.zn),o=a.bo(i.documents),u=a.applyChanges(o,!1),r.resolve(u.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),s=uu(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(s);case 14:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,Qs(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}function nc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new X;return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Cs({next:function(n){t.enqueueAndForget(function(){return pu(e,o)}),n.fromCache&&"server"===r.source?i.reject(new J(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new wu(n,a,{includeMetadataChanges:!0,wo:!0});return du(e,o)},i.next=3,Ys(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}function rc(e,t){var n=new Cs(t);return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){H(e).io.add(t),t.next()},t.next=3,Ys(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){n.na(),e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){H(e).io.delete(t)},t.next=3,Ys(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}function ic(e,t){var n=new X;return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e){return js(e).then(function(e){return e.datastore})}(e);case 2:i=r.sent,new Fs(e.asyncQueue,i,t,n).run();case 4:case"end":return r.stop()}},r)}))),n.promise}function ac(e,t,n,r){var i=function(e,t){return function(e,t){return new Ls(e,t)}(function(e,t){if(e instanceof Uint8Array)return Ns(e,t);if(e instanceof ArrayBuffer)return Ns(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,ho(t));e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Ss,t.next=3,Hs(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}},t)})))}function oc(e,t){return e.asyncQueue.enqueue(p(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=H(e);return n.persistence.runTransaction("Get named query","readonly",function(e){return n.Ye.getNamedQuery(e,t)})},n.next=3,Qs(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)})))}var uc=M(function e(t,n,r,i,a,o,u,s){C(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.useFetchStreams=s}),sc=function(){function e(t,n){C(this,e),this.projectId=t,this.database=n||"(default)"}return M(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}]),e}();exports._DatabaseId=sc;var cc=new Map;function lc(e,t,n){if(!n)throw new J(Y.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function fc(e,t,n,r){if(!0===t&&!0===r)throw new J(Y.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function hc(e){if(!Fe.isDocumentKey(e))throw new J(Y.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function dc(e){if(Fe.isDocumentKey(e))throw new J(Y.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function vc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==h(e)){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":z()}function pc(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new J(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=vc(e);throw new J(Y.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function yc(e,t){if(t<=0)throw new J(Y.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var mc=function(){function e(t){var n;if(C(this,e),void 0===t.host){if(void 0!==t.ssl)throw new J(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new J(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,fc("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return M(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),gc=function(){function e(t,n,r){C(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mc({}),this._settingsFrozen=!1,t instanceof sc?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new J(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sc(e.options.projectId)}(t))}return M(e,[{key:"app",get:function(){if(!this._app)throw new J(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new J(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mc(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new $;switch(e.type){case"gapi":var t=e.client;return Q(!("object"!=h(t)||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new re(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new J(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=cc.get(e))&&(B("ComponentProvider","Removing Datastore"),cc.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}();function kc(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=(e=pc(e,gc))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==t&&j("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},o),{host:"".concat(t,":").concat(n),ssl:!1})),a.mockUserToken){var u,s;if("string"==typeof a.mockUserToken)u=a.mockUserToken,s=O.MOCK_USER;else{u=(0,i.createMockUserToken)(a.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var c=a.mockUserToken.sub||a.mockUserToken.user_id;if(!c)throw new J(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new O(c)}e._authCredentials=new ee(new Z(u,s))}}var wc=function(){function e(t,n,r){C(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return M(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new xc(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}();exports.DocumentReference=wc;var bc=function(){function e(t,n,r){C(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return M(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}();exports.Query=bc;var xc=function(e){y(n,bc);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this,e,r,It(i)))._path=i,a.type="collection",a}return M(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new wc(this.firestore,null,new Fe(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}();function Ic(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,i.getModularInstance)(e),lc("collection","path",t),e instanceof gc){var o=ke.fromString.apply(ke,[t].concat(r));return dc(o),new xc(e,null,o)}if(!(e instanceof wc||e instanceof xc))throw new J(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var u=e._path.child(ke.fromString.apply(ke,[t].concat(r)));return dc(u),new xc(e.firestore,null,u)}function Tc(e,t){if(e=pc(e,gc),lc("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new J(Y.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new bc(e,null,function(e){return new bt(ke.emptyPath(),e)}(t))}function Ec(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=(0,i.getModularInstance)(e),1===arguments.length&&(t=ce.A()),lc("doc","path",t),e instanceof gc){var o=ke.fromString.apply(ke,[t].concat(r));return hc(o),new wc(e,null,new Fe(o))}if(!(e instanceof wc||e instanceof xc))throw new J(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var u=e._path.child(ke.fromString.apply(ke,[t].concat(r)));return hc(u),new wc(e.firestore,e instanceof xc?e.converter:null,new Fe(u))}function Sc(e,t){return e=(0,i.getModularInstance)(e),t=(0,i.getModularInstance)(t),(e instanceof wc||e instanceof xc)&&(t instanceof wc||t instanceof xc)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Rc(e,t){return e=(0,i.getModularInstance)(e),t=(0,i.getModularInstance)(t),e instanceof bc&&t instanceof bc&&e.firestore===t.firestore&&Ct(e._query,t._query)&&e.converter===t.converter}exports.CollectionReference=xc;var _c=function(){function e(){var t=this;C(this,e),this.ma=Promise.resolve(),this.ga=[],this.ya=!1,this.pa=[],this.Ta=null,this.Ea=!1,this.Ia=!1,this.Aa=[],this.ur=new vo(this,"async_queue_retry"),this.Ra=function(){var e=fo();e&&B("AsyncQueue","Visibility state changed to "+e.visibilityState),t.ur.er()};var n=fo();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Ra)}return M(e,[{key:"isShuttingDown",get:function(){return this.ya}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Pa(),this.ba(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.ya){this.ya=!0,this.Ia=e||!1;var t=fo();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ra)}}},{key:"enqueue",value:function(e){var t=this;if(this.Pa(),this.ya)return new Promise(function(){});var n=new X;return this.ba(function(){return t.ya&&t.Ia?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.ga.push(e),t.va()})}},{key:"va",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.ga.length){e.next=14;break}return e.prev=1,e.next=4,this.ga[0]();case 4:this.ga.shift(),this.ur.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),ii(e.t0)){e.next=12;break}throw e.t0;case 12:B("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.ga.length>0&&this.ur.Zi(function(){return t.va()});case 14:case"end":return e.stop()}},e,this,[[1,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"ba",value:function(e){var t=this,n=this.ma.then(function(){return t.Ea=!0,e().catch(function(e){throw t.Ta=e,t.Ea=!1,K("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(function(e){return t.Ea=!1,e})});return this.ma=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Pa(),this.Aa.indexOf(e)>-1&&(t=0);var i=ou.createAndSchedule(this,e,t,n,function(e){return r.Va(e)});return this.pa.push(i),i}},{key:"Pa",value:function(){this.Ta&&z()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Sa",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ma,e.next=3,t;case 3:if(t!==this.ma){e.next=0;break}case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"Da",value:function(e){var t,n=d(this.pa);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Ca",value:function(e){var t=this;return this.Sa().then(function(){t.pa.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=d(t.pa);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.Sa()})}},{key:"Na",value:function(e){this.Aa.push(e)}},{key:"Va",value:function(e){var t=this.pa.indexOf(e);this.pa.splice(t,1)}}]),e}();function Ac(e){return function(e,t){if("object"!=h(e)||null===e)return!1;var n,r=e,i=d(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e)}var Dc=function(){function e(){C(this,e),this._progressObserver={},this._taskCompletionResolver=new X,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return M(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}();exports.LoadBundleTask=Dc;var Nc=-1;exports.CACHE_SIZE_UNLIMITED=Nc;var Cc=function(e){y(n,gc);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new _c,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return M(n,[{key:"_terminate",value:function(){return this._firestoreClient||Oc(this),this._firestoreClient.terminate()}}]),n}();function Lc(e,n){var r=(0,t._getProvider)(e,"firestore");if(r.isInitialized()){var a=r.getImmediate(),o=r.getOptions();if((0,i.deepEqual)(o,n))return a;throw new J(Y.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==n.cacheSizeBytes&&-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new J(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:n})}function Mc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,t.getApp)();return(0,t._getProvider)(e,"firestore").getImmediate()}function Fc(e){return e._firestoreClient||Oc(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Oc(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new uc(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Os(e._authCredentials,e._appCheckCredentials,e._queue,r)}function Pc(e,t){Wc(e=pc(e,Cc));var n=Fc(e),r=e._freezeSettings(),i=new Ds;return qc(n,i,new _s(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function Vc(e){Wc(e=pc(e,Cc));var t=Fc(e),n=e._freezeSettings(),r=new Ds;return qc(t,r,new As(r,n.cacheSizeBytes))}function qc(e,t,n){var r=new X;return e.asyncQueue.enqueue(p(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Ps(e,n);case 3:return i.next=5,qs(e,t);case 5:r.resolve(),i.next=13;break;case 8:if(i.prev=8,i.t0=i.catch(0),function(e){return"FirebaseError"===e.name?e.code===Y.FAILED_PRECONDITION||e.code===Y.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(i.t0)){i.next=12;break}throw i.t0;case 12:console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i.t0),r.reject(i.t0);case 13:case"end":return i.stop()}},i,null,[[0,8]])}))).then(function(){return r.promise})}function Uc(e){if(e._initialized&&!e._terminated)throw new J(Y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new X;return e._queue.enqueueAndForgetEvenWhileRestricted(p(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=p(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ti.bt()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,ti.delete(n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()(da(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}},n,null,[[0,6]])}))),t.promise}function Bc(e){return function(e){var t=new X;return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Hu,n.next=3,Hs(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}},n)}))),t.promise}(Fc(e=pc(e,Cc)))}function Kc(e){return Xs(Fc(e=pc(e,Cc)))}function jc(e){return Zs(Fc(e=pc(e,Cc)))}function Gc(e){return(0,t._removeServiceInstance)(e.app,"firestore"),e._delete()}function zc(e,t){var n=Fc(e=pc(e,Cc)),r=new Dc;return ac(n,e._databaseId,t,r),r}function Qc(e,t){return oc(Fc(e=pc(e,Cc)),t).then(function(t){return t?new bc(e,null,t.query):null})}function Wc(e){if(e._initialized||e._terminated)throw new J(Y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}exports.Firestore=Cc;var Hc=function(){function e(){C(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new J(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new be(n)}return M(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();function Yc(){return new Hc("__name__")}exports.FieldPath=Hc;var Jc=function(){function e(t){C(this,e),this._byteString=t}return M(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Te.fromBase64String(t))}catch(t){throw new J(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Te.fromUint8Array(t))}}]),e}();exports.Bytes=Jc;var Xc=M(function e(t){C(this,e),this._methodName=t});exports.FieldValue=Xc;var Zc=function(){function e(t,n){if(C(this,e),!isFinite(t)||t<-90||t>90)throw new J(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new J(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return M(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return le(this._lat,e._lat)||le(this._long,e._long)}}]),e}();exports.GeoPoint=Zc;var $c=/^__.*__$/,el=function(){function e(t,n,r){C(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return M(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new hn(e,this.data,this.fieldMask,t,this.fieldTransforms):new fn(e,this.data,t,this.fieldTransforms)}}]),e}(),tl=function(){function e(t,n,r){C(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return M(e,[{key:"toMutation",value:function(e,t){return new hn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function nl(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw z()}}var rl=function(){function e(t,n,r,i,a,o){C(this,e),this.settings=t,this.databaseId=n,this.k=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ka(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return M(e,[{key:"path",get:function(){return this.settings.path}},{key:"xa",get:function(){return this.settings.xa}},{key:"$a",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Fa",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.$a({path:n,Oa:!1});return r.Ma(e),r}},{key:"La",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.$a({path:n,Oa:!1});return r.ka(),r}},{key:"Ba",value:function(e){return this.$a({path:void 0,Oa:!0})}},{key:"Ua",value:function(e){return Il(e,this.settings.methodName,this.settings.qa||!1,this.path,this.settings.Ka)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"ka",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.Ma(this.path.get(e))}},{key:"Ma",value:function(e){if(0===e.length)throw this.Ua("Document fields must not be empty");if(nl(this.xa)&&$c.test(e))throw this.Ua('Document fields cannot begin and end with "__"')}}]),e}(),il=function(){function e(t,n,r){C(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.k=r||ho(t)}return M(e,[{key:"ja",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new rl({xa:e,methodName:t,Ka:n,path:be.emptyPath(),Oa:!1,qa:r},this.databaseId,this.k,this.ignoreUndefinedProperties)}}]),e}();function al(e){var t=e._freezeSettings(),n=ho(e._databaseId);return new il(e._databaseId,!!t.ignoreUndefinedProperties,n)}function ol(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.ja(a.merge||a.mergeFields?2:0,t,n,i);kl("Data must be an object, but it was:",o,r);var u,s,c=ml(r,o);if(a.merge)u=new xe(o.fieldMask),s=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=d(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var v=wl(t,l.value,n);if(!o.contains(v))throw new J(Y.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));Tl(f,v)||f.push(v)}}catch(p){h.e(p)}finally{h.f()}u=new xe(f),s=o.fieldTransforms.filter(function(e){return u.covers(e.field)})}else u=null,s=o.fieldTransforms;return new el(new Je(c),u,s)}var ul=function(e){y(n,Xc);var t=m(n);function n(){return C(this,n),t.apply(this,arguments)}return M(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.xa)throw 1===e.xa?e.Ua("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Ua("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}();function sl(e,t,n){return new rl({xa:3,Ka:t.settings.Ka,methodName:e._methodName,Oa:n},t.databaseId,t.k,t.ignoreUndefinedProperties)}var cl=function(e){y(n,Xc);var t=m(n);function n(){return C(this,n),t.apply(this,arguments)}return M(n,[{key:"_toFieldTransform",value:function(e){return new $t(e.path,new zt)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(),ll=function(e){y(n,Xc);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,e)).Qa=r,i}return M(n,[{key:"_toFieldTransform",value:function(e){var t=sl(this,e,!0),n=this.Qa.map(function(e){return yl(e,t)}),r=new Qt(n);return new $t(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(),fl=function(e){y(n,Xc);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,e)).Qa=r,i}return M(n,[{key:"_toFieldTransform",value:function(e){var t=sl(this,e,!0),n=this.Qa.map(function(e){return yl(e,t)}),r=new Ht(n);return new $t(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(),hl=function(e){y(n,Xc);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,e)).Wa=r,i}return M(n,[{key:"_toFieldTransform",value:function(e){var t=new Jt(e.k,Ut(e.k,this.Wa));return new $t(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}();function dl(e,t,n,r){var a=e.ja(1,t,n);kl("Data must be an object, but it was:",a,r);var o=[],u=Je.empty();ye(r,function(e,r){var s=xl(t,e,n);r=(0,i.getModularInstance)(r);var c=a.La(s);if(r instanceof ul)o.push(s);else{var l=yl(r,c);null!=l&&(o.push(s),u.set(s,l))}});var s=new xe(o);return new tl(u,s,a.fieldTransforms)}function vl(e,t,n,r,a,o){var u=e.ja(1,t,n),s=[wl(t,r,n)],c=[a];if(o.length%2!=0)throw new J(Y.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var l=0;l<o.length;l+=2)s.push(wl(t,o[l])),c.push(o[l+1]);for(var f=[],h=Je.empty(),d=s.length-1;d>=0;--d)if(!Tl(f,s[d])){var v=s[d],p=c[d];p=(0,i.getModularInstance)(p);var y=u.La(v);if(p instanceof ul)f.push(v);else{var m=yl(p,y);null!=m&&(f.push(v),h.set(v,m))}}var g=new xe(f);return new tl(h,g,u.fieldTransforms)}function pl(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return yl(n,e.ja(r?4:3,t))}function yl(e,t){if(gl(e=(0,i.getModularInstance)(e)))return kl("Unsupported field value:",t,e),ml(e,t);if(e instanceof Xc)return function(e,t){if(!nl(t.xa))throw t.Ua("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Ua("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Oa&&4!==t.xa)throw t.Ua("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=d(e);try{for(a.s();!(n=a.n()).done;){var o=yl(n.value,t.Ba(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(u){a.e(u)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=(0,i.getModularInstance)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ut(t.k,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=de.fromDate(e);return{timestampValue:Jn(t.k,n)}}if(e instanceof de){var r=new de(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Jn(t.k,r)}}if(e instanceof Zc)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Jc)return{bytesValue:Xn(t.k,e._byteString)};if(e instanceof wc){var a=t.databaseId,o=e.firestore._databaseId;if(!o.isEqual(a))throw t.Ua("Document reference is for database ".concat(o.projectId,"/").concat(o.database," but should be for database ").concat(a.projectId,"/").concat(a.database));return{referenceValue:er(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Ua("Unsupported field value: ".concat(vc(e)))}(e,t)}function ml(e,t){var n={};return me(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ye(e,function(e,r){var i=yl(r,t.Fa(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function gl(e){return!("object"!=h(e)||null===e||e instanceof Array||e instanceof Date||e instanceof de||e instanceof Zc||e instanceof Jc||e instanceof wc||e instanceof Xc)}function kl(e,t,n){if(!gl(n)||!function(e){return"object"==h(e)&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=vc(n);throw"an object"===r?t.Ua(e+" a custom object"):t.Ua(e+" "+r)}}function wl(e,t,n){if((t=(0,i.getModularInstance)(t))instanceof Hc)return t._internalPath;if("string"==typeof t)return xl(e,t);throw Il("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var bl=new RegExp("[~\\*/\\[\\]]");function xl(e,t,n){if(t.search(bl)>=0)throw Il("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return b(Hc,S(t.split(".")))._internalPath}catch(r){throw Il("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Il(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new J(Y.INVALID_ARGUMENT,u+e+s)}function Tl(e,t){return e.some(function(e){return e.isEqual(t)})}var El=function(){function e(t,n,r,i,a){C(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return M(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new wc(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new Sl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(Rl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),Sl=function(e){y(n,El);var t=m(n);function n(){return C(this,n),t.apply(this,arguments)}return M(n,[{key:"data",value:function(){return o(E(n.prototype),"data",this).call(this)}}]),n}();function Rl(e,t){return"string"==typeof t?xl(e,t):t instanceof Hc?t._internalPath:t._delegate._internalPath}var _l=function(){function e(t,n){C(this,e),this.hasPendingWrites=t,this.fromCache=n}return M(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}();exports.SnapshotMetadata=_l;var Al=function(e){y(n,El);var t=m(n);function n(e,r,i,a,o,u){var s;return C(this,n),(s=t.call(this,e,r,i,a,u))._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return M(n,[{key:"exists",value:function(){return o(E(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new Dl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(Rl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}();exports.DocumentSnapshot=Al;var Dl=function(e){y(n,Al);var t=m(n);function n(){return C(this,n),t.apply(this,arguments)}return M(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(E(n.prototype),"data",this).call(this,e)}}]),n}();exports.QueryDocumentSnapshot=Dl;var Nl=function(){function e(t,n,r,i){C(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new _l(i.hasPendingWrites,i.fromCache),this.query=r}return M(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new Dl(n._firestore,n._userDataWriter,r.key,r,new _l(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new J(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new Dl(e._firestore,e._userDataWriter,t.doc.key,t.doc,new _l(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new Dl(e._firestore,e._userDataWriter,t.doc.key,t.doc,new _l(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:Cl(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}]),e}();function Cl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return z()}}function Ll(e,t){return e instanceof Al&&t instanceof Al?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Nl&&t instanceof Nl&&e._firestore===t._firestore&&Rc(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function Ml(e){if(Et(e)&&0===e.explicitOrderBy.length)throw new J(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}exports.QuerySnapshot=Nl;var Fl=M(function e(){C(this,e)});function Ol(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){e=a[i]._apply(e)}return e}exports.QueryConstraint=Fl;var Pl=function(e){y(n,Fl);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this)).Ga=e,a.za=r,a.Ha=i,a.type="where",a}return M(n,[{key:"_apply",value:function(e){var t=al(e.firestore),n=function(e,t,n,r,i,a,o){var u;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new J(Y.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on FieldPath.documentId()."));if("in"===a||"not-in"===a){Zl(o,a);var s,c=[],l=d(o);try{for(l.s();!(s=l.n()).done;){var f=s.value;c.push(Xl(r,e,f))}}catch(v){l.e(v)}finally{l.f()}u={arrayValue:{values:c}}}else u=Xl(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Zl(o,a),u=pl(n,"where",o,"in"===a||"not-in"===a);var h=at.create(i,a,u);return function(e,t){if(t.V()){var n=Rt(e);if(null!==n&&!n.isEqual(t.field))throw new J(Y.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=St(e);null!==r&&$l(e,t.field,r)}var i=function(e,t){var n,r=d(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(v){r.e(v)}finally{r.f()}return null}(e,function(e){switch(t.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===t.op?new J(Y.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new J(Y.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,h),h}(e._query,0,t,e.firestore._databaseId,this.Ga,this.za,this.Ha);return new bc(e.firestore,e.converter,function(e,t){var n=e.filters.concat([t]);return new bt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}]),n}();function Vl(e,t,n){var r=t,i=Rl("where",e);return new Pl(i,r,n)}var ql=function(e){y(n,Fl);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this)).Ga=e,i.Ja=r,i.type="orderBy",i}return M(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new J(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new J(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new mt(t,n);return function(e,t){if(null===St(e)){var n=Rt(e);null!==n&&$l(e,n,t.field)}}(e,r),r}(e._query,this.Ga,this.Ja);return new bc(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new bt(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}]),n}();function Ul(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Rl("orderBy",e);return new ql(n,t)}var Bl=function(e){y(n,Fl);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this)).type=e,a.Ya=r,a.Xa=i,a}return M(n,[{key:"_apply",value:function(e){return new bc(e.firestore,e.converter,Nt(e._query,this.Ya,this.Xa))}}]),n}();function Kl(e){return yc("limit",e),new Bl("limit",e,"F")}function jl(e){return yc("limitToLast",e),new Bl("limitToLast",e,"L")}var Gl=function(e){y(n,Fl);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this)).type=e,a.Za=r,a.tc=i,a}return M(n,[{key:"_apply",value:function(e){var t=Jl(e,this.type,this.Za,this.tc);return new bc(e.firestore,e.converter,function(e,t){return new bt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}]),n}();function zl(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Gl("startAt",t,!0)}function Ql(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Gl("startAfter",t,!1)}var Wl=function(e){y(n,Fl);var t=m(n);function n(e,r,i){var a;return C(this,n),(a=t.call(this)).type=e,a.Za=r,a.tc=i,a}return M(n,[{key:"_apply",value:function(e){var t=Jl(e,this.type,this.Za,this.tc);return new bc(e.firestore,e.converter,function(e,t){return new bt(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}]),n}();function Hl(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Wl("endBefore",t,!0)}function Yl(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Wl("endAt",t,!1)}function Jl(e,t,n,r){if(n[0]=(0,i.getModularInstance)(n[0]),n[0]instanceof El)return function(e,t,n,r,i){if(!r)throw new J(Y.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,o=[],u=d(At(e));try{for(u.s();!(a=u.n()).done;){var s=a.value;if(s.field.isKeyField())o.push(je(t,r.key));else{var c=r.data.field(s.field);if(Ae(c))throw new J(Y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=s.field.canonicalString();throw new J(Y.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}o.push(c)}}}catch(f){u.e(f)}finally{u.f()}return new pt(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var a=al(e.firestore);return function(e,t,n,r,i,a){var o=e.explicitOrderBy;if(i.length>o.length)throw new J(Y.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var u=[],s=0;s<i.length;s++){var c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new J(Y.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(h(c)));if(!_t(e)&&-1!==c.indexOf("/"))throw new J(Y.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(ke.fromString(c));if(!Fe.isDocumentKey(l))throw new J(Y.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var f=new Fe(l);u.push(je(t,f))}else{var d=pl(n,r,c);u.push(d)}}return new pt(u,a)}(e._query,e.firestore._databaseId,a,t,n,r)}function Xl(e,t,n){if("string"==typeof(n=(0,i.getModularInstance)(n))){if(""===n)throw new J(Y.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!_t(t)&&-1!==n.indexOf("/"))throw new J(Y.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(ke.fromString(n));if(!Fe.isDocumentKey(r))throw new J(Y.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return je(e,new Fe(r))}if(n instanceof wc)return je(e,n._key);throw new J(Y.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(vc(n),"."))}function Zl(e,t){if(!Array.isArray(e)||0===e.length)throw new J(Y.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new J(Y.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function $l(e,t,n){if(!n.isEqual(t))throw new J(Y.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var ef=function(){function e(){C(this,e)}return M(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Oe(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Re(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_e(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw z()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return ye(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new Zc(Re(e.latitude),Re(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=De(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ne(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Se(e);return new de(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=ke.fromString(e);Q(Ar(n));var r=new sc(n.get(1),n.get(3)),i=new Fe(n.popFirst(5));return r.isEqual(t)||K("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function tf(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}exports.AbstractUserDataWriter=ef;var nf=function(e){y(n,ef);var t=m(n);function n(e){var r;return C(this,n),(r=t.call(this)).firestore=e,r}return M(n,[{key:"convertBytes",value:function(e){return new Jc(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new wc(this.firestore,null,t)}}]),n}(),rf=function(){function e(t,n){C(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=al(t)}return M(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=af(e,this._firestore),i=tf(r.converter,t,n),a=ol(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,nn.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,a=af(e,this._firestore),o=arguments.length,u=new Array(o>3?o-3:0),s=3;s<o;s++)u[s-3]=arguments[s];return r="string"==typeof(t=(0,i.getModularInstance)(t))||t instanceof Hc?vl(this._dataReader,"WriteBatch.update",a._key,t,n,u):dl(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(r.toMutation(a._key,nn.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=af(e,this._firestore);return this._mutations=this._mutations.concat(new gn(t._key,nn.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new J(Y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function af(e,t){if((e=(0,i.getModularInstance)(e)).firestore!==t)throw new J(Y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function of(e){e=pc(e,wc);var t=pc(e.firestore,Cc);return ec(Fc(t),e._key).then(function(n){return wf(t,e,n)})}exports.WriteBatch=rf;var uf=function(e){y(n,ef);var t=m(n);function n(e){var r;return C(this,n),(r=t.call(this)).firestore=e,r}return M(n,[{key:"convertBytes",value:function(e){return new Jc(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new wc(this.firestore,null,t)}}]),n}();function sf(e){e=pc(e,wc);var t=pc(e.firestore,Cc),n=Fc(t),r=new uf(t);return $s(n,e._key).then(function(n){return new Al(t,r,e._key,n,new _l(null!==n&&n.hasLocalMutations,!0),e.converter)})}function cf(e){e=pc(e,wc);var t=pc(e.firestore,Cc);return ec(Fc(t),e._key,{source:"server"}).then(function(n){return wf(t,e,n)})}function lf(e){e=pc(e,bc);var t=pc(e.firestore,Cc),n=Fc(t),r=new uf(t);return Ml(e._query),nc(n,e._query).then(function(n){return new Nl(t,r,e,n)})}function ff(e){e=pc(e,bc);var t=pc(e.firestore,Cc),n=Fc(t),r=new uf(t);return tc(n,e._query).then(function(n){return new Nl(t,r,e,n)})}function hf(e){e=pc(e,bc);var t=pc(e.firestore,Cc),n=Fc(t),r=new uf(t);return nc(n,e._query,{source:"server"}).then(function(n){return new Nl(t,r,e,n)})}function df(e,t,n){e=pc(e,wc);var r=pc(e.firestore,Cc),i=tf(e.converter,t,n);return kf(r,[ol(al(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,nn.none())])}function vf(e,t,n){e=pc(e,wc);for(var r=pc(e.firestore,Cc),a=al(r),o=arguments.length,u=new Array(o>3?o-3:0),s=3;s<o;s++)u[s-3]=arguments[s];return kf(r,[("string"==typeof(t=(0,i.getModularInstance)(t))||t instanceof Hc?vl(a,"updateDoc",e._key,t,n,u):dl(a,"updateDoc",e._key,t)).toMutation(e._key,nn.exists(!0))])}function pf(e){return kf(pc(e.firestore,Cc),[new gn(e._key,nn.none())])}function yf(e,t){var n=pc(e.firestore,Cc),r=Ec(e),i=tf(e.converter,t);return kf(n,[ol(al(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,nn.exists(!1))]).then(function(){return r})}function mf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,u;e=(0,i.getModularInstance)(e);var s={includeMetadataChanges:!1},c=0;"object"!=h(n[c])||Ac(n[c])||(s=n[c],c++);var l,f,d,v={includeMetadataChanges:s.includeMetadataChanges};if(Ac(n[c])){var y=n[c];n[c]=null===(a=y.next)||void 0===a?void 0:a.bind(y),n[c+1]=null===(o=y.error)||void 0===o?void 0:o.bind(y),n[c+2]=null===(u=y.complete)||void 0===u?void 0:u.bind(y)}if(e instanceof wc)f=pc(e.firestore,Cc),d=It(e._key.path),l={next:function(t){n[c]&&n[c](wf(f,e,t))},error:n[c+1],complete:n[c+2]};else{var m=pc(e,bc);f=pc(m.firestore,Cc),d=m._query;var g=new uf(f);l={next:function(e){n[c]&&n[c](new Nl(f,g,m,e))},error:n[c+1],complete:n[c+2]},Ml(e._query)}return function(e,t,n,r){var i=new Cs(l),a=new wu(t,i,n);return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=du,t.next=3,Ys(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.na(),e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=pu,t.next=3,Ys(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(Fc(f),d,v)}function gf(e,t){return rc(Fc(e=pc(e,Cc)),Ac(t)?t:{next:t})}function kf(e,t){return function(e,t){var n=new X;return e.asyncQueue.enqueueAndForget(p(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Pu,r.next=3,Hs(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}},r)}))),n.promise}(Fc(e),t)}function wf(e,t,n){var r=n.docs.get(t._key),i=new uf(e);return new Al(e,i,t._key,r,new _l(n.hasPendingWrites,n.fromCache),t.converter)}var bf=function(e){y(n,e);var t=m(n);function n(e,r){var i;return C(this,n),(i=t.call(this,e,r))._firestore=e,i}return M(n,[{key:"get",value:function(e){var t=this,r=af(e,this._firestore),i=new uf(this._firestore);return o(E(n.prototype),"get",this).call(this,e).then(function(e){return new Al(t._firestore,i,r._key,e._document,new _l(!1,!1),r.converter)})}}]),n}(function(){function e(t,n){C(this,e),this._firestore=t,this._transaction=n,this._dataReader=al(t)}return M(e,[{key:"get",value:function(e){var t=this,n=af(e,this._firestore),r=new nf(this._firestore);return this._transaction.lookup([n._key]).then(function(e){if(!e||1!==e.length)return z();var i=e[0];if(i.isFoundDocument())return new El(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new El(t._firestore,r,n._key,null,n.converter);throw z()})}},{key:"set",value:function(e,t,n){var r=af(e,this._firestore),i=tf(r.converter,t,n),a=ol(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,a=af(e,this._firestore),o=arguments.length,u=new Array(o>3?o-3:0),s=3;s<o;s++)u[s-3]=arguments[s];return r="string"==typeof(t=(0,i.getModularInstance)(t))||t instanceof Hc?vl(this._dataReader,"Transaction.update",a._key,t,n,u):dl(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,r),this}},{key:"delete",value:function(e){var t=af(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function xf(e,t){return ic(Fc(e=pc(e,Cc)),function(n){return t(new bf(e,n))})}function If(){return new ul("deleteField")}function Tf(){return new cl("serverTimestamp")}function Ef(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new ll("arrayUnion",t)}function Sf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new fl("arrayRemove",t)}function Rf(e){return new hl("increment",e)}function _f(e){return Fc(e=pc(e,Cc)),new rf(e,function(t){return kf(e,t)})}exports.Transaction=bf,function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){P=e}(t.SDK_VERSION),(0,t._registerComponent)(new n.Component("firestore",function(e,t){var n=t.options,i=e.getProvider("app").getImmediate(),a=new Cc(i,new te(e.getProvider("auth-internal")),new ae(e.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:r},n),a._setSettings(n),a},"PUBLIC")),(0,t.registerVersion)(F,"3.4.1",e),(0,t.registerVersion)(F,"3.4.1","esm2017")}();
},{"@firebase/app":"h2Mb","@firebase/component":"vhY9","@firebase/logger":"JJem","@firebase/util":"chA2","@firebase/webchannel-wrapper":"qQDx","process":"pBGv"}],"vHL5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/firestore");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/firestore":"lBbe"}],"QVnC":[function(require,module,exports) {
var define;
var t,r=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{u({},"")}catch(F){u=function(t,r,e){return t[r]=e}}function h(t,r,e,n){var o=r&&r.prototype instanceof g?r:g,i=Object.create(o.prototype),a=new G(n||[]);return i._invoke=function(t,r,e){var n=l;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===y){if("throw"===o)throw i;return T()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=j(a,e);if(c){if(c===v)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===l)throw n=y,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=p;var u=f(t,r,e);if("normal"===u.type){if(n=e.done?y:s,u.arg===v)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=y,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(F){return{type:"throw",arg:F}}}t.wrap=h;var l="suspendedStart",s="suspendedYield",p="executing",y="completed",v={};function g(){}function d(){}function m(){}var w={};u(w,i,function(){return this});var L=Object.getPrototypeOf,x=L&&L(L(N([])));x&&x!==e&&n.call(x,i)&&(w=x);var b=m.prototype=g.prototype=Object.create(w);function E(t){["next","throw","return"].forEach(function(r){u(t,r,function(t){return this._invoke(r,t)})})}function _(t,r){var e;this._invoke=function(o,i){function a(){return new r(function(e,a){!function e(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var h=u.arg,l=h.value;return l&&"object"==typeof l&&n.call(l,"__await")?r.resolve(l.__await).then(function(t){e("next",t,a,c)},function(t){e("throw",t,a,c)}):r.resolve(l).then(function(t){h.value=t,a(h)},function(t){return e("throw",t,a,c)})}c(u.arg)}(o,i,e,a)})}return e=e?e.then(a,a):a()}}function j(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,j(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,v;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function O(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function k(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function N(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:T}}function T(){return{value:r,done:!0}}return d.prototype=m,u(b,"constructor",m),u(m,"constructor",d),d.displayName=u(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},E(_.prototype),u(_.prototype,a,function(){return this}),t.AsyncIterator=_,t.async=function(r,e,n,o,i){void 0===i&&(i=Promise);var a=new _(h(r,e,n,o),i);return t.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},E(b),u(b,c,"Generator"),u(b,i,function(){return this}),u(b,"toString",function(){return"[object Generator]"}),t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,G.prototype={constructor:G,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),v},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),k(e),v}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;k(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:N(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),v}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}
},{}],"O08Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,t=require("firebase/storage"),r=require("firebase/firestore"),n=require("regenerator-runtime/runtime"),o=u(require("../library/Component")),a=u(require("../library/Elements")),i=u(require("../images/logo.png"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(f){return void r(f)}u.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function i(e){f(a,n,o,i,u,"next",e)}function u(e){f(a,n,o,i,u,"throw",e)}i(void 0)})}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=g();return function(){var r,n=w(e);if(t){var o=w(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v(this,r)}}function v(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(n){y(c,o.default);var u=b(c);function c(){return s(this,c),u.call(this,{name:"profile",routerPath:"/profile"})}return d(c,[{key:"fileupload",value:function(){var n=l(regeneratorRuntime.mark(function n(){var o,a,i,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(0,r.getFirestore)(),o=(0,t.getStorage)(),a={contentType:"image/jpeg"},i=document.querySelector("#avatar").files[0],u=(0,t.ref)(o,"avatars/".concat(i.name)),(c=(0,t.uploadBytesResumable)(u,i,a)).on("state-change",function(e){var t=e.bytesTransferred/e.totalBytes*100;console.log(t)},function(e){alert("error: image not uploaded".concat(e))},function(){(0,t.getDownloadURL)(c.snapshot.ref).then(function(t){e=t})}),e;case 8:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;this.clearComponent();var t=document.createElement("div"),r=a.default.createImage({newSource:i.default,className:"header__logo"}),n=a.default.createContainer({className:"header",children:[r]}),o=a.default.createInput({type:"file",id:"testen"}),u=a.default.createInput({type:"text",id:"imageBox"}),c=a.default.createButton({className:"welcomeBackContainer__btnLogin",textContent:"Upload Image",id:"upBtn",onClick:function(){e.fileupload()}}),f=a.default.createImage({id:"myImage"}),l=a.default.createButton({className:"welcomeBackContainer__btnLogin",textContent:"Retrieve Image",id:"downBtn",onClick:function(){console.log("ik ben vince")}}),s=a.default.createContainer({className:"welcomeBackContainer",children:[o,c,l,u,f]}),p=a.default.createContainer({className:"togheter",children:[n,s]});return t.appendChild(p),t}}]),c}(),C=_;exports.default=C;
},{"firebase/storage":"jzRU","firebase/firestore":"vHL5","regenerator-runtime/runtime":"QVnC","../library/Component":"XGyB","../library/Elements":"hzEA","../images/logo.png":"SPDy"}],"iA92":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"DashboardComponent",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"HomePageComponent",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"ReigsterPageComponent",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"editProfileComponent",{enumerable:!0,get:function(){return n.default}});var e=o(require("./HomePage")),r=o(require("./registerPage")),t=o(require("./dashboard")),n=o(require("./editProfile"));function o(e){return e&&e.__esModule?e:{default:e}}
},{"./HomePage":"kXDI","./registerPage":"HVOu","./dashboard":"g5f5","./editProfile":"O08Q"}],"Focm":[function(require,module,exports) {
"use strict";var e=r(require("./App")),n=require("./components"),o=r(require("./components/dashboard")),t=r(require("./components/registerPage")),d=r(require("./components/editProfile"));function r(e){return e&&e.__esModule?e:{default:e}}var a=function(){var r=document.getElementById("container"),a=new e.default(r);a.addComponent(new n.HomePageComponent),a.addComponent(new t.default),a.addComponent(new o.default),a.addComponent(new d.default)};window.addEventListener("load",a);
},{"./App":"lY9v","./components":"iA92","./components/dashboard":"g5f5","./components/registerPage":"HVOu","./components/editProfile":"O08Q"}]},{},["Focm"], null)
//# sourceMappingURL=/src.77274ca5.js.map